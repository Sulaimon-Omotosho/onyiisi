"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunk_N_E"] = self["webpackChunk_N_E"] || []).push([["_app-pages-browser_node_modules_sanity_lib__chunks_index-Bn6gWj4A_js"],{

/***/ "(app-pages-browser)/./node_modules/rxjs/dist/esm5/internal/operators/pairwise.js":
/*!********************************************************************!*\
  !*** ./node_modules/rxjs/dist/esm5/internal/operators/pairwise.js ***!
  \********************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   pairwise: function() { return /* binding */ pairwise; }\n/* harmony export */ });\n/* harmony import */ var _util_lift__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../util/lift */ \"(app-pages-browser)/./node_modules/rxjs/dist/esm5/internal/util/lift.js\");\n/* harmony import */ var _OperatorSubscriber__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./OperatorSubscriber */ \"(app-pages-browser)/./node_modules/rxjs/dist/esm5/internal/operators/OperatorSubscriber.js\");\n\n\nfunction pairwise() {\n    return (0,_util_lift__WEBPACK_IMPORTED_MODULE_0__.operate)(function (source, subscriber) {\n        var prev;\n        var hasPrev = false;\n        source.subscribe((0,_OperatorSubscriber__WEBPACK_IMPORTED_MODULE_1__.createOperatorSubscriber)(subscriber, function (value) {\n            var p = prev;\n            prev = value;\n            hasPrev && subscriber.next([p, value]);\n            hasPrev = true;\n        }));\n    });\n}\n//# sourceMappingURL=pairwise.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9yeGpzL2Rpc3QvZXNtNS9pbnRlcm5hbC9vcGVyYXRvcnMvcGFpcndpc2UuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQXVDO0FBQ3lCO0FBQ3pEO0FBQ1AsV0FBVyxtREFBTztBQUNsQjtBQUNBO0FBQ0EseUJBQXlCLDZFQUF3QjtBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxLQUFLO0FBQ0w7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi9ub2RlX21vZHVsZXMvcnhqcy9kaXN0L2VzbTUvaW50ZXJuYWwvb3BlcmF0b3JzL3BhaXJ3aXNlLmpzP2NhMjQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgb3BlcmF0ZSB9IGZyb20gJy4uL3V0aWwvbGlmdCc7XG5pbXBvcnQgeyBjcmVhdGVPcGVyYXRvclN1YnNjcmliZXIgfSBmcm9tICcuL09wZXJhdG9yU3Vic2NyaWJlcic7XG5leHBvcnQgZnVuY3Rpb24gcGFpcndpc2UoKSB7XG4gICAgcmV0dXJuIG9wZXJhdGUoZnVuY3Rpb24gKHNvdXJjZSwgc3Vic2NyaWJlcikge1xuICAgICAgICB2YXIgcHJldjtcbiAgICAgICAgdmFyIGhhc1ByZXYgPSBmYWxzZTtcbiAgICAgICAgc291cmNlLnN1YnNjcmliZShjcmVhdGVPcGVyYXRvclN1YnNjcmliZXIoc3Vic2NyaWJlciwgZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgcCA9IHByZXY7XG4gICAgICAgICAgICBwcmV2ID0gdmFsdWU7XG4gICAgICAgICAgICBoYXNQcmV2ICYmIHN1YnNjcmliZXIubmV4dChbcCwgdmFsdWVdKTtcbiAgICAgICAgICAgIGhhc1ByZXYgPSB0cnVlO1xuICAgICAgICB9KSk7XG4gICAgfSk7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1wYWlyd2lzZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/./node_modules/rxjs/dist/esm5/internal/operators/pairwise.js\n"));

/***/ }),

/***/ "(app-pages-browser)/./node_modules/sanity/lib/_chunks/index-Bn6gWj4A.js":
/*!***********************************************************!*\
  !*** ./node_modules/sanity/lib/_chunks/index-Bn6gWj4A.js ***!
  \***********************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": function() { return /* binding */ StructureToolBoundary; }\n/* harmony export */ });\n/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-runtime */ \"(app-pages-browser)/./node_modules/next/dist/compiled/react/jsx-runtime.js\");\n/* harmony import */ var _sanity_ui__WEBPACK_IMPORTED_MODULE_36__ = __webpack_require__(/*! @sanity/ui */ \"(app-pages-browser)/./node_modules/@sanity/ui/dist/index.esm.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"(app-pages-browser)/./node_modules/next/dist/compiled/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var sanity__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! sanity */ \"(app-pages-browser)/./node_modules/sanity/lib/_chunks/TransformPatches-Bg_j4HpB.js\");\n/* harmony import */ var sanity__WEBPACK_IMPORTED_MODULE_39__ = __webpack_require__(/*! sanity */ \"(app-pages-browser)/./node_modules/sanity/lib/index.esm.js\");\n/* harmony import */ var _StructureToolProvider_CK141bsB_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./StructureToolProvider-CK141bsB.js */ \"(app-pages-browser)/./node_modules/sanity/lib/_chunks/StructureToolProvider-CK141bsB.js\");\n/* harmony import */ var sanity_router__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! sanity/router */ \"(app-pages-browser)/./node_modules/sanity/lib/router.esm.js\");\n/* harmony import */ var lodash_omit_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! lodash/omit.js */ \"(app-pages-browser)/./node_modules/lodash/omit.js\");\n/* harmony import */ var lodash_omit_js__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(lodash_omit_js__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! rxjs */ \"(app-pages-browser)/./node_modules/rxjs/dist/esm5/internal/util/isObservable.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! rxjs */ \"(app-pages-browser)/./node_modules/rxjs/dist/esm5/internal/observable/from.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! rxjs */ \"(app-pages-browser)/./node_modules/rxjs/dist/esm5/internal/observable/of.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! rxjs */ \"(app-pages-browser)/./node_modules/rxjs/dist/esm5/internal/firstValueFrom.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! rxjs */ \"(app-pages-browser)/./node_modules/rxjs/dist/esm5/internal/observable/concat.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! rxjs */ \"(app-pages-browser)/./node_modules/rxjs/dist/esm5/internal/observable/never.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(/*! rxjs */ \"(app-pages-browser)/./node_modules/rxjs/dist/esm5/internal/ReplaySubject.js\");\n/* harmony import */ var nanoid__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! nanoid */ \"(app-pages-browser)/./node_modules/nanoid/index.browser.js\");\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! rxjs/operators */ \"(app-pages-browser)/./node_modules/rxjs/dist/esm5/internal/operators/publishReplay.js\");\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! rxjs/operators */ \"(app-pages-browser)/./node_modules/rxjs/dist/esm5/internal/operators/refCount.js\");\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! rxjs/operators */ \"(app-pages-browser)/./node_modules/rxjs/dist/esm5/internal/operators/switchMap.js\");\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! rxjs/operators */ \"(app-pages-browser)/./node_modules/rxjs/dist/esm5/internal/operators/map.js\");\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! rxjs/operators */ \"(app-pages-browser)/./node_modules/rxjs/dist/esm5/internal/operators/startWith.js\");\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! rxjs/operators */ \"(app-pages-browser)/./node_modules/rxjs/dist/esm5/internal/operators/pairwise.js\");\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! rxjs/operators */ \"(app-pages-browser)/./node_modules/rxjs/dist/esm5/internal/operators/scan.js\");\n/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! rxjs/operators */ \"(app-pages-browser)/./node_modules/rxjs/dist/esm5/internal/operators/distinctUntilChanged.js\");\n/* harmony import */ var _sanity_generate_help_url__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! @sanity/generate-help-url */ \"(app-pages-browser)/./node_modules/@sanity/generate-help-url/dist/generate-help-url.esm.js\");\n/* harmony import */ var lodash_isEqual_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! lodash/isEqual.js */ \"(app-pages-browser)/./node_modules/lodash/isEqual.js\");\n/* harmony import */ var lodash_isEqual_js__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(lodash_isEqual_js__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _sanity_uuid__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(/*! @sanity/uuid */ \"(app-pages-browser)/./node_modules/uuid/dist/esm-browser/v4.js\");\n/* harmony import */ var _sanity_icons__WEBPACK_IMPORTED_MODULE_38__ = __webpack_require__(/*! @sanity/icons */ \"(app-pages-browser)/./node_modules/@sanity/icons/dist/index.js\");\n/* harmony import */ var styled_components__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__(/*! styled-components */ \"(app-pages-browser)/./node_modules/styled-components/dist/styled-components.browser.esm.js\");\n/* harmony import */ var _getJsonStream_RYwhuhmq_js__WEBPACK_IMPORTED_MODULE_37__ = __webpack_require__(/*! ./getJsonStream-RYwhuhmq.js */ \"(app-pages-browser)/./node_modules/sanity/lib/_chunks/getJsonStream-RYwhuhmq.js\");\n/* harmony import */ var lodash_camelCase_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! lodash/camelCase.js */ \"(app-pages-browser)/./node_modules/lodash/camelCase.js\");\n/* harmony import */ var lodash_camelCase_js__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(lodash_camelCase_js__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var speakingurl__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! speakingurl */ \"(app-pages-browser)/./node_modules/speakingurl/index.js\");\n/* harmony import */ var speakingurl__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(speakingurl__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var lodash_uniqueId_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! lodash/uniqueId.js */ \"(app-pages-browser)/./node_modules/lodash/uniqueId.js\");\n/* harmony import */ var lodash_uniqueId_js__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(lodash_uniqueId_js__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var react_is__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! react-is */ \"(app-pages-browser)/./node_modules/react-is/index.js\");\n/* harmony import */ var lodash_uniq_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! lodash/uniq.js */ \"(app-pages-browser)/./node_modules/lodash/uniq.js\");\n/* harmony import */ var lodash_uniq_js__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(lodash_uniq_js__WEBPACK_IMPORTED_MODULE_8__);\n/* harmony import */ var lodash_kebabCase_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! lodash/kebabCase.js */ \"(app-pages-browser)/./node_modules/lodash/kebabCase.js\");\n/* harmony import */ var lodash_kebabCase_js__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(lodash_kebabCase_js__WEBPACK_IMPORTED_MODULE_9__);\n/* harmony import */ var lodash_find_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! lodash/find.js */ \"(app-pages-browser)/./node_modules/lodash/find.js\");\n/* harmony import */ var lodash_find_js__WEBPACK_IMPORTED_MODULE_10___default = /*#__PURE__*/__webpack_require__.n(lodash_find_js__WEBPACK_IMPORTED_MODULE_10__);\n/* harmony import */ var lodash_startCase_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! lodash/startCase.js */ \"(app-pages-browser)/./node_modules/lodash/startCase.js\");\n/* harmony import */ var lodash_startCase_js__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(lodash_startCase_js__WEBPACK_IMPORTED_MODULE_11__);\n/* harmony import */ var is_hotkey__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! is-hotkey */ \"(app-pages-browser)/./node_modules/is-hotkey/lib/index.js\");\n/* harmony import */ var _sanity_util_paths__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @sanity/util/paths */ \"(app-pages-browser)/./node_modules/@sanity/util/lib/paths.esm.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst emptyArray = [];\nfunction PaneRouterProvider(props) {\n  const {\n    children,\n    flatIndex,\n    index,\n    params,\n    payload,\n    siblingIndex\n  } = props;\n  const {\n    navigate,\n    navigateIntent,\n    resolvePathFromState\n  } = (0,sanity_router__WEBPACK_IMPORTED_MODULE_14__.useRouter)();\n  const routerState = (0,sanity_router__WEBPACK_IMPORTED_MODULE_14__.useRouterState)();\n  const {\n    panes,\n    expand\n  } = (0,_StructureToolProvider_CK141bsB_js__WEBPACK_IMPORTED_MODULE_15__.usePaneLayout)();\n  const routerPaneGroups = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(() => (routerState == null ? void 0 : routerState.panes) || emptyArray, [routerState == null ? void 0 : routerState.panes]);\n  const lastPane = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(() => panes == null ? void 0 : panes[panes.length - 2], [panes]);\n  const groupIndex = index - 1;\n  const createNextRouterState = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(modifier => {\n    const currentGroup = routerPaneGroups[groupIndex] || [];\n    const currentItem = currentGroup[siblingIndex];\n    const nextGroup = modifier(currentGroup, currentItem);\n    const nextPanes = [...routerPaneGroups.slice(0, groupIndex), nextGroup, ...routerPaneGroups.slice(groupIndex + 1)];\n    const nextRouterState = {\n      ...(routerState || {}),\n      panes: nextPanes\n    };\n    return nextRouterState;\n  }, [groupIndex, routerPaneGroups, routerState, siblingIndex]);\n  const modifyCurrentGroup = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(modifier => {\n    const nextRouterState = createNextRouterState(modifier);\n    setTimeout(() => navigate(nextRouterState), 0);\n    return nextRouterState;\n  }, [createNextRouterState, navigate]);\n  const createPathWithParams = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(nextParams => {\n    const nextRouterState = createNextRouterState((siblings, item) => [...siblings.slice(0, siblingIndex), {\n      ...item,\n      params: nextParams\n    }, ...siblings.slice(siblingIndex + 1)]);\n    return resolvePathFromState(nextRouterState);\n  }, [createNextRouterState, resolvePathFromState, siblingIndex]);\n  const setPayload = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(nextPayload => {\n    modifyCurrentGroup((siblings, item) => [...siblings.slice(0, siblingIndex), {\n      ...item,\n      payload: nextPayload\n    }, ...siblings.slice(siblingIndex + 1)]);\n  }, [modifyCurrentGroup, siblingIndex]);\n  const setParams = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(nextParams => {\n    modifyCurrentGroup((siblings, item) => [...siblings.slice(0, siblingIndex), {\n      ...item,\n      params: nextParams\n    }, ...siblings.slice(siblingIndex + 1)]);\n  }, [modifyCurrentGroup, siblingIndex]);\n  const handleEditReference = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(_ref => {\n    let {\n      id,\n      parentRefPath,\n      type,\n      template\n    } = _ref;\n    navigate({\n      panes: [...routerPaneGroups.slice(0, groupIndex + 1), [{\n        id,\n        params: {\n          template: template.id,\n          parentRefPath: (0,_sanity_util_paths__WEBPACK_IMPORTED_MODULE_13__.toString)(parentRefPath),\n          type\n        },\n        payload: template.params\n      }]]\n    });\n  }, [groupIndex, navigate, routerPaneGroups]);\n  const ctx = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(() => ({\n    // Zero-based index (position) of pane, visually\n    index: flatIndex,\n    // Zero-based index of pane group (within URL structure)\n    groupIndex,\n    // Zero-based index of pane within sibling group\n    siblingIndex,\n    // Payload of the current pane\n    payload,\n    // Params of the current pane\n    params,\n    // Whether or not the pane has any siblings (within the same group)\n    hasGroupSiblings: routerPaneGroups[groupIndex] ? routerPaneGroups[groupIndex].length > 1 : false,\n    // The length of the current group\n    groupLength: routerPaneGroups[groupIndex] ? routerPaneGroups[groupIndex].length : 0,\n    // Current router state for the \"panes\" property\n    routerPanesState: routerPaneGroups,\n    // Curried StateLink that passes the correct state automatically\n    ChildLink: _StructureToolProvider_CK141bsB_js__WEBPACK_IMPORTED_MODULE_15__.ChildLink,\n    // Curried StateLink that pops off the last pane group\n    // Only pass if this is not the first pane\n    BackLink: flatIndex ? _StructureToolProvider_CK141bsB_js__WEBPACK_IMPORTED_MODULE_15__.BackLink : void 0,\n    // A specialized `ChildLink` that takes in the needed props to open a\n    // referenced document to the right\n    ReferenceChildLink: _StructureToolProvider_CK141bsB_js__WEBPACK_IMPORTED_MODULE_15__.ReferenceChildLink,\n    // Similar to `ReferenceChildLink` expect without the wrapping component\n    handleEditReference,\n    // Curried StateLink that passed the correct state, but merges params/payload\n    ParameterizedLink: _StructureToolProvider_CK141bsB_js__WEBPACK_IMPORTED_MODULE_15__.ParameterizedLink,\n    // Replaces the current pane with a new one\n    replaceCurrent: function () {\n      let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      modifyCurrentGroup(() => [{\n        id: opts.id || \"\",\n        payload: opts.payload,\n        params: opts.params || {}\n      }]);\n    },\n    // Removes the current pane from the group\n    closeCurrent: () => {\n      modifyCurrentGroup((siblings, item) => siblings.length > 1 ? siblings.filter(sibling => sibling !== item) : siblings);\n    },\n    // Removes all panes to the right including current\n    closeCurrentAndAfter: function () {\n      let expandLast = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n      if (expandLast && lastPane) {\n        expand(lastPane.element);\n      }\n      navigate({\n        panes: [...routerPaneGroups.slice(0, groupIndex)]\n      }, {\n        replace: true\n      });\n    },\n    // Duplicate the current pane, with optional overrides for payload, parameters\n    duplicateCurrent: options => {\n      modifyCurrentGroup((siblings, item) => {\n        const duplicatedItem = {\n          ...item,\n          payload: (options == null ? void 0 : options.payload) || item.payload,\n          params: (options == null ? void 0 : options.params) || item.params\n        };\n        return [...siblings.slice(0, siblingIndex), duplicatedItem, ...siblings.slice(siblingIndex)];\n      });\n    },\n    // Set the view for the current pane\n    setView: viewId => {\n      const restParams = lodash_omit_js__WEBPACK_IMPORTED_MODULE_2___default()(params, \"view\");\n      return setParams(viewId ? {\n        ...restParams,\n        view: viewId\n      } : restParams);\n    },\n    // Set the parameters for the current pane\n    setParams,\n    // Set the payload for the current pane\n    setPayload,\n    // A function that returns a path with the given parameters\n    createPathWithParams,\n    // Proxied navigation to a given intent. Consider just exposing `router` instead?\n    navigateIntent\n  }), [flatIndex, groupIndex, siblingIndex, payload, params, routerPaneGroups, handleEditReference, setParams, setPayload, createPathWithParams, navigateIntent, modifyCurrentGroup, lastPane, navigate, expand]);\n  return /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_StructureToolProvider_CK141bsB_js__WEBPACK_IMPORTED_MODULE_15__.PaneRouterContext.Provider, {\n    value: ctx,\n    children\n  });\n}\nclass PaneResolutionError extends Error {\n  constructor(_ref2) {\n    let {\n      message,\n      context,\n      helpId,\n      cause\n    } = _ref2;\n    super(message);\n    this.context = context;\n    this.helpId = helpId;\n    this.cause = cause;\n  }\n}\nconst randomIdCache = /* @__PURE__ */new WeakMap();\nfunction assignId(obj) {\n  const cachedValue = randomIdCache.get(obj);\n  if (cachedValue) return cachedValue;\n  const id = (0,nanoid__WEBPACK_IMPORTED_MODULE_16__.nanoid)();\n  randomIdCache.set(obj, id);\n  return id;\n}\nconst isPromise = thing => {\n  return !!thing && typeof (thing == null ? void 0 : thing.then) === \"function\";\n};\nconst isSerializable = thing => {\n  if (!(0,sanity__WEBPACK_IMPORTED_MODULE_17__.isRecord)(thing)) return false;\n  return typeof thing.serialize === \"function\";\n};\nconst rethrowWithPaneResolutionErrors = next => (unresolvedPane, context, flatIndex) => {\n  try {\n    return next(unresolvedPane, context, flatIndex);\n  } catch (e) {\n    if (e instanceof PaneResolutionError) {\n      throw e;\n    }\n    throw new PaneResolutionError({\n      message: typeof (e == null ? void 0 : e.message) === \"string\" ? e.message : \"\",\n      context,\n      cause: e\n    });\n  }\n};\nconst wrapWithPublishReplay = next => function () {\n  return next(...arguments).pipe(\n  // need to add publishReplay + refCount to ensure new subscribers always\n  // get an emission. without this, memoized observables may get stuck\n  // waiting for their first emissions resulting in a loading pane\n  (0,rxjs_operators__WEBPACK_IMPORTED_MODULE_18__.publishReplay)(1), (0,rxjs_operators__WEBPACK_IMPORTED_MODULE_19__.refCount)());\n};\nfunction createPaneResolver(middleware) {\n  const resolvePane = rethrowWithPaneResolutionErrors(wrapWithPublishReplay(middleware((unresolvedPane, context, flatIndex) => {\n    if (!unresolvedPane) {\n      throw new PaneResolutionError({\n        message: \"Pane returned no child\",\n        context,\n        helpId: \"structure-item-returned-no-child\"\n      });\n    }\n    if (isPromise(unresolvedPane) || (0,rxjs__WEBPACK_IMPORTED_MODULE_20__.isObservable)(unresolvedPane)) {\n      return (0,rxjs__WEBPACK_IMPORTED_MODULE_21__.from)(unresolvedPane).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_22__.switchMap)(result => resolvePane(result, context, flatIndex)));\n    }\n    if (isSerializable(unresolvedPane)) {\n      return resolvePane(unresolvedPane.serialize(context), context, flatIndex);\n    }\n    if (typeof unresolvedPane === \"function\") {\n      return resolvePane(unresolvedPane(context.id, context), context, flatIndex);\n    }\n    return (0,rxjs__WEBPACK_IMPORTED_MODULE_23__.of)(unresolvedPane);\n  })));\n  return resolvePane;\n}\nconst bindCache = /* @__PURE__ */new WeakMap();\nfunction memoBind(obj, methodKey) {\n  const boundMethods = bindCache.get(obj) || /* @__PURE__ */new Map();\n  if (boundMethods) {\n    const bound2 = boundMethods.get(methodKey);\n    if (bound2) return bound2;\n  }\n  const method = obj[methodKey];\n  if (typeof method !== \"function\") {\n    throw new Error(\"Expected property `\".concat(methodKey, \"` to be a function but got \").concat(typeof method, \" instead.\"));\n  }\n  const bound = method.bind(obj);\n  boundMethods.set(methodKey, bound);\n  bindCache.set(obj, boundMethods);\n  return bound;\n}\nasync function resolveIntent(options) {\n  const resolvedPaneCache = /* @__PURE__ */new Map();\n  const memoize = nextFn => (unresolvedPane, context, flatIndex) => {\n    const key = unresolvedPane && \"\".concat(assignId(unresolvedPane), \"-\").concat(context.path.join(\"__\"));\n    const cachedResolvedPane = key && resolvedPaneCache.get(key);\n    if (cachedResolvedPane) return cachedResolvedPane;\n    const result = nextFn(unresolvedPane, context, flatIndex);\n    if (key) resolvedPaneCache.set(key, result);\n    return result;\n  };\n  const resolvePane = createPaneResolver(memoize);\n  const fallbackEditorPanes = [[{\n    id: \"__edit__\".concat(options.params.id),\n    params: {\n      ...lodash_omit_js__WEBPACK_IMPORTED_MODULE_2___default()(options.params, [\"id\"]),\n      type: options.params.type\n    },\n    payload: options.payload\n  }]];\n  async function traverse(_ref3) {\n    let {\n      currentId,\n      flatIndex,\n      intent,\n      params,\n      parent,\n      path,\n      payload,\n      unresolvedPane,\n      levelIndex,\n      structureContext\n    } = _ref3;\n    var _a;\n    if (!unresolvedPane) return [];\n    const {\n      id: targetId,\n      type: schemaTypeName,\n      ...otherParams\n    } = params;\n    const context = {\n      id: currentId,\n      splitIndex: 0,\n      parent,\n      path,\n      index: flatIndex,\n      params: {},\n      payload: void 0,\n      structureContext\n    };\n    const resolvedPane = await (0,rxjs__WEBPACK_IMPORTED_MODULE_24__.firstValueFrom)(resolvePane(unresolvedPane, context, flatIndex));\n    if (resolvedPane.type === \"document\" && resolvedPane.id === targetId) {\n      return [{\n        panes: [...path.slice(0, path.length - 1).map(i => [{\n          id: i\n        }]), [{\n          id: targetId,\n          params: otherParams,\n          payload\n        }]],\n        depthIndex: path.length,\n        levelIndex\n      }];\n    }\n    if (\n    // if the resolve pane's `canHandleIntent` returns true, then resolve\n    ((_a = resolvedPane.canHandleIntent) == null ? void 0 : _a.call(resolvedPane, intent, params, {\n      pane: resolvedPane,\n      index: flatIndex\n    })) ||\n    // if the pane's `canHandleIntent` did not return true, then match against\n    // this default case. we will resolve the intent if:\n    resolvedPane.type === \"documentList\" &&\n    // 1. the schema type matches (this required for the document to render)\n    resolvedPane.schemaTypeName === schemaTypeName &&\n    // 2. the filter is the default filter.\n    //\n    // NOTE: this case is to prevent false positive matches where the user\n    // has configured a more specific filter for a particular type. In that\n    // case, the user can implement their own `canHandleIntent` function\n    resolvedPane.options.filter === \"_type == $type\") {\n      return [{\n        panes: [\n        // map the current path to router panes\n        ...path.map(id => [{\n          id\n        }]),\n        // then augment with the intents IDs and params\n        [{\n          id: params.id,\n          params: otherParams,\n          payload\n        }]],\n        depthIndex: path.length,\n        levelIndex\n      }];\n    }\n    if (resolvedPane.type === \"list\" && resolvedPane.child && resolvedPane.items) {\n      return (await Promise.all(resolvedPane.items.map((item, nextLevelIndex) => {\n        if (item.type === \"divider\") return Promise.resolve([]);\n        return traverse({\n          currentId: item._id || item.id,\n          flatIndex: flatIndex + 1,\n          intent,\n          params,\n          parent: resolvedPane,\n          path: [...path, item.id],\n          payload,\n          unresolvedPane: typeof resolvedPane.child === \"function\" ? memoBind(resolvedPane, \"child\") : resolvedPane.child,\n          levelIndex: nextLevelIndex,\n          structureContext\n        });\n      }))).flat();\n    }\n    return [];\n  }\n  const matchingPanes = await traverse({\n    currentId: \"root\",\n    flatIndex: 0,\n    levelIndex: 0,\n    intent: options.intent,\n    params: options.params,\n    parent: null,\n    path: [],\n    payload: options.payload,\n    unresolvedPane: options.rootPaneNode,\n    structureContext: options.structureContext\n  });\n  const closestPaneToRoot = matchingPanes.sort((a, b) => {\n    if (a.depthIndex === b.depthIndex) return a.levelIndex - b.levelIndex;\n    return a.depthIndex - b.depthIndex;\n  })[0];\n  if (closestPaneToRoot) {\n    return closestPaneToRoot.panes;\n  }\n  return fallbackEditorPanes;\n}\nconst fallbackEditorChild = (nodeId, context) => {\n  const id = nodeId.replace(/^__edit__/, \"\");\n  const {\n    params,\n    payload,\n    structureContext: {\n      resolveDocumentNode\n    }\n  } = context;\n  const {\n    type,\n    template\n  } = params;\n  if (!type) {\n    throw new Error(\"Document type for document with ID \".concat(id, \" was not provided in the router params.\"));\n  }\n  let defaultDocumentBuilder = resolveDocumentNode({\n    schemaType: type,\n    documentId: id\n  }).id(\"editor\");\n  if (template) {\n    defaultDocumentBuilder = defaultDocumentBuilder.initialValueTemplate(template, payload);\n  }\n  return defaultDocumentBuilder.serialize();\n};\nfunction hashContext(context) {\n  var _a, _b;\n  return \"contextHash(\".concat(JSON.stringify({\n    id: context.id,\n    parentId: parent && assignId(parent),\n    path: context.path,\n    index: context.index,\n    splitIndex: context.splitIndex,\n    serializeOptionsIndex: (_a = context.serializeOptions) == null ? void 0 : _a.index,\n    serializeOptionsPath: (_b = context.serializeOptions) == null ? void 0 : _b.path\n  }), \")\");\n}\nconst hashResolvedPaneMeta = meta => {\n  const normalized = {\n    type: meta.type,\n    id: meta.routerPaneSibling.id,\n    params: meta.routerPaneSibling.params || {},\n    payload: meta.routerPaneSibling.payload || null,\n    flatIndex: meta.flatIndex,\n    groupIndex: meta.groupIndex,\n    siblingIndex: meta.siblingIndex,\n    path: meta.path,\n    paneNode: meta.type === \"resolvedMeta\" ? assignId(meta.paneNode) : null\n  };\n  return \"metaHash(\".concat(JSON.stringify(normalized), \")\");\n};\nfunction resolvePaneTree(_ref4) {\n  let {\n    unresolvedPane,\n    flattenedRouterPanes,\n    parent: parent2,\n    path,\n    resolvePane,\n    structureContext\n  } = _ref4;\n  const [current, ...rest] = flattenedRouterPanes;\n  const next = rest[0];\n  const context = {\n    id: current.routerPaneSibling.id,\n    splitIndex: current.siblingIndex,\n    parent: parent2,\n    path: [...path, current.routerPaneSibling.id],\n    index: current.flatIndex,\n    params: current.routerPaneSibling.params || {},\n    payload: current.routerPaneSibling.payload,\n    structureContext\n  };\n  try {\n    return resolvePane(unresolvedPane, context, current.flatIndex).pipe(\n    // this switch map receives a resolved pane\n    (0,rxjs_operators__WEBPACK_IMPORTED_MODULE_22__.switchMap)(paneNode => {\n      const resolvedPaneMeta = {\n        type: \"resolvedMeta\",\n        ...current,\n        paneNode,\n        path: context.path\n      };\n      const loadingPanes = rest.map((i, restIndex) => {\n        const loadingPanePath = [...context.path, ...rest.slice(restIndex).map((_, currentIndex) => \"[\".concat(i.flatIndex + currentIndex, \"]\"))];\n        const loadingPane = {\n          type: \"loading\",\n          path: loadingPanePath,\n          paneNode: null,\n          ...i\n        };\n        return loadingPane;\n      });\n      if (!rest.length) {\n        return (0,rxjs__WEBPACK_IMPORTED_MODULE_23__.of)([resolvedPaneMeta]);\n      }\n      let nextStream;\n      if (\n      // the fallback editor case\n      next == null ? void 0 : next.routerPaneSibling.id.startsWith(\"__edit__\")) {\n        nextStream = resolvePaneTree({\n          unresolvedPane: fallbackEditorChild,\n          flattenedRouterPanes: rest,\n          parent: parent2,\n          path: context.path,\n          resolvePane,\n          structureContext\n        });\n      } else if (current.groupIndex === (next == null ? void 0 : next.groupIndex)) {\n        nextStream = resolvePaneTree({\n          unresolvedPane,\n          flattenedRouterPanes: rest,\n          parent: parent2,\n          path,\n          resolvePane,\n          structureContext\n        });\n      } else {\n        nextStream = resolvePaneTree({\n          unresolvedPane: typeof paneNode.child === \"function\" ? memoBind(paneNode, \"child\") : paneNode.child,\n          flattenedRouterPanes: rest,\n          parent: paneNode,\n          path: context.path,\n          resolvePane,\n          structureContext\n        });\n      }\n      return (0,rxjs__WEBPACK_IMPORTED_MODULE_25__.concat)(\n      // we emit the loading panes first in a concat (this emits immediately)\n      (0,rxjs__WEBPACK_IMPORTED_MODULE_23__.of)([resolvedPaneMeta, ...loadingPanes]),\n      // then whenever the next stream is done, the results will be combined.\n      nextStream.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_26__.map)(nextResolvedPanes => [resolvedPaneMeta, ...nextResolvedPanes])));\n    }));\n  } catch (e) {\n    if (e instanceof PaneResolutionError) {\n      if (e.context) {\n        console.warn(\"Pane resolution error at index \".concat(e.context.index).concat(e.context.splitIndex > 0 ? \" for split pane index \".concat(e.context.splitIndex) : \"\", \": \").concat(e.message).concat(e.helpId ? \" - see \".concat((0,_sanity_generate_help_url__WEBPACK_IMPORTED_MODULE_27__.generateHelpUrl)(e.helpId)) : \"\"), e);\n      }\n      if (e.helpId === \"structure-item-returned-no-child\") {\n        return (0,rxjs__WEBPACK_IMPORTED_MODULE_23__.of)([]);\n      }\n    }\n    throw e;\n  }\n}\nfunction createResolvedPaneNodeStream(_ref5) {\n  let {\n    routerPanesStream,\n    rootPaneNode,\n    initialCacheState = {\n      cacheKeysByFlatIndex: [],\n      flattenedRouterPanes: [],\n      resolvedPaneCache: /* @__PURE__ */new Map(),\n      resolvePane: () => rxjs__WEBPACK_IMPORTED_MODULE_28__.NEVER\n    },\n    structureContext\n  } = _ref5;\n  const resolvedPanes$ = routerPanesStream.pipe(\n  // add in implicit \"root\" router pane\n  (0,rxjs_operators__WEBPACK_IMPORTED_MODULE_26__.map)(rawRouterPanes => [[{\n    id: \"root\"\n  }], ...rawRouterPanes]),\n  // create flattened router panes\n  (0,rxjs_operators__WEBPACK_IMPORTED_MODULE_26__.map)(routerPanes => {\n    const flattenedRouterPanes = routerPanes.flatMap((routerPaneGroup, groupIndex) => routerPaneGroup.map((routerPaneSibling, siblingIndex) => ({\n      routerPaneSibling,\n      groupIndex,\n      siblingIndex\n    }))).map((i, index) => ({\n      ...i,\n      flatIndex: index\n    }));\n    return flattenedRouterPanes;\n  }),\n  // calculate a \"diffIndex\" used for clearing the memo cache\n  (0,rxjs_operators__WEBPACK_IMPORTED_MODULE_29__.startWith)([]), (0,rxjs_operators__WEBPACK_IMPORTED_MODULE_30__.pairwise)(), (0,rxjs_operators__WEBPACK_IMPORTED_MODULE_26__.map)(_ref6 => {\n    let [prev, curr] = _ref6;\n    for (let i = 0; i < curr.length; i++) {\n      const prevValue = prev[i];\n      const currValue = curr[i];\n      if (!lodash_isEqual_js__WEBPACK_IMPORTED_MODULE_3___default()(prevValue, currValue)) {\n        return {\n          flattenedRouterPanes: curr,\n          diffIndex: i\n        };\n      }\n    }\n    return {\n      flattenedRouterPanes: curr,\n      diffIndex: curr.length\n    };\n  }),\n  // create the memoized `resolvePane` function and manage the memo cache\n  (0,rxjs_operators__WEBPACK_IMPORTED_MODULE_31__.scan)((acc, next) => {\n    const {\n      cacheKeysByFlatIndex,\n      resolvedPaneCache\n    } = acc;\n    const {\n      flattenedRouterPanes,\n      diffIndex\n    } = next;\n    const beforeDiffIndex = cacheKeysByFlatIndex.slice(0, diffIndex + 1);\n    const afterDiffIndex = cacheKeysByFlatIndex.slice(diffIndex + 1);\n    const keysToKeep = new Set(beforeDiffIndex.flatMap(keySet => Array.from(keySet)));\n    const keysToDelete = afterDiffIndex.flatMap(keySet => Array.from(keySet)).filter(key => !keysToKeep.has(key));\n    for (const key of keysToDelete) {\n      resolvedPaneCache.delete(key);\n    }\n    const memoize = nextFn => (unresolvedPane, context, flatIndex) => {\n      const key = unresolvedPane && \"\".concat(assignId(unresolvedPane), \"-\").concat(hashContext(context));\n      const cachedResolvedPane = key && resolvedPaneCache.get(key);\n      if (cachedResolvedPane) return cachedResolvedPane;\n      const result = nextFn(unresolvedPane, context, flatIndex);\n      if (!key) return result;\n      const cacheKeySet = cacheKeysByFlatIndex[flatIndex] || /* @__PURE__ */new Set();\n      cacheKeySet.add(key);\n      cacheKeysByFlatIndex[flatIndex] = cacheKeySet;\n      resolvedPaneCache.set(key, result);\n      return result;\n    };\n    return {\n      flattenedRouterPanes,\n      cacheKeysByFlatIndex,\n      resolvedPaneCache,\n      resolvePane: createPaneResolver(memoize)\n    };\n  }, initialCacheState),\n  // run the memoized, recursive resolving\n  (0,rxjs_operators__WEBPACK_IMPORTED_MODULE_22__.switchMap)(_ref7 => {\n    let {\n      flattenedRouterPanes,\n      resolvePane\n    } = _ref7;\n    return resolvePaneTree({\n      unresolvedPane: rootPaneNode,\n      flattenedRouterPanes,\n      parent: null,\n      path: [],\n      resolvePane,\n      structureContext\n    });\n  }));\n  return resolvedPanes$.pipe(\n  // this diffs the previous emission with the current one. if there is a new\n  // loading pane at the same position where a previous pane already had a\n  // resolved value (looking at the IDs to compare), then return the previous\n  // pane instead of the loading pane\n  (0,rxjs_operators__WEBPACK_IMPORTED_MODULE_31__.scan)((prev, next) => next.map((nextPane, index) => {\n    const prevPane = prev[index];\n    if (!prevPane) return nextPane;\n    if (nextPane.type !== \"loading\") return nextPane;\n    if (prevPane.routerPaneSibling.id === nextPane.routerPaneSibling.id) {\n      return prevPane;\n    }\n    return nextPane;\n  }), []),\n  // this prevents duplicate emissions\n  (0,rxjs_operators__WEBPACK_IMPORTED_MODULE_32__.distinctUntilChanged)((prev, next) => {\n    if (prev.length !== next.length) return false;\n    for (let i = 0; i < next.length; i++) {\n      const prevValue = prev[i];\n      const nextValue = next[i];\n      if (hashResolvedPaneMeta(prevValue) !== hashResolvedPaneMeta(nextValue)) {\n        return false;\n      }\n    }\n    return true;\n  }));\n}\nfunction useRouterPanesStream() {\n  const routerStateSubject = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(() => new rxjs__WEBPACK_IMPORTED_MODULE_33__.ReplaySubject(1), []);\n  const routerPanes$ = (0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)(() => routerStateSubject.asObservable().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_26__.map)(_routerState => (_routerState == null ? void 0 : _routerState.panes) || [])), [routerStateSubject]);\n  const {\n    state: routerState\n  } = (0,sanity_router__WEBPACK_IMPORTED_MODULE_14__.useRouter)();\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    routerStateSubject.next(routerState);\n  }, [routerState, routerStateSubject]);\n  return routerPanes$;\n}\nfunction useResolvedPanes() {\n  const [error, setError] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)();\n  if (error) throw error;\n  const {\n    structureContext,\n    rootPaneNode\n  } = (0,_StructureToolProvider_CK141bsB_js__WEBPACK_IMPORTED_MODULE_15__.useStructureTool)();\n  const [data, setData] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)({\n    paneDataItems: [],\n    resolvedPanes: [],\n    routerPanes: []\n  });\n  const routerPanesStream = useRouterPanesStream();\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    const resolvedPanes$ = createResolvedPaneNodeStream({\n      rootPaneNode,\n      routerPanesStream,\n      structureContext\n    }).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_26__.map)(resolvedPanes => {\n      const routerPanes = resolvedPanes.reduce((acc, next) => {\n        const currentGroup = acc[next.groupIndex] || [];\n        currentGroup[next.siblingIndex] = next.routerPaneSibling;\n        acc[next.groupIndex] = currentGroup;\n        return acc;\n      }, []);\n      const groupsLen = routerPanes.length;\n      const paneDataItems = resolvedPanes.map(pane => {\n        var _a;\n        const {\n          groupIndex,\n          flatIndex,\n          siblingIndex,\n          routerPaneSibling,\n          path\n        } = pane;\n        const itemId = routerPaneSibling.id;\n        const nextGroup = routerPanes[groupIndex + 1];\n        const paneDataItem = {\n          active: groupIndex === groupsLen - 2,\n          childItemId: (_a = nextGroup == null ? void 0 : nextGroup[0].id) != null ? _a : null,\n          index: flatIndex,\n          itemId: routerPaneSibling.id,\n          groupIndex,\n          key: \"\".concat(pane.type === \"loading\" ? \"unknown\" : pane.paneNode.id, \"-\").concat(itemId, \"-\").concat(siblingIndex),\n          pane: pane.type === \"loading\" ? _StructureToolProvider_CK141bsB_js__WEBPACK_IMPORTED_MODULE_15__.LOADING_PANE : pane.paneNode,\n          params: routerPaneSibling.params || {},\n          path: path.join(\";\"),\n          payload: routerPaneSibling.payload,\n          selected: flatIndex === resolvedPanes.length - 1,\n          siblingIndex\n        };\n        return paneDataItem;\n      });\n      return {\n        paneDataItems,\n        routerPanes,\n        resolvedPanes: paneDataItems.map(pane => pane.pane)\n      };\n    }));\n    const subscription = resolvedPanes$.subscribe({\n      next: result => setData(result),\n      error: e => setError(e)\n    });\n    return () => subscription.unsubscribe();\n  }, [rootPaneNode, routerPanesStream, structureContext]);\n  return data;\n}\nasync function ensureDocumentIdAndType(documentStore, id, type) {\n  if (id && type) return {\n    id,\n    type\n  };\n  if (!id && type) return {\n    id: (0,_sanity_uuid__WEBPACK_IMPORTED_MODULE_34__[\"default\"])(),\n    type\n  };\n  if (id && !type) {\n    const resolvedType = await (0,rxjs__WEBPACK_IMPORTED_MODULE_24__.firstValueFrom)(documentStore.resolveTypeForDocument(id));\n    return {\n      id,\n      type: resolvedType\n    };\n  }\n  throw new PaneResolutionError({\n    message: \"Neither document `id` or `type` was provided when trying to resolve intent.\"\n  });\n}\nconst EMPTY_RECORD = {};\nconst IntentResolver = (0,react__WEBPACK_IMPORTED_MODULE_1__.memo)(function IntentResolver2() {\n  const {\n    navigate\n  } = (0,sanity_router__WEBPACK_IMPORTED_MODULE_14__.useRouter)();\n  const maybeIntent = (0,sanity_router__WEBPACK_IMPORTED_MODULE_14__.useRouterState)((0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(routerState => {\n    const intentName = typeof routerState.intent === \"string\" ? routerState.intent : void 0;\n    return intentName ? {\n      intent: intentName,\n      params: (0,sanity__WEBPACK_IMPORTED_MODULE_17__.isRecord)(routerState.params) ? routerState.params : EMPTY_RECORD,\n      payload: routerState.payload\n    } : void 0;\n  }, []));\n  const {\n    rootPaneNode,\n    structureContext\n  } = (0,_StructureToolProvider_CK141bsB_js__WEBPACK_IMPORTED_MODULE_15__.useStructureTool)();\n  const documentStore = (0,sanity__WEBPACK_IMPORTED_MODULE_17__.useDocumentStore)();\n  const [error, setError] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null);\n  if (error) throw error;\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (maybeIntent) {\n      const {\n        intent,\n        params,\n        payload\n      } = maybeIntent;\n      let cancelled = false;\n      async function effect() {\n        const {\n          id,\n          type\n        } = await ensureDocumentIdAndType(documentStore, typeof params.id === \"string\" ? params.id : void 0, typeof params.type === \"string\" ? params.type : void 0);\n        if (cancelled) return;\n        const panes = await resolveIntent({\n          intent,\n          params: {\n            ...params,\n            id,\n            type\n          },\n          payload,\n          rootPaneNode,\n          structureContext\n        });\n        if (cancelled) return;\n        navigate({\n          panes\n        }, {\n          replace: true\n        });\n      }\n      effect().catch(setError);\n      return () => {\n        cancelled = true;\n      };\n    }\n  }, [documentStore, maybeIntent, navigate, rootPaneNode, structureContext]);\n  return null;\n});\nvar __freeze$1 = Object.freeze;\nvar __defProp$1 = Object.defineProperty;\nvar __template$1 = (cooked, raw) => __freeze$1(__defProp$1(cooked, \"raw\", {\n  value: __freeze$1(raw || cooked.slice())\n}));\nvar _a$1;\nconst PathSegment = styled_components__WEBPACK_IMPORTED_MODULE_35__[\"default\"].span(_a$1 || (_a$1 = __template$1([\"\\n  &:not(:last-child)::after {\\n    content: ' \\u279D ';\\n    opacity: 0.5;\\n  }\\n\"])));\nfunction formatStack(stack) {\n  return stack.replace(/\\(\\.\\.\\.\\)\\./g, \"(...)\\n  .\").replace(/__WEBPACK_IMPORTED_MODULE_\\d+_+/g, \"\").replace(/___default\\./g, \".\").replace(new RegExp(\" \\\\(https?:\\\\/\\\\/\".concat(window.location.host), \"g\"), \" (\");\n}\nfunction StructureError(_ref8) {\n  let {\n    error\n  } = _ref8;\n  if (!(error instanceof PaneResolutionError)) {\n    throw error;\n  }\n  const {\n    cause\n  } = error;\n  const {\n    t\n  } = (0,sanity__WEBPACK_IMPORTED_MODULE_17__.useTranslation)(_StructureToolProvider_CK141bsB_js__WEBPACK_IMPORTED_MODULE_15__.structureLocaleNamespace);\n  const stack = (cause == null ? void 0 : cause.stack) || error.stack;\n  const showStack = stack && !(cause instanceof _StructureToolProvider_CK141bsB_js__WEBPACK_IMPORTED_MODULE_15__.SerializeError) && !error.message.includes(\"Module build failed:\");\n  const path = cause instanceof _StructureToolProvider_CK141bsB_js__WEBPACK_IMPORTED_MODULE_15__.SerializeError ? cause.path : [];\n  const helpId = cause instanceof _StructureToolProvider_CK141bsB_js__WEBPACK_IMPORTED_MODULE_15__.SerializeError && cause.helpId || error.helpId;\n  const handleReload = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(() => {\n    window.location.reload();\n  }, []);\n  return /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui__WEBPACK_IMPORTED_MODULE_36__.Card, {\n    height: \"fill\",\n    overflow: \"auto\",\n    padding: 4,\n    sizing: \"border\",\n    tone: \"critical\",\n    children: /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_sanity_ui__WEBPACK_IMPORTED_MODULE_36__.Container, {\n      children: [/* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui__WEBPACK_IMPORTED_MODULE_36__.Heading, {\n        as: \"h2\",\n        children: t(\"structure-error.header.text\")\n      }), /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_sanity_ui__WEBPACK_IMPORTED_MODULE_36__.Card, {\n        marginTop: 4,\n        padding: 4,\n        radius: 2,\n        overflow: \"auto\",\n        shadow: 1,\n        tone: \"inherit\",\n        children: [path.length > 0 && /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_sanity_ui__WEBPACK_IMPORTED_MODULE_36__.Stack, {\n          space: 2,\n          children: [/* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui__WEBPACK_IMPORTED_MODULE_36__.Text, {\n            size: 1,\n            weight: \"medium\",\n            children: t(\"structure-error.structure-path.label\")\n          }), /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui__WEBPACK_IMPORTED_MODULE_36__.Code, {\n            children: path.slice(1).map((segment, i) =>\n            // eslint-disable-next-line react/no-array-index-key\n            /* @__PURE__ */\n            (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(PathSegment, {\n              children: segment\n            }, \"\".concat(segment, \"-\").concat(i)))\n          })]\n        }), /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_sanity_ui__WEBPACK_IMPORTED_MODULE_36__.Stack, {\n          marginTop: 4,\n          space: 2,\n          children: [/* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui__WEBPACK_IMPORTED_MODULE_36__.Text, {\n            size: 1,\n            weight: \"medium\",\n            children: t(\"structure-error.error.label\")\n          }), /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui__WEBPACK_IMPORTED_MODULE_36__.Code, {\n            children: showStack ? formatStack(stack) : error.message\n          })]\n        }), helpId && /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui__WEBPACK_IMPORTED_MODULE_36__.Box, {\n          marginTop: 4,\n          children: /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui__WEBPACK_IMPORTED_MODULE_36__.Text, {\n            children: /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"a\", {\n              href: (0,_sanity_generate_help_url__WEBPACK_IMPORTED_MODULE_27__.generateHelpUrl)(helpId),\n              rel: \"noopener noreferrer\",\n              target: \"_blank\",\n              children: t(\"structure-error.docs-link.text\")\n            })\n          })\n        }), /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui__WEBPACK_IMPORTED_MODULE_36__.Box, {\n          marginTop: 4,\n          children: /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_getJsonStream_RYwhuhmq_js__WEBPACK_IMPORTED_MODULE_37__.Button, {\n            text: t(\"structure-error.reload-button.text\"),\n            icon: _sanity_icons__WEBPACK_IMPORTED_MODULE_38__.SyncIcon,\n            tone: \"primary\",\n            onClick: handleReload\n          })\n        })]\n      })]\n    })\n  });\n}\nfunction UnknownPane(props) {\n  const {\n    isSelected,\n    pane,\n    paneKey\n  } = props;\n  const type = (0,sanity__WEBPACK_IMPORTED_MODULE_17__.isRecord)(pane) && pane.type || null;\n  const {\n    t\n  } = (0,sanity__WEBPACK_IMPORTED_MODULE_17__.useTranslation)(_StructureToolProvider_CK141bsB_js__WEBPACK_IMPORTED_MODULE_15__.structureLocaleNamespace);\n  return /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_StructureToolProvider_CK141bsB_js__WEBPACK_IMPORTED_MODULE_15__.Pane, {\n    id: paneKey,\n    selected: isSelected,\n    children: [/* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_StructureToolProvider_CK141bsB_js__WEBPACK_IMPORTED_MODULE_15__.PaneHeader, {\n      title: t(\"panes.unknown-pane-type.title\")\n    }), /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_StructureToolProvider_CK141bsB_js__WEBPACK_IMPORTED_MODULE_15__.PaneContent, {\n      children: /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui__WEBPACK_IMPORTED_MODULE_36__.Box, {\n        padding: 4,\n        children: typeof type === \"string\" ? /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui__WEBPACK_IMPORTED_MODULE_36__.Text, {\n          as: \"p\",\n          muted: true,\n          children: /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(sanity__WEBPACK_IMPORTED_MODULE_17__.Translate, {\n            t,\n            i18nKey: \"panes.unknown-pane-type.unknown-type.text\",\n            values: {\n              type\n            }\n          })\n        }) : /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui__WEBPACK_IMPORTED_MODULE_36__.Text, {\n          as: \"p\",\n          muted: true,\n          children: /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(sanity__WEBPACK_IMPORTED_MODULE_17__.Translate, {\n            t,\n            i18nKey: \"panes.unknown-pane-type.missing-type.text\"\n          })\n        })\n      })\n    })]\n  });\n}\nconst paneMap = {\n  component: (0,react__WEBPACK_IMPORTED_MODULE_1__.lazy)(() => __webpack_require__.e(/*! import() */ \"_app-pages-browser_node_modules_sanity_lib__chunks_index-pIqlMpni_js\").then(__webpack_require__.bind(__webpack_require__, /*! ./index-pIqlMpni.js */ \"(app-pages-browser)/./node_modules/sanity/lib/_chunks/index-pIqlMpni.js\"))),\n  document: (0,react__WEBPACK_IMPORTED_MODULE_1__.lazy)(() => __webpack_require__.e(/*! import() */ \"_app-pages-browser_node_modules_sanity_lib__chunks_pane-DelUyv32_js\").then(__webpack_require__.bind(__webpack_require__, /*! ./pane-DelUyv32.js */ \"(app-pages-browser)/./node_modules/sanity/lib/_chunks/pane-DelUyv32.js\"))),\n  documentList: (0,react__WEBPACK_IMPORTED_MODULE_1__.lazy)(() => __webpack_require__.e(/*! import() */ \"_app-pages-browser_node_modules_sanity_lib__chunks_pane-CoYwJxjj_js\").then(__webpack_require__.bind(__webpack_require__, /*! ./pane-CoYwJxjj.js */ \"(app-pages-browser)/./node_modules/sanity/lib/_chunks/pane-CoYwJxjj.js\"))),\n  list: (0,react__WEBPACK_IMPORTED_MODULE_1__.lazy)(() => __webpack_require__.e(/*! import() */ \"_app-pages-browser_node_modules_sanity_lib__chunks_index-DH4YIT_w_js\").then(__webpack_require__.bind(__webpack_require__, /*! ./index-DH4YIT_w.js */ \"(app-pages-browser)/./node_modules/sanity/lib/_chunks/index-DH4YIT_w.js\")))\n};\nconst StructureToolPane = (0,react__WEBPACK_IMPORTED_MODULE_1__.memo)(function StructureToolPane2(props) {\n  const {\n    active,\n    childItemId,\n    groupIndex,\n    index,\n    itemId,\n    pane,\n    paneKey,\n    params,\n    payload,\n    path,\n    selected,\n    siblingIndex\n  } = props;\n  const PaneComponent = paneMap[pane.type] || UnknownPane;\n  return /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(PaneRouterProvider, {\n    flatIndex: index,\n    index: groupIndex,\n    params,\n    payload,\n    siblingIndex,\n    children: /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(react__WEBPACK_IMPORTED_MODULE_1__.Suspense, {\n      fallback: /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_StructureToolProvider_CK141bsB_js__WEBPACK_IMPORTED_MODULE_15__.LoadingPane, {\n        paneKey,\n        path,\n        selected\n      }),\n      children: /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(PaneComponent, {\n        childItemId: childItemId || \"\",\n        index,\n        itemId,\n        isActive: active,\n        isSelected: selected,\n        paneKey,\n        pane\n      })\n    })\n  });\n}, (_ref9, _ref10) => {\n  let {\n    params: prevParams = {},\n    payload: prevPayload = null,\n    ...prev\n  } = _ref9;\n  let {\n    params: nextParams = {},\n    payload: nextPayload = null,\n    ...next\n  } = _ref10;\n  if (!lodash_isEqual_js__WEBPACK_IMPORTED_MODULE_3___default()(prevParams, nextParams)) return false;\n  if (!lodash_isEqual_js__WEBPACK_IMPORTED_MODULE_3___default()(prevPayload, nextPayload)) return false;\n  const keys = /* @__PURE__ */new Set([...Object.keys(prev), ...Object.keys(next)]);\n  for (const key of keys) {\n    if (prev[key] !== next[key]) return false;\n  }\n  return true;\n});\nfunction NoDocumentTypesScreen() {\n  const {\n    t\n  } = (0,sanity__WEBPACK_IMPORTED_MODULE_17__.useTranslation)(_StructureToolProvider_CK141bsB_js__WEBPACK_IMPORTED_MODULE_15__.structureLocaleNamespace);\n  return /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui__WEBPACK_IMPORTED_MODULE_36__.Card, {\n    height: \"fill\",\n    children: /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui__WEBPACK_IMPORTED_MODULE_36__.Flex, {\n      align: \"center\",\n      height: \"fill\",\n      justify: \"center\",\n      padding: 4,\n      sizing: \"border\",\n      children: /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui__WEBPACK_IMPORTED_MODULE_36__.Container, {\n        width: 0,\n        children: /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui__WEBPACK_IMPORTED_MODULE_36__.Card, {\n          padding: 4,\n          radius: 2,\n          shadow: 1,\n          tone: \"caution\",\n          children: /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_sanity_ui__WEBPACK_IMPORTED_MODULE_36__.Flex, {\n            children: [/* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui__WEBPACK_IMPORTED_MODULE_36__.Box, {\n              children: /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui__WEBPACK_IMPORTED_MODULE_36__.Text, {\n                size: 1,\n                children: /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_icons__WEBPACK_IMPORTED_MODULE_38__.WarningOutlineIcon, {})\n              })\n            }), /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_sanity_ui__WEBPACK_IMPORTED_MODULE_36__.Stack, {\n              flex: 1,\n              marginLeft: 3,\n              space: 3,\n              children: [/* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui__WEBPACK_IMPORTED_MODULE_36__.Text, {\n                as: \"h1\",\n                size: 1,\n                weight: \"medium\",\n                children: t(\"no-document-types-screen.title\")\n              }), /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui__WEBPACK_IMPORTED_MODULE_36__.Text, {\n                as: \"p\",\n                muted: true,\n                size: 1,\n                children: t(\"no-document-types-screen.subtitle\")\n              }), /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui__WEBPACK_IMPORTED_MODULE_36__.Text, {\n                as: \"p\",\n                muted: true,\n                size: 1,\n                children: /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"a\", {\n                  href: \"https://www.sanity.io/docs/create-a-schema-and-configure-sanity-studio\",\n                  target: \"_blank\",\n                  rel: \"noreferrer\",\n                  children: t(\"no-document-types-screen.link-text\")\n                })\n              })]\n            })]\n          })\n        })\n      })\n    })\n  });\n}\nconst DocumentTitle = props => {\n  const {\n    documentId,\n    documentType\n  } = props;\n  const editState = (0,sanity__WEBPACK_IMPORTED_MODULE_39__.useEditState)(documentId, documentType);\n  const schema = (0,sanity__WEBPACK_IMPORTED_MODULE_17__.useSchema)();\n  const {\n    t\n  } = (0,sanity__WEBPACK_IMPORTED_MODULE_17__.useTranslation)(_StructureToolProvider_CK141bsB_js__WEBPACK_IMPORTED_MODULE_15__.structureLocaleNamespace);\n  const isNewDocument = !(editState == null ? void 0 : editState.published) && !(editState == null ? void 0 : editState.draft);\n  const documentValue = (editState == null ? void 0 : editState.draft) || (editState == null ? void 0 : editState.published);\n  const schemaType = schema.get(documentType);\n  const {\n    value,\n    isLoading: previewValueIsLoading\n  } = (0,sanity__WEBPACK_IMPORTED_MODULE_17__.useDocumentPreview)({\n    enabled: true,\n    schemaType,\n    value: documentValue\n  });\n  const documentTitle = isNewDocument ? t(\"browser-document-title.new-document\", {\n    schemaType: (schemaType == null ? void 0 : schemaType.title) || (schemaType == null ? void 0 : schemaType.name)\n  }) : (value == null ? void 0 : value.title) || t(\"browser-document-title.untitled-document\");\n  const settled = editState.ready && !previewValueIsLoading;\n  const newTitle = useConstructDocumentTitle(documentTitle);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (!settled) return;\n    document.title = newTitle;\n  }, [documentTitle, settled, newTitle]);\n  return null;\n};\nconst PassthroughTitle = props => {\n  const {\n    title\n  } = props;\n  const newTitle = useConstructDocumentTitle(title);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    document.title = newTitle;\n  }, [newTitle, title]);\n  return null;\n};\nconst StructureTitle = props => {\n  const {\n    resolvedPanes\n  } = props;\n  if (!(resolvedPanes == null ? void 0 : resolvedPanes.length)) return null;\n  const lastPane = resolvedPanes[resolvedPanes.length - 1];\n  if (isLoadingPane(lastPane)) {\n    return /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(PassthroughTitle, {});\n  }\n  if (isDocumentPane(lastPane)) {\n    if (lastPane == null ? void 0 : lastPane.title) {\n      return /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(PassthroughTitle, {\n        title: lastPane.title\n      });\n    }\n    return /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(DocumentTitle, {\n      documentId: lastPane.options.id,\n      documentType: lastPane.options.type\n    });\n  }\n  return /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(PassthroughTitle, {\n    title: lastPane == null ? void 0 : lastPane.title\n  });\n};\nfunction useConstructDocumentTitle(activeTitle) {\n  const structureToolBaseTitle = (0,_StructureToolProvider_CK141bsB_js__WEBPACK_IMPORTED_MODULE_15__.useStructureTool)().structureContext.title;\n  return [activeTitle, structureToolBaseTitle].filter(title => title).join(\" | \");\n}\nfunction isDocumentPane(pane) {\n  return pane !== _StructureToolProvider_CK141bsB_js__WEBPACK_IMPORTED_MODULE_15__.LOADING_PANE && pane.type === \"document\";\n}\nfunction isLoadingPane(pane) {\n  return pane === _StructureToolProvider_CK141bsB_js__WEBPACK_IMPORTED_MODULE_15__.LOADING_PANE;\n}\nvar __freeze = Object.freeze;\nvar __defProp = Object.defineProperty;\nvar __template = (cooked, raw) => __freeze(__defProp(cooked, \"raw\", {\n  value: __freeze(raw || cooked.slice())\n}));\nvar _a;\nconst StyledPaneLayout = (0,styled_components__WEBPACK_IMPORTED_MODULE_35__[\"default\"])(_StructureToolProvider_CK141bsB_js__WEBPACK_IMPORTED_MODULE_15__.PaneLayout)(_a || (_a = __template([\"\\n  min-height: 100%;\\n  min-width: 320px;\\n\"])));\nconst isSaveHotkey = (0,is_hotkey__WEBPACK_IMPORTED_MODULE_12__[\"default\"])(\"mod+s\");\nconst StructureTool = (0,react__WEBPACK_IMPORTED_MODULE_1__.memo)(function StructureTool2(_ref11) {\n  let {\n    onPaneChange\n  } = _ref11;\n  var _a2;\n  const {\n    push: pushToast\n  } = (0,_sanity_ui__WEBPACK_IMPORTED_MODULE_36__.useToast)();\n  const schema = (0,sanity__WEBPACK_IMPORTED_MODULE_17__.useSchema)();\n  const {\n    layoutCollapsed,\n    setLayoutCollapsed\n  } = (0,_StructureToolProvider_CK141bsB_js__WEBPACK_IMPORTED_MODULE_15__.useStructureTool)();\n  const {\n    paneDataItems,\n    resolvedPanes\n  } = useResolvedPanes();\n  const isResolvingIntent = (0,sanity_router__WEBPACK_IMPORTED_MODULE_14__.useRouterState)((0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(routerState => typeof routerState.intent === \"string\", []));\n  const {\n    sanity: {\n      media\n    }\n  } = (0,_sanity_ui__WEBPACK_IMPORTED_MODULE_36__.useTheme)();\n  const [portalElement, setPortalElement] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null);\n  const handleRootCollapse = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(() => setLayoutCollapsed(true), [setLayoutCollapsed]);\n  const handleRootExpand = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(() => setLayoutCollapsed(false), [setLayoutCollapsed]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    if (resolvedPanes.length) {\n      onPaneChange(resolvedPanes);\n    }\n  }, [onPaneChange, resolvedPanes]);\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    const handleGlobalKeyDown = event => {\n      if (isSaveHotkey(event)) {\n        event.preventDefault();\n        pushToast({\n          closable: true,\n          id: \"auto-save-message\",\n          status: \"info\",\n          title: \"Your work is automatically saved!\",\n          duration: 4e3\n        });\n      }\n    };\n    window.addEventListener(\"keydown\", handleGlobalKeyDown);\n    return () => window.removeEventListener(\"keydown\", handleGlobalKeyDown);\n  }, [pushToast]);\n  const hasDefinedDocumentTypes = (_a2 = schema._original) == null ? void 0 : _a2.types.some(sanity__WEBPACK_IMPORTED_MODULE_39__._isCustomDocumentTypeDefinition);\n  if (!hasDefinedDocumentTypes) {\n    return /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(NoDocumentTypesScreen, {});\n  }\n  return /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_sanity_ui__WEBPACK_IMPORTED_MODULE_36__.PortalProvider, {\n    element: portalElement || null,\n    children: [/* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(StyledPaneLayout, {\n      flex: 1,\n      height: layoutCollapsed ? void 0 : \"fill\",\n      minWidth: media[1],\n      onCollapse: handleRootCollapse,\n      onExpand: handleRootExpand,\n      children: [paneDataItems.map(_ref12 => {\n        let {\n          active,\n          childItemId,\n          groupIndex,\n          itemId,\n          key: paneKey,\n          pane,\n          index: paneIndex,\n          params: paneParams,\n          path,\n          payload,\n          siblingIndex,\n          selected\n        } = _ref12;\n        return /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(react__WEBPACK_IMPORTED_MODULE_1__.Fragment, {\n          children: pane === _StructureToolProvider_CK141bsB_js__WEBPACK_IMPORTED_MODULE_15__.LOADING_PANE ? /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_StructureToolProvider_CK141bsB_js__WEBPACK_IMPORTED_MODULE_15__.LoadingPane, {\n            paneKey,\n            path,\n            selected\n          }) : /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(StructureToolPane, {\n            active,\n            groupIndex,\n            index: paneIndex,\n            pane,\n            childItemId,\n            itemId,\n            paneKey,\n            params: paneParams,\n            payload,\n            path,\n            selected,\n            siblingIndex\n          })\n        }, \"\".concat(pane === _StructureToolProvider_CK141bsB_js__WEBPACK_IMPORTED_MODULE_15__.LOADING_PANE ? \"loading\" : pane.type, \"-\").concat(paneIndex));\n      }), paneDataItems.length <= 1 && isResolvingIntent && /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_StructureToolProvider_CK141bsB_js__WEBPACK_IMPORTED_MODULE_15__.LoadingPane, {\n        paneKey: \"intent-resolver\"\n      })]\n    }), /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(StructureTitle, {\n      resolvedPanes\n    }), /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"div\", {\n      \"data-portal\": \"\",\n      ref: setPortalElement\n    })]\n  });\n});\nfunction StructureToolBoundary(_ref13) {\n  let {\n    tool: {\n      options\n    }\n  } = _ref13;\n  const {\n    unstable_sources: sources\n  } = (0,sanity__WEBPACK_IMPORTED_MODULE_17__.useWorkspace)();\n  const [firstSource] = sources;\n  const {\n    source,\n    defaultDocumentNode,\n    structure\n  } = options || {};\n  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n    (0,_StructureToolProvider_CK141bsB_js__WEBPACK_IMPORTED_MODULE_15__.setActivePanes)([]);\n    return () => (0,_StructureToolProvider_CK141bsB_js__WEBPACK_IMPORTED_MODULE_15__.setActivePanes)([]);\n  }, []);\n  const [{\n    error\n  }, setError] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)({\n    error: null\n  });\n  if (error) return /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(StructureError, {\n    error\n  });\n  return /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui__WEBPACK_IMPORTED_MODULE_36__.ErrorBoundary, {\n    onCatch: setError,\n    children: /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(sanity__WEBPACK_IMPORTED_MODULE_17__.SourceProvider, {\n      name: source || firstSource.name,\n      children: /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_StructureToolProvider_CK141bsB_js__WEBPACK_IMPORTED_MODULE_15__.StructureToolProvider, {\n        defaultDocumentNode,\n        structure,\n        children: [/* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(StructureTool, {\n          onPaneChange: _StructureToolProvider_CK141bsB_js__WEBPACK_IMPORTED_MODULE_15__.setActivePanes\n        }), /* @__PURE__ */(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(IntentResolver, {})]\n      })\n    })\n  });\n}\n\n//# sourceMappingURL=index-Bn6gWj4A.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9zYW5pdHkvbGliL19jaHVua3MvaW5kZXgtQm42Z1dqNEEuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQThDO0FBQ3lGO0FBQ3JDO0FBQytGO0FBQzJIO0FBQ2xRO0FBQ3hCO0FBQzBEO0FBQzVEO0FBQzBGO0FBQzlEO0FBQ3BCO0FBQ0o7QUFDeUI7QUFDdEI7QUFDYztBQUN4QjtBQUNSO0FBQ087QUFDVjtBQUNNO0FBQ0s7QUFDTDtBQUNLO0FBQ0k7QUFDYTtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJLEVBQUUseURBQVM7QUFDZixzQkFBc0IsOERBQWM7QUFDcEM7QUFDQTtBQUNBO0FBQ0EsSUFBSSxFQUFFLGtGQUFhO0FBQ25CLDJCQUEyQiw4Q0FBTztBQUNsQyxtQkFBbUIsOENBQU87QUFDMUI7QUFDQSxnQ0FBZ0Msa0RBQVc7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQjtBQUMzQjtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsNkJBQTZCLGtEQUFXO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCwrQkFBK0Isa0RBQVc7QUFDMUM7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsR0FBRztBQUNILHFCQUFxQixrREFBVztBQUNoQztBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNILG9CQUFvQixrREFBVztBQUMvQjtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNILDhCQUE4QixrREFBVztBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsNkRBQVE7QUFDakM7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMLEdBQUc7QUFDSCxjQUFjLDhDQUFPO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLDBCQUEwQix5RUFBUTtBQUNsQztBQUNBO0FBQ0Esc0JBQXNCO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBLHlCQUF5QixxREFBSTtBQUM3QjtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1IsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsd0JBQXdCLHNEQUFHLENBQUMsa0ZBQWlCO0FBQzdDO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsK0NBQU07QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPLGlEQUFRO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUUsOERBQWEsS0FBSyx5REFBUTtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EscUNBQXFDLG1EQUFZO0FBQ2pELGFBQWEsMkNBQUksc0JBQXNCLDBEQUFTO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyx5Q0FBRTtBQUNiLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUyxxREFBSTtBQUNiO0FBQ0EsS0FBSztBQUNMO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixxREFBYztBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtDQUErQztBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrREFBa0Q7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSSwwREFBUztBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLGVBQWUseUNBQUU7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxhQUFhLDZDQUFNO0FBQ25CO0FBQ0EsTUFBTSx5Q0FBRTtBQUNSO0FBQ0Esc0JBQXNCLG9EQUFHO0FBQ3pCLEtBQUs7QUFDTCxJQUFJO0FBQ0o7QUFDQTtBQUNBLHdPQUF3TywyRUFBZTtBQUN2UDtBQUNBO0FBQ0EsZUFBZSx5Q0FBRTtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5Qix3Q0FBSztBQUM5QixLQUFLO0FBQ0w7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLEVBQUUsb0RBQUc7QUFDTDtBQUNBLEdBQUc7QUFDSDtBQUNBLEVBQUUsb0RBQUc7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsR0FBRztBQUNIO0FBQ0EsRUFBRSwwREFBUyxNQUFNLHlEQUFRLElBQUksb0RBQUc7QUFDaEM7QUFDQSxvQkFBb0IsaUJBQWlCO0FBQ3JDO0FBQ0E7QUFDQSxXQUFXLHdEQUFPO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsRUFBRSxxREFBSTtBQUNOO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxFQUFFLDBEQUFTO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRSxxREFBSTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsRUFBRSxxRUFBb0I7QUFDdEI7QUFDQSxvQkFBb0IsaUJBQWlCO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSw2QkFBNkIsOENBQU8sV0FBVyxnREFBYTtBQUM1RCx1QkFBdUIsOENBQU8sOENBQThDLG9EQUFHO0FBQy9FO0FBQ0E7QUFDQSxJQUFJLEVBQUUseURBQVM7QUFDZixFQUFFLGdEQUFTO0FBQ1g7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLCtDQUFRO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSSxFQUFFLHFGQUFnQjtBQUN0QiwwQkFBMEIsK0NBQVE7QUFDbEM7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsRUFBRSxnREFBUztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSyxPQUFPLG9EQUFHO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMENBQTBDLDZFQUFZO0FBQ3RELGdEQUFnRDtBQUNoRCw0QkFBNEI7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSx5REFBSTtBQUNaO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixxREFBYztBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsdUJBQXVCLDJDQUFJO0FBQzNCO0FBQ0E7QUFDQSxJQUFJLEVBQUUseURBQVM7QUFDZixzQkFBc0IsOERBQWMsQ0FBQyxrREFBVztBQUNoRDtBQUNBO0FBQ0E7QUFDQSxjQUFjLGlEQUFRO0FBQ3RCO0FBQ0EsTUFBTTtBQUNOLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxJQUFJLEVBQUUscUZBQWdCO0FBQ3RCLHdCQUF3Qix5REFBZ0I7QUFDeEMsNEJBQTRCLCtDQUFRO0FBQ3BDO0FBQ0EsRUFBRSxnREFBUztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLG9CQUFvQiwwREFBTSxvRUFBb0UsMEJBQTBCLG1CQUFtQixLQUFLO0FBQ2hKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQSxJQUFJLEVBQUUsdURBQWMsQ0FBQyx5RkFBd0I7QUFDN0M7QUFDQSxnREFBZ0QsK0VBQWM7QUFDOUQsZ0NBQWdDLCtFQUFjO0FBQzlDLGtDQUFrQywrRUFBYztBQUNoRCx1QkFBdUIsa0RBQVc7QUFDbEM7QUFDQSxHQUFHO0FBQ0gsd0JBQXdCLHNEQUFHLENBQUMsNkNBQUk7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2Qix1REFBSSxDQUFDLGtEQUFTO0FBQzNDLGdDQUFnQyxzREFBRyxDQUFDLGdEQUFPO0FBQzNDO0FBQ0E7QUFDQSxPQUFPLGtCQUFrQix1REFBSSxDQUFDLDZDQUFJO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFEQUFxRCx1REFBSSxDQUFDLDhDQUFLO0FBQy9EO0FBQ0Esb0NBQW9DLHNEQUFHLENBQUMsNkNBQUk7QUFDNUM7QUFDQTtBQUNBO0FBQ0EsV0FBVyxrQkFBa0Isc0RBQUcsQ0FBQyw2Q0FBSTtBQUNyQztBQUNBO0FBQ0E7QUFDQSxZQUFZLHNEQUFHO0FBQ2Y7QUFDQSxhQUFhO0FBQ2IsV0FBVztBQUNYLFNBQVMsa0JBQWtCLHVEQUFJLENBQUMsOENBQUs7QUFDckM7QUFDQTtBQUNBLG9DQUFvQyxzREFBRyxDQUFDLDZDQUFJO0FBQzVDO0FBQ0E7QUFDQTtBQUNBLFdBQVcsa0JBQWtCLHNEQUFHLENBQUMsNkNBQUk7QUFDckM7QUFDQSxXQUFXO0FBQ1gsU0FBUyw0QkFBNEIsc0RBQUcsQ0FBQyw0Q0FBRztBQUM1QztBQUNBLG1DQUFtQyxzREFBRyxDQUFDLDZDQUFJO0FBQzNDLHFDQUFxQyxzREFBRztBQUN4QyxvQkFBb0IsMkVBQWU7QUFDbkM7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFdBQVc7QUFDWCxTQUFTLGtCQUFrQixzREFBRyxDQUFDLDRDQUFHO0FBQ2xDO0FBQ0EsbUNBQW1DLHNEQUFHLENBQUMsK0RBQU07QUFDN0M7QUFDQSxrQkFBa0Isb0RBQVE7QUFDMUI7QUFDQTtBQUNBLFdBQVc7QUFDWCxTQUFTO0FBQ1QsT0FBTztBQUNQLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKLGVBQWUsaURBQVE7QUFDdkI7QUFDQTtBQUNBLElBQUksRUFBRSx1REFBYyxDQUFDLHlGQUF3QjtBQUM3Qyx3QkFBd0IsdURBQUksQ0FBQyxxRUFBSTtBQUNqQztBQUNBO0FBQ0EsOEJBQThCLHNEQUFHLENBQUMsMkVBQVU7QUFDNUM7QUFDQSxLQUFLLGtCQUFrQixzREFBRyxDQUFDLDRFQUFXO0FBQ3RDLCtCQUErQixzREFBRyxDQUFDLDRDQUFHO0FBQ3RDO0FBQ0EsNERBQTRELHNEQUFHLENBQUMsNkNBQUk7QUFDcEU7QUFDQTtBQUNBLG1DQUFtQyxzREFBRyxDQUFDLDhDQUFTO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1gsU0FBUyxtQkFBbUIsc0RBQUcsQ0FBQyw2Q0FBSTtBQUNwQztBQUNBO0FBQ0EsbUNBQW1DLHNEQUFHLENBQUMsOENBQVM7QUFDaEQ7QUFDQTtBQUNBLFdBQVc7QUFDWCxTQUFTO0FBQ1QsT0FBTztBQUNQLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTtBQUNBLGFBQWEsMkNBQUksT0FBTyx1UUFBNkI7QUFDckQsWUFBWSwyQ0FBSSxPQUFPLG9RQUE0QjtBQUNuRCxnQkFBZ0IsMkNBQUksT0FBTyxvUUFBNEI7QUFDdkQsUUFBUSwyQ0FBSSxPQUFPLHVRQUE2QjtBQUNoRDtBQUNBLDBCQUEwQiwyQ0FBSTtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBLHdCQUF3QixzREFBRztBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLHNEQUFHLENBQUMsMkNBQVE7QUFDekMsK0JBQStCLHNEQUFHLENBQUMsNEVBQVc7QUFDOUM7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLCtCQUErQixzREFBRztBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0wsR0FBRztBQUNILENBQUM7QUFDRDtBQUNBLDJCQUEyQjtBQUMzQjtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsMkJBQTJCO0FBQzNCO0FBQ0E7QUFDQSxJQUFJO0FBQ0osT0FBTyx3REFBTztBQUNkLE9BQU8sd0RBQU87QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLElBQUksRUFBRSx1REFBYyxDQUFDLHlGQUF3QjtBQUM3Qyx3QkFBd0Isc0RBQUcsQ0FBQyw2Q0FBSTtBQUNoQztBQUNBLDZCQUE2QixzREFBRyxDQUFDLDZDQUFJO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0Isc0RBQUcsQ0FBQyxrREFBUztBQUM1QztBQUNBLGlDQUFpQyxzREFBRyxDQUFDLDZDQUFJO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DLHVEQUFJLENBQUMsNkNBQUk7QUFDNUMsc0NBQXNDLHNEQUFHLENBQUMsNENBQUc7QUFDN0MsdUNBQXVDLHNEQUFHLENBQUMsNkNBQUk7QUFDL0M7QUFDQSx5Q0FBeUMsc0RBQUcsQ0FBQyw4REFBa0IsSUFBSTtBQUNuRSxlQUFlO0FBQ2YsYUFBYSxrQkFBa0IsdURBQUksQ0FBQyw4Q0FBSztBQUN6QztBQUNBO0FBQ0E7QUFDQSx3Q0FBd0Msc0RBQUcsQ0FBQyw2Q0FBSTtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsa0JBQWtCLHNEQUFHLENBQUMsNkNBQUk7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLGtCQUFrQixzREFBRyxDQUFDLDZDQUFJO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBLHlDQUF5QyxzREFBRztBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixlQUFlO0FBQ2YsYUFBYTtBQUNiLFdBQVc7QUFDWCxTQUFTO0FBQ1QsT0FBTztBQUNQLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSixvQkFBb0IscURBQVk7QUFDaEMsaUJBQWlCLGtEQUFTO0FBQzFCO0FBQ0E7QUFDQSxJQUFJLEVBQUUsdURBQWMsQ0FBQyx5RkFBd0I7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSSxFQUFFLDJEQUF3QjtBQUM5QjtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsRUFBRSxnREFBUztBQUNYO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBLEVBQUUsZ0RBQVM7QUFDWDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixzREFBRyxxQkFBcUI7QUFDbEQ7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLHNEQUFHO0FBQy9CO0FBQ0EsT0FBTztBQUNQO0FBQ0EsMEJBQTBCLHNEQUFHO0FBQzdCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSx3QkFBd0Isc0RBQUc7QUFDM0I7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLGlDQUFpQyxxRkFBZ0I7QUFDakQ7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLDZFQUFZO0FBQzlCO0FBQ0E7QUFDQSxrQkFBa0IsNkVBQVk7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLHlCQUF5Qiw4REFBTSxDQUFDLDJFQUFVLGdEQUFnRCxxQkFBcUI7QUFDL0cscUJBQXFCLHNEQUFRO0FBQzdCLHNCQUFzQiwyQ0FBSTtBQUMxQjtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBLElBQUksRUFBRSxxREFBUTtBQUNkLGlCQUFpQixrREFBUztBQUMxQjtBQUNBO0FBQ0E7QUFDQSxJQUFJLEVBQUUscUZBQWdCO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSiw0QkFBNEIsOERBQWMsQ0FBQyxrREFBVztBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUksRUFBRSxxREFBUTtBQUNkLDRDQUE0QywrQ0FBUTtBQUNwRCw2QkFBNkIsa0RBQVc7QUFDeEMsMkJBQTJCLGtEQUFXO0FBQ3RDLEVBQUUsZ0RBQVM7QUFDWDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsRUFBRSxnREFBUztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCw2RkFBNkYsb0VBQStCO0FBQzVIO0FBQ0EsMEJBQTBCLHNEQUFHLDBCQUEwQjtBQUN2RDtBQUNBLHdCQUF3Qix1REFBSSxDQUFDLHVEQUFjO0FBQzNDO0FBQ0EsOEJBQThCLHVEQUFJO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWLDhCQUE4QixzREFBRyxDQUFDLDJDQUFRO0FBQzFDLDZCQUE2Qiw2RUFBWSxrQkFBa0Isc0RBQUcsQ0FBQyw0RUFBVztBQUMxRTtBQUNBO0FBQ0E7QUFDQSxXQUFXLG1CQUFtQixzREFBRztBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1gsU0FBUyxxQkFBcUIsNkVBQVk7QUFDMUMsT0FBTyxvRUFBb0Usc0RBQUcsQ0FBQyw0RUFBVztBQUMxRjtBQUNBLE9BQU87QUFDUCxLQUFLLGtCQUFrQixzREFBRztBQUMxQjtBQUNBLEtBQUssa0JBQWtCLHNEQUFHO0FBQzFCO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNILENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQSxJQUFJLEVBQUUscURBQVk7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSixFQUFFLGdEQUFTO0FBQ1gsSUFBSSxtRkFBYztBQUNsQixpQkFBaUIsbUZBQWM7QUFDL0IsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHLGNBQWMsK0NBQVE7QUFDekI7QUFDQSxHQUFHO0FBQ0gsbUNBQW1DLHNEQUFHO0FBQ3RDO0FBQ0EsR0FBRztBQUNILHdCQUF3QixzREFBRyxDQUFDLHNEQUFhO0FBQ3pDO0FBQ0EsNkJBQTZCLHNEQUFHLENBQUMsbURBQWM7QUFDL0M7QUFDQSwrQkFBK0IsdURBQUksQ0FBQyxzRkFBcUI7QUFDekQ7QUFDQTtBQUNBLGtDQUFrQyxzREFBRztBQUNyQyx3QkFBd0IsK0VBQWM7QUFDdEMsU0FBUyxrQkFBa0Isc0RBQUcsbUJBQW1CO0FBQ2pELE9BQU87QUFDUCxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQzRDO0FBQzVDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL25vZGVfbW9kdWxlcy9zYW5pdHkvbGliL19jaHVua3MvaW5kZXgtQm42Z1dqNEEuanM/OGQ0YSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBqc3gsIGpzeHMgfSBmcm9tICdyZWFjdC9qc3gtcnVudGltZSc7XG5pbXBvcnQgeyBDYXJkLCBDb250YWluZXIsIEhlYWRpbmcsIFN0YWNrLCBUZXh0LCBDb2RlLCBCb3gsIEZsZXgsIHVzZVRvYXN0LCB1c2VUaGVtZSwgUG9ydGFsUHJvdmlkZXIsIEVycm9yQm91bmRhcnkgfSBmcm9tICdAc2FuaXR5L3VpJztcbmltcG9ydCB7IHVzZU1lbW8sIHVzZUNhbGxiYWNrLCB1c2VTdGF0ZSwgdXNlRWZmZWN0LCBtZW1vLCBsYXp5LCBTdXNwZW5zZSwgRnJhZ21lbnQgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBpc1JlY29yZCwgdXNlRG9jdW1lbnRTdG9yZSwgdXNlVHJhbnNsYXRpb24sIFRyYW5zbGF0ZSwgdXNlRWRpdFN0YXRlLCB1c2VTY2hlbWEsIHVuc3RhYmxlX3VzZVZhbHVlUHJldmlldywgX2lzQ3VzdG9tRG9jdW1lbnRUeXBlRGVmaW5pdGlvbiwgdXNlV29ya3NwYWNlLCBTb3VyY2VQcm92aWRlciB9IGZyb20gJ3Nhbml0eSc7XG5pbXBvcnQgeyB1c2VQYW5lTGF5b3V0LCBDaGlsZExpbmssIEJhY2tMaW5rLCBSZWZlcmVuY2VDaGlsZExpbmssIFBhcmFtZXRlcml6ZWRMaW5rLCBQYW5lUm91dGVyQ29udGV4dCwgdXNlU3RydWN0dXJlVG9vbCwgTE9BRElOR19QQU5FLCBzdHJ1Y3R1cmVMb2NhbGVOYW1lc3BhY2UsIFNlcmlhbGl6ZUVycm9yLCBQYW5lLCBQYW5lSGVhZGVyLCBQYW5lQ29udGVudCwgTG9hZGluZ1BhbmUsIFBhbmVMYXlvdXQsIHNldEFjdGl2ZVBhbmVzLCBTdHJ1Y3R1cmVUb29sUHJvdmlkZXIgfSBmcm9tICcuL1N0cnVjdHVyZVRvb2xQcm92aWRlci1DSzE0MWJzQi5qcyc7XG5pbXBvcnQgeyB1c2VSb3V0ZXIsIHVzZVJvdXRlclN0YXRlIH0gZnJvbSAnc2FuaXR5L3JvdXRlcic7XG5pbXBvcnQgb21pdCBmcm9tICdsb2Rhc2gvb21pdC5qcyc7XG5pbXBvcnQgeyBpc09ic2VydmFibGUsIGZyb20sIG9mLCBmaXJzdFZhbHVlRnJvbSwgTkVWRVIsIGNvbmNhdCwgUmVwbGF5U3ViamVjdCB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgbmFub2lkIH0gZnJvbSAnbmFub2lkJztcbmltcG9ydCB7IHN3aXRjaE1hcCwgcHVibGlzaFJlcGxheSwgcmVmQ291bnQsIG1hcCwgc3RhcnRXaXRoLCBwYWlyd2lzZSwgc2NhbiwgZGlzdGluY3RVbnRpbENoYW5nZWQgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5pbXBvcnQgeyBnZW5lcmF0ZUhlbHBVcmwgfSBmcm9tICdAc2FuaXR5L2dlbmVyYXRlLWhlbHAtdXJsJztcbmltcG9ydCBpc0VxdWFsIGZyb20gJ2xvZGFzaC9pc0VxdWFsLmpzJztcbmltcG9ydCB7IHV1aWQgfSBmcm9tICdAc2FuaXR5L3V1aWQnO1xuaW1wb3J0IHsgU3luY0ljb24sIFdhcm5pbmdPdXRsaW5lSWNvbiB9IGZyb20gJ0BzYW5pdHkvaWNvbnMnO1xuaW1wb3J0IHN0eWxlZCBmcm9tICdzdHlsZWQtY29tcG9uZW50cyc7XG5pbXBvcnQgeyBCdXR0b24gfSBmcm9tICcuL2dldEpzb25TdHJlYW0tUll3aHVobXEuanMnO1xuaW1wb3J0ICdsb2Rhc2gvY2FtZWxDYXNlLmpzJztcbmltcG9ydCAnc3BlYWtpbmd1cmwnO1xuaW1wb3J0ICdsb2Rhc2gvdW5pcXVlSWQuanMnO1xuaW1wb3J0ICdyZWFjdC1pcyc7XG5pbXBvcnQgJ2xvZGFzaC91bmlxLmpzJztcbmltcG9ydCAnbG9kYXNoL2tlYmFiQ2FzZS5qcyc7XG5pbXBvcnQgJ2xvZGFzaC9maW5kLmpzJztcbmltcG9ydCAnbG9kYXNoL3N0YXJ0Q2FzZS5qcyc7XG5pbXBvcnQgaXNIb3RrZXkgZnJvbSAnaXMtaG90a2V5JztcbmltcG9ydCB7IHRvU3RyaW5nIH0gZnJvbSAnQHNhbml0eS91dGlsL3BhdGhzJztcbmNvbnN0IGVtcHR5QXJyYXkgPSBbXTtcbmZ1bmN0aW9uIFBhbmVSb3V0ZXJQcm92aWRlcihwcm9wcykge1xuICBjb25zdCB7XG4gICAgY2hpbGRyZW4sXG4gICAgZmxhdEluZGV4LFxuICAgIGluZGV4LFxuICAgIHBhcmFtcyxcbiAgICBwYXlsb2FkLFxuICAgIHNpYmxpbmdJbmRleFxuICB9ID0gcHJvcHM7XG4gIGNvbnN0IHtcbiAgICBuYXZpZ2F0ZSxcbiAgICBuYXZpZ2F0ZUludGVudCxcbiAgICByZXNvbHZlUGF0aEZyb21TdGF0ZVxuICB9ID0gdXNlUm91dGVyKCk7XG4gIGNvbnN0IHJvdXRlclN0YXRlID0gdXNlUm91dGVyU3RhdGUoKTtcbiAgY29uc3Qge1xuICAgIHBhbmVzLFxuICAgIGV4cGFuZFxuICB9ID0gdXNlUGFuZUxheW91dCgpO1xuICBjb25zdCByb3V0ZXJQYW5lR3JvdXBzID0gdXNlTWVtbygoKSA9PiAocm91dGVyU3RhdGUgPT0gbnVsbCA/IHZvaWQgMCA6IHJvdXRlclN0YXRlLnBhbmVzKSB8fCBlbXB0eUFycmF5LCBbcm91dGVyU3RhdGUgPT0gbnVsbCA/IHZvaWQgMCA6IHJvdXRlclN0YXRlLnBhbmVzXSk7XG4gIGNvbnN0IGxhc3RQYW5lID0gdXNlTWVtbygoKSA9PiBwYW5lcyA9PSBudWxsID8gdm9pZCAwIDogcGFuZXNbcGFuZXMubGVuZ3RoIC0gMl0sIFtwYW5lc10pO1xuICBjb25zdCBncm91cEluZGV4ID0gaW5kZXggLSAxO1xuICBjb25zdCBjcmVhdGVOZXh0Um91dGVyU3RhdGUgPSB1c2VDYWxsYmFjayhtb2RpZmllciA9PiB7XG4gICAgY29uc3QgY3VycmVudEdyb3VwID0gcm91dGVyUGFuZUdyb3Vwc1tncm91cEluZGV4XSB8fCBbXTtcbiAgICBjb25zdCBjdXJyZW50SXRlbSA9IGN1cnJlbnRHcm91cFtzaWJsaW5nSW5kZXhdO1xuICAgIGNvbnN0IG5leHRHcm91cCA9IG1vZGlmaWVyKGN1cnJlbnRHcm91cCwgY3VycmVudEl0ZW0pO1xuICAgIGNvbnN0IG5leHRQYW5lcyA9IFsuLi5yb3V0ZXJQYW5lR3JvdXBzLnNsaWNlKDAsIGdyb3VwSW5kZXgpLCBuZXh0R3JvdXAsIC4uLnJvdXRlclBhbmVHcm91cHMuc2xpY2UoZ3JvdXBJbmRleCArIDEpXTtcbiAgICBjb25zdCBuZXh0Um91dGVyU3RhdGUgPSB7XG4gICAgICAuLi4ocm91dGVyU3RhdGUgfHwge30pLFxuICAgICAgcGFuZXM6IG5leHRQYW5lc1xuICAgIH07XG4gICAgcmV0dXJuIG5leHRSb3V0ZXJTdGF0ZTtcbiAgfSwgW2dyb3VwSW5kZXgsIHJvdXRlclBhbmVHcm91cHMsIHJvdXRlclN0YXRlLCBzaWJsaW5nSW5kZXhdKTtcbiAgY29uc3QgbW9kaWZ5Q3VycmVudEdyb3VwID0gdXNlQ2FsbGJhY2sobW9kaWZpZXIgPT4ge1xuICAgIGNvbnN0IG5leHRSb3V0ZXJTdGF0ZSA9IGNyZWF0ZU5leHRSb3V0ZXJTdGF0ZShtb2RpZmllcik7XG4gICAgc2V0VGltZW91dCgoKSA9PiBuYXZpZ2F0ZShuZXh0Um91dGVyU3RhdGUpLCAwKTtcbiAgICByZXR1cm4gbmV4dFJvdXRlclN0YXRlO1xuICB9LCBbY3JlYXRlTmV4dFJvdXRlclN0YXRlLCBuYXZpZ2F0ZV0pO1xuICBjb25zdCBjcmVhdGVQYXRoV2l0aFBhcmFtcyA9IHVzZUNhbGxiYWNrKG5leHRQYXJhbXMgPT4ge1xuICAgIGNvbnN0IG5leHRSb3V0ZXJTdGF0ZSA9IGNyZWF0ZU5leHRSb3V0ZXJTdGF0ZSgoc2libGluZ3MsIGl0ZW0pID0+IFsuLi5zaWJsaW5ncy5zbGljZSgwLCBzaWJsaW5nSW5kZXgpLCB7XG4gICAgICAuLi5pdGVtLFxuICAgICAgcGFyYW1zOiBuZXh0UGFyYW1zXG4gICAgfSwgLi4uc2libGluZ3Muc2xpY2Uoc2libGluZ0luZGV4ICsgMSldKTtcbiAgICByZXR1cm4gcmVzb2x2ZVBhdGhGcm9tU3RhdGUobmV4dFJvdXRlclN0YXRlKTtcbiAgfSwgW2NyZWF0ZU5leHRSb3V0ZXJTdGF0ZSwgcmVzb2x2ZVBhdGhGcm9tU3RhdGUsIHNpYmxpbmdJbmRleF0pO1xuICBjb25zdCBzZXRQYXlsb2FkID0gdXNlQ2FsbGJhY2sobmV4dFBheWxvYWQgPT4ge1xuICAgIG1vZGlmeUN1cnJlbnRHcm91cCgoc2libGluZ3MsIGl0ZW0pID0+IFsuLi5zaWJsaW5ncy5zbGljZSgwLCBzaWJsaW5nSW5kZXgpLCB7XG4gICAgICAuLi5pdGVtLFxuICAgICAgcGF5bG9hZDogbmV4dFBheWxvYWRcbiAgICB9LCAuLi5zaWJsaW5ncy5zbGljZShzaWJsaW5nSW5kZXggKyAxKV0pO1xuICB9LCBbbW9kaWZ5Q3VycmVudEdyb3VwLCBzaWJsaW5nSW5kZXhdKTtcbiAgY29uc3Qgc2V0UGFyYW1zID0gdXNlQ2FsbGJhY2sobmV4dFBhcmFtcyA9PiB7XG4gICAgbW9kaWZ5Q3VycmVudEdyb3VwKChzaWJsaW5ncywgaXRlbSkgPT4gWy4uLnNpYmxpbmdzLnNsaWNlKDAsIHNpYmxpbmdJbmRleCksIHtcbiAgICAgIC4uLml0ZW0sXG4gICAgICBwYXJhbXM6IG5leHRQYXJhbXNcbiAgICB9LCAuLi5zaWJsaW5ncy5zbGljZShzaWJsaW5nSW5kZXggKyAxKV0pO1xuICB9LCBbbW9kaWZ5Q3VycmVudEdyb3VwLCBzaWJsaW5nSW5kZXhdKTtcbiAgY29uc3QgaGFuZGxlRWRpdFJlZmVyZW5jZSA9IHVzZUNhbGxiYWNrKF9yZWYgPT4ge1xuICAgIGxldCB7XG4gICAgICBpZCxcbiAgICAgIHBhcmVudFJlZlBhdGgsXG4gICAgICB0eXBlLFxuICAgICAgdGVtcGxhdGVcbiAgICB9ID0gX3JlZjtcbiAgICBuYXZpZ2F0ZSh7XG4gICAgICBwYW5lczogWy4uLnJvdXRlclBhbmVHcm91cHMuc2xpY2UoMCwgZ3JvdXBJbmRleCArIDEpLCBbe1xuICAgICAgICBpZCxcbiAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgdGVtcGxhdGU6IHRlbXBsYXRlLmlkLFxuICAgICAgICAgIHBhcmVudFJlZlBhdGg6IHRvU3RyaW5nKHBhcmVudFJlZlBhdGgpLFxuICAgICAgICAgIHR5cGVcbiAgICAgICAgfSxcbiAgICAgICAgcGF5bG9hZDogdGVtcGxhdGUucGFyYW1zXG4gICAgICB9XV1cbiAgICB9KTtcbiAgfSwgW2dyb3VwSW5kZXgsIG5hdmlnYXRlLCByb3V0ZXJQYW5lR3JvdXBzXSk7XG4gIGNvbnN0IGN0eCA9IHVzZU1lbW8oKCkgPT4gKHtcbiAgICAvLyBaZXJvLWJhc2VkIGluZGV4IChwb3NpdGlvbikgb2YgcGFuZSwgdmlzdWFsbHlcbiAgICBpbmRleDogZmxhdEluZGV4LFxuICAgIC8vIFplcm8tYmFzZWQgaW5kZXggb2YgcGFuZSBncm91cCAod2l0aGluIFVSTCBzdHJ1Y3R1cmUpXG4gICAgZ3JvdXBJbmRleCxcbiAgICAvLyBaZXJvLWJhc2VkIGluZGV4IG9mIHBhbmUgd2l0aGluIHNpYmxpbmcgZ3JvdXBcbiAgICBzaWJsaW5nSW5kZXgsXG4gICAgLy8gUGF5bG9hZCBvZiB0aGUgY3VycmVudCBwYW5lXG4gICAgcGF5bG9hZCxcbiAgICAvLyBQYXJhbXMgb2YgdGhlIGN1cnJlbnQgcGFuZVxuICAgIHBhcmFtcyxcbiAgICAvLyBXaGV0aGVyIG9yIG5vdCB0aGUgcGFuZSBoYXMgYW55IHNpYmxpbmdzICh3aXRoaW4gdGhlIHNhbWUgZ3JvdXApXG4gICAgaGFzR3JvdXBTaWJsaW5nczogcm91dGVyUGFuZUdyb3Vwc1tncm91cEluZGV4XSA/IHJvdXRlclBhbmVHcm91cHNbZ3JvdXBJbmRleF0ubGVuZ3RoID4gMSA6IGZhbHNlLFxuICAgIC8vIFRoZSBsZW5ndGggb2YgdGhlIGN1cnJlbnQgZ3JvdXBcbiAgICBncm91cExlbmd0aDogcm91dGVyUGFuZUdyb3Vwc1tncm91cEluZGV4XSA/IHJvdXRlclBhbmVHcm91cHNbZ3JvdXBJbmRleF0ubGVuZ3RoIDogMCxcbiAgICAvLyBDdXJyZW50IHJvdXRlciBzdGF0ZSBmb3IgdGhlIFwicGFuZXNcIiBwcm9wZXJ0eVxuICAgIHJvdXRlclBhbmVzU3RhdGU6IHJvdXRlclBhbmVHcm91cHMsXG4gICAgLy8gQ3VycmllZCBTdGF0ZUxpbmsgdGhhdCBwYXNzZXMgdGhlIGNvcnJlY3Qgc3RhdGUgYXV0b21hdGljYWxseVxuICAgIENoaWxkTGluayxcbiAgICAvLyBDdXJyaWVkIFN0YXRlTGluayB0aGF0IHBvcHMgb2ZmIHRoZSBsYXN0IHBhbmUgZ3JvdXBcbiAgICAvLyBPbmx5IHBhc3MgaWYgdGhpcyBpcyBub3QgdGhlIGZpcnN0IHBhbmVcbiAgICBCYWNrTGluazogZmxhdEluZGV4ID8gQmFja0xpbmsgOiB2b2lkIDAsXG4gICAgLy8gQSBzcGVjaWFsaXplZCBgQ2hpbGRMaW5rYCB0aGF0IHRha2VzIGluIHRoZSBuZWVkZWQgcHJvcHMgdG8gb3BlbiBhXG4gICAgLy8gcmVmZXJlbmNlZCBkb2N1bWVudCB0byB0aGUgcmlnaHRcbiAgICBSZWZlcmVuY2VDaGlsZExpbmssXG4gICAgLy8gU2ltaWxhciB0byBgUmVmZXJlbmNlQ2hpbGRMaW5rYCBleHBlY3Qgd2l0aG91dCB0aGUgd3JhcHBpbmcgY29tcG9uZW50XG4gICAgaGFuZGxlRWRpdFJlZmVyZW5jZSxcbiAgICAvLyBDdXJyaWVkIFN0YXRlTGluayB0aGF0IHBhc3NlZCB0aGUgY29ycmVjdCBzdGF0ZSwgYnV0IG1lcmdlcyBwYXJhbXMvcGF5bG9hZFxuICAgIFBhcmFtZXRlcml6ZWRMaW5rLFxuICAgIC8vIFJlcGxhY2VzIHRoZSBjdXJyZW50IHBhbmUgd2l0aCBhIG5ldyBvbmVcbiAgICByZXBsYWNlQ3VycmVudDogZnVuY3Rpb24gKCkge1xuICAgICAgbGV0IG9wdHMgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHt9O1xuICAgICAgbW9kaWZ5Q3VycmVudEdyb3VwKCgpID0+IFt7XG4gICAgICAgIGlkOiBvcHRzLmlkIHx8IFwiXCIsXG4gICAgICAgIHBheWxvYWQ6IG9wdHMucGF5bG9hZCxcbiAgICAgICAgcGFyYW1zOiBvcHRzLnBhcmFtcyB8fCB7fVxuICAgICAgfV0pO1xuICAgIH0sXG4gICAgLy8gUmVtb3ZlcyB0aGUgY3VycmVudCBwYW5lIGZyb20gdGhlIGdyb3VwXG4gICAgY2xvc2VDdXJyZW50OiAoKSA9PiB7XG4gICAgICBtb2RpZnlDdXJyZW50R3JvdXAoKHNpYmxpbmdzLCBpdGVtKSA9PiBzaWJsaW5ncy5sZW5ndGggPiAxID8gc2libGluZ3MuZmlsdGVyKHNpYmxpbmcgPT4gc2libGluZyAhPT0gaXRlbSkgOiBzaWJsaW5ncyk7XG4gICAgfSxcbiAgICAvLyBSZW1vdmVzIGFsbCBwYW5lcyB0byB0aGUgcmlnaHQgaW5jbHVkaW5nIGN1cnJlbnRcbiAgICBjbG9zZUN1cnJlbnRBbmRBZnRlcjogZnVuY3Rpb24gKCkge1xuICAgICAgbGV0IGV4cGFuZExhc3QgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHRydWU7XG4gICAgICBpZiAoZXhwYW5kTGFzdCAmJiBsYXN0UGFuZSkge1xuICAgICAgICBleHBhbmQobGFzdFBhbmUuZWxlbWVudCk7XG4gICAgICB9XG4gICAgICBuYXZpZ2F0ZSh7XG4gICAgICAgIHBhbmVzOiBbLi4ucm91dGVyUGFuZUdyb3Vwcy5zbGljZSgwLCBncm91cEluZGV4KV1cbiAgICAgIH0sIHtcbiAgICAgICAgcmVwbGFjZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgfSxcbiAgICAvLyBEdXBsaWNhdGUgdGhlIGN1cnJlbnQgcGFuZSwgd2l0aCBvcHRpb25hbCBvdmVycmlkZXMgZm9yIHBheWxvYWQsIHBhcmFtZXRlcnNcbiAgICBkdXBsaWNhdGVDdXJyZW50OiBvcHRpb25zID0+IHtcbiAgICAgIG1vZGlmeUN1cnJlbnRHcm91cCgoc2libGluZ3MsIGl0ZW0pID0+IHtcbiAgICAgICAgY29uc3QgZHVwbGljYXRlZEl0ZW0gPSB7XG4gICAgICAgICAgLi4uaXRlbSxcbiAgICAgICAgICBwYXlsb2FkOiAob3B0aW9ucyA9PSBudWxsID8gdm9pZCAwIDogb3B0aW9ucy5wYXlsb2FkKSB8fCBpdGVtLnBheWxvYWQsXG4gICAgICAgICAgcGFyYW1zOiAob3B0aW9ucyA9PSBudWxsID8gdm9pZCAwIDogb3B0aW9ucy5wYXJhbXMpIHx8IGl0ZW0ucGFyYW1zXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBbLi4uc2libGluZ3Muc2xpY2UoMCwgc2libGluZ0luZGV4KSwgZHVwbGljYXRlZEl0ZW0sIC4uLnNpYmxpbmdzLnNsaWNlKHNpYmxpbmdJbmRleCldO1xuICAgICAgfSk7XG4gICAgfSxcbiAgICAvLyBTZXQgdGhlIHZpZXcgZm9yIHRoZSBjdXJyZW50IHBhbmVcbiAgICBzZXRWaWV3OiB2aWV3SWQgPT4ge1xuICAgICAgY29uc3QgcmVzdFBhcmFtcyA9IG9taXQocGFyYW1zLCBcInZpZXdcIik7XG4gICAgICByZXR1cm4gc2V0UGFyYW1zKHZpZXdJZCA/IHtcbiAgICAgICAgLi4ucmVzdFBhcmFtcyxcbiAgICAgICAgdmlldzogdmlld0lkXG4gICAgICB9IDogcmVzdFBhcmFtcyk7XG4gICAgfSxcbiAgICAvLyBTZXQgdGhlIHBhcmFtZXRlcnMgZm9yIHRoZSBjdXJyZW50IHBhbmVcbiAgICBzZXRQYXJhbXMsXG4gICAgLy8gU2V0IHRoZSBwYXlsb2FkIGZvciB0aGUgY3VycmVudCBwYW5lXG4gICAgc2V0UGF5bG9hZCxcbiAgICAvLyBBIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyBhIHBhdGggd2l0aCB0aGUgZ2l2ZW4gcGFyYW1ldGVyc1xuICAgIGNyZWF0ZVBhdGhXaXRoUGFyYW1zLFxuICAgIC8vIFByb3hpZWQgbmF2aWdhdGlvbiB0byBhIGdpdmVuIGludGVudC4gQ29uc2lkZXIganVzdCBleHBvc2luZyBgcm91dGVyYCBpbnN0ZWFkP1xuICAgIG5hdmlnYXRlSW50ZW50XG4gIH0pLCBbZmxhdEluZGV4LCBncm91cEluZGV4LCBzaWJsaW5nSW5kZXgsIHBheWxvYWQsIHBhcmFtcywgcm91dGVyUGFuZUdyb3VwcywgaGFuZGxlRWRpdFJlZmVyZW5jZSwgc2V0UGFyYW1zLCBzZXRQYXlsb2FkLCBjcmVhdGVQYXRoV2l0aFBhcmFtcywgbmF2aWdhdGVJbnRlbnQsIG1vZGlmeUN1cnJlbnRHcm91cCwgbGFzdFBhbmUsIG5hdmlnYXRlLCBleHBhbmRdKTtcbiAgcmV0dXJuIC8qIEBfX1BVUkVfXyAqL2pzeChQYW5lUm91dGVyQ29udGV4dC5Qcm92aWRlciwge1xuICAgIHZhbHVlOiBjdHgsXG4gICAgY2hpbGRyZW5cbiAgfSk7XG59XG5jbGFzcyBQYW5lUmVzb2x1dGlvbkVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICBjb25zdHJ1Y3RvcihfcmVmMikge1xuICAgIGxldCB7XG4gICAgICBtZXNzYWdlLFxuICAgICAgY29udGV4dCxcbiAgICAgIGhlbHBJZCxcbiAgICAgIGNhdXNlXG4gICAgfSA9IF9yZWYyO1xuICAgIHN1cGVyKG1lc3NhZ2UpO1xuICAgIHRoaXMuY29udGV4dCA9IGNvbnRleHQ7XG4gICAgdGhpcy5oZWxwSWQgPSBoZWxwSWQ7XG4gICAgdGhpcy5jYXVzZSA9IGNhdXNlO1xuICB9XG59XG5jb25zdCByYW5kb21JZENhY2hlID0gLyogQF9fUFVSRV9fICovbmV3IFdlYWtNYXAoKTtcbmZ1bmN0aW9uIGFzc2lnbklkKG9iaikge1xuICBjb25zdCBjYWNoZWRWYWx1ZSA9IHJhbmRvbUlkQ2FjaGUuZ2V0KG9iaik7XG4gIGlmIChjYWNoZWRWYWx1ZSkgcmV0dXJuIGNhY2hlZFZhbHVlO1xuICBjb25zdCBpZCA9IG5hbm9pZCgpO1xuICByYW5kb21JZENhY2hlLnNldChvYmosIGlkKTtcbiAgcmV0dXJuIGlkO1xufVxuY29uc3QgaXNQcm9taXNlID0gdGhpbmcgPT4ge1xuICByZXR1cm4gISF0aGluZyAmJiB0eXBlb2YgKHRoaW5nID09IG51bGwgPyB2b2lkIDAgOiB0aGluZy50aGVuKSA9PT0gXCJmdW5jdGlvblwiO1xufTtcbmNvbnN0IGlzU2VyaWFsaXphYmxlID0gdGhpbmcgPT4ge1xuICBpZiAoIWlzUmVjb3JkKHRoaW5nKSkgcmV0dXJuIGZhbHNlO1xuICByZXR1cm4gdHlwZW9mIHRoaW5nLnNlcmlhbGl6ZSA9PT0gXCJmdW5jdGlvblwiO1xufTtcbmNvbnN0IHJldGhyb3dXaXRoUGFuZVJlc29sdXRpb25FcnJvcnMgPSBuZXh0ID0+ICh1bnJlc29sdmVkUGFuZSwgY29udGV4dCwgZmxhdEluZGV4KSA9PiB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIG5leHQodW5yZXNvbHZlZFBhbmUsIGNvbnRleHQsIGZsYXRJbmRleCk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBpZiAoZSBpbnN0YW5jZW9mIFBhbmVSZXNvbHV0aW9uRXJyb3IpIHtcbiAgICAgIHRocm93IGU7XG4gICAgfVxuICAgIHRocm93IG5ldyBQYW5lUmVzb2x1dGlvbkVycm9yKHtcbiAgICAgIG1lc3NhZ2U6IHR5cGVvZiAoZSA9PSBudWxsID8gdm9pZCAwIDogZS5tZXNzYWdlKSA9PT0gXCJzdHJpbmdcIiA/IGUubWVzc2FnZSA6IFwiXCIsXG4gICAgICBjb250ZXh0LFxuICAgICAgY2F1c2U6IGVcbiAgICB9KTtcbiAgfVxufTtcbmNvbnN0IHdyYXBXaXRoUHVibGlzaFJlcGxheSA9IG5leHQgPT4gZnVuY3Rpb24gKCkge1xuICByZXR1cm4gbmV4dCguLi5hcmd1bWVudHMpLnBpcGUoXG4gIC8vIG5lZWQgdG8gYWRkIHB1Ymxpc2hSZXBsYXkgKyByZWZDb3VudCB0byBlbnN1cmUgbmV3IHN1YnNjcmliZXJzIGFsd2F5c1xuICAvLyBnZXQgYW4gZW1pc3Npb24uIHdpdGhvdXQgdGhpcywgbWVtb2l6ZWQgb2JzZXJ2YWJsZXMgbWF5IGdldCBzdHVja1xuICAvLyB3YWl0aW5nIGZvciB0aGVpciBmaXJzdCBlbWlzc2lvbnMgcmVzdWx0aW5nIGluIGEgbG9hZGluZyBwYW5lXG4gIHB1Ymxpc2hSZXBsYXkoMSksIHJlZkNvdW50KCkpO1xufTtcbmZ1bmN0aW9uIGNyZWF0ZVBhbmVSZXNvbHZlcihtaWRkbGV3YXJlKSB7XG4gIGNvbnN0IHJlc29sdmVQYW5lID0gcmV0aHJvd1dpdGhQYW5lUmVzb2x1dGlvbkVycm9ycyh3cmFwV2l0aFB1Ymxpc2hSZXBsYXkobWlkZGxld2FyZSgodW5yZXNvbHZlZFBhbmUsIGNvbnRleHQsIGZsYXRJbmRleCkgPT4ge1xuICAgIGlmICghdW5yZXNvbHZlZFBhbmUpIHtcbiAgICAgIHRocm93IG5ldyBQYW5lUmVzb2x1dGlvbkVycm9yKHtcbiAgICAgICAgbWVzc2FnZTogXCJQYW5lIHJldHVybmVkIG5vIGNoaWxkXCIsXG4gICAgICAgIGNvbnRleHQsXG4gICAgICAgIGhlbHBJZDogXCJzdHJ1Y3R1cmUtaXRlbS1yZXR1cm5lZC1uby1jaGlsZFwiXG4gICAgICB9KTtcbiAgICB9XG4gICAgaWYgKGlzUHJvbWlzZSh1bnJlc29sdmVkUGFuZSkgfHwgaXNPYnNlcnZhYmxlKHVucmVzb2x2ZWRQYW5lKSkge1xuICAgICAgcmV0dXJuIGZyb20odW5yZXNvbHZlZFBhbmUpLnBpcGUoc3dpdGNoTWFwKHJlc3VsdCA9PiByZXNvbHZlUGFuZShyZXN1bHQsIGNvbnRleHQsIGZsYXRJbmRleCkpKTtcbiAgICB9XG4gICAgaWYgKGlzU2VyaWFsaXphYmxlKHVucmVzb2x2ZWRQYW5lKSkge1xuICAgICAgcmV0dXJuIHJlc29sdmVQYW5lKHVucmVzb2x2ZWRQYW5lLnNlcmlhbGl6ZShjb250ZXh0KSwgY29udGV4dCwgZmxhdEluZGV4KTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiB1bnJlc29sdmVkUGFuZSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICByZXR1cm4gcmVzb2x2ZVBhbmUodW5yZXNvbHZlZFBhbmUoY29udGV4dC5pZCwgY29udGV4dCksIGNvbnRleHQsIGZsYXRJbmRleCk7XG4gICAgfVxuICAgIHJldHVybiBvZih1bnJlc29sdmVkUGFuZSk7XG4gIH0pKSk7XG4gIHJldHVybiByZXNvbHZlUGFuZTtcbn1cbmNvbnN0IGJpbmRDYWNoZSA9IC8qIEBfX1BVUkVfXyAqL25ldyBXZWFrTWFwKCk7XG5mdW5jdGlvbiBtZW1vQmluZChvYmosIG1ldGhvZEtleSkge1xuICBjb25zdCBib3VuZE1ldGhvZHMgPSBiaW5kQ2FjaGUuZ2V0KG9iaikgfHwgLyogQF9fUFVSRV9fICovbmV3IE1hcCgpO1xuICBpZiAoYm91bmRNZXRob2RzKSB7XG4gICAgY29uc3QgYm91bmQyID0gYm91bmRNZXRob2RzLmdldChtZXRob2RLZXkpO1xuICAgIGlmIChib3VuZDIpIHJldHVybiBib3VuZDI7XG4gIH1cbiAgY29uc3QgbWV0aG9kID0gb2JqW21ldGhvZEtleV07XG4gIGlmICh0eXBlb2YgbWV0aG9kICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJFeHBlY3RlZCBwcm9wZXJ0eSBgXCIuY29uY2F0KG1ldGhvZEtleSwgXCJgIHRvIGJlIGEgZnVuY3Rpb24gYnV0IGdvdCBcIikuY29uY2F0KHR5cGVvZiBtZXRob2QsIFwiIGluc3RlYWQuXCIpKTtcbiAgfVxuICBjb25zdCBib3VuZCA9IG1ldGhvZC5iaW5kKG9iaik7XG4gIGJvdW5kTWV0aG9kcy5zZXQobWV0aG9kS2V5LCBib3VuZCk7XG4gIGJpbmRDYWNoZS5zZXQob2JqLCBib3VuZE1ldGhvZHMpO1xuICByZXR1cm4gYm91bmQ7XG59XG5hc3luYyBmdW5jdGlvbiByZXNvbHZlSW50ZW50KG9wdGlvbnMpIHtcbiAgY29uc3QgcmVzb2x2ZWRQYW5lQ2FjaGUgPSAvKiBAX19QVVJFX18gKi9uZXcgTWFwKCk7XG4gIGNvbnN0IG1lbW9pemUgPSBuZXh0Rm4gPT4gKHVucmVzb2x2ZWRQYW5lLCBjb250ZXh0LCBmbGF0SW5kZXgpID0+IHtcbiAgICBjb25zdCBrZXkgPSB1bnJlc29sdmVkUGFuZSAmJiBcIlwiLmNvbmNhdChhc3NpZ25JZCh1bnJlc29sdmVkUGFuZSksIFwiLVwiKS5jb25jYXQoY29udGV4dC5wYXRoLmpvaW4oXCJfX1wiKSk7XG4gICAgY29uc3QgY2FjaGVkUmVzb2x2ZWRQYW5lID0ga2V5ICYmIHJlc29sdmVkUGFuZUNhY2hlLmdldChrZXkpO1xuICAgIGlmIChjYWNoZWRSZXNvbHZlZFBhbmUpIHJldHVybiBjYWNoZWRSZXNvbHZlZFBhbmU7XG4gICAgY29uc3QgcmVzdWx0ID0gbmV4dEZuKHVucmVzb2x2ZWRQYW5lLCBjb250ZXh0LCBmbGF0SW5kZXgpO1xuICAgIGlmIChrZXkpIHJlc29sdmVkUGFuZUNhY2hlLnNldChrZXksIHJlc3VsdCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcbiAgY29uc3QgcmVzb2x2ZVBhbmUgPSBjcmVhdGVQYW5lUmVzb2x2ZXIobWVtb2l6ZSk7XG4gIGNvbnN0IGZhbGxiYWNrRWRpdG9yUGFuZXMgPSBbW3tcbiAgICBpZDogXCJfX2VkaXRfX1wiLmNvbmNhdChvcHRpb25zLnBhcmFtcy5pZCksXG4gICAgcGFyYW1zOiB7XG4gICAgICAuLi5vbWl0KG9wdGlvbnMucGFyYW1zLCBbXCJpZFwiXSksXG4gICAgICB0eXBlOiBvcHRpb25zLnBhcmFtcy50eXBlXG4gICAgfSxcbiAgICBwYXlsb2FkOiBvcHRpb25zLnBheWxvYWRcbiAgfV1dO1xuICBhc3luYyBmdW5jdGlvbiB0cmF2ZXJzZShfcmVmMykge1xuICAgIGxldCB7XG4gICAgICBjdXJyZW50SWQsXG4gICAgICBmbGF0SW5kZXgsXG4gICAgICBpbnRlbnQsXG4gICAgICBwYXJhbXMsXG4gICAgICBwYXJlbnQsXG4gICAgICBwYXRoLFxuICAgICAgcGF5bG9hZCxcbiAgICAgIHVucmVzb2x2ZWRQYW5lLFxuICAgICAgbGV2ZWxJbmRleCxcbiAgICAgIHN0cnVjdHVyZUNvbnRleHRcbiAgICB9ID0gX3JlZjM7XG4gICAgdmFyIF9hO1xuICAgIGlmICghdW5yZXNvbHZlZFBhbmUpIHJldHVybiBbXTtcbiAgICBjb25zdCB7XG4gICAgICBpZDogdGFyZ2V0SWQsXG4gICAgICB0eXBlOiBzY2hlbWFUeXBlTmFtZSxcbiAgICAgIC4uLm90aGVyUGFyYW1zXG4gICAgfSA9IHBhcmFtcztcbiAgICBjb25zdCBjb250ZXh0ID0ge1xuICAgICAgaWQ6IGN1cnJlbnRJZCxcbiAgICAgIHNwbGl0SW5kZXg6IDAsXG4gICAgICBwYXJlbnQsXG4gICAgICBwYXRoLFxuICAgICAgaW5kZXg6IGZsYXRJbmRleCxcbiAgICAgIHBhcmFtczoge30sXG4gICAgICBwYXlsb2FkOiB2b2lkIDAsXG4gICAgICBzdHJ1Y3R1cmVDb250ZXh0XG4gICAgfTtcbiAgICBjb25zdCByZXNvbHZlZFBhbmUgPSBhd2FpdCBmaXJzdFZhbHVlRnJvbShyZXNvbHZlUGFuZSh1bnJlc29sdmVkUGFuZSwgY29udGV4dCwgZmxhdEluZGV4KSk7XG4gICAgaWYgKHJlc29sdmVkUGFuZS50eXBlID09PSBcImRvY3VtZW50XCIgJiYgcmVzb2x2ZWRQYW5lLmlkID09PSB0YXJnZXRJZCkge1xuICAgICAgcmV0dXJuIFt7XG4gICAgICAgIHBhbmVzOiBbLi4ucGF0aC5zbGljZSgwLCBwYXRoLmxlbmd0aCAtIDEpLm1hcChpID0+IFt7XG4gICAgICAgICAgaWQ6IGlcbiAgICAgICAgfV0pLCBbe1xuICAgICAgICAgIGlkOiB0YXJnZXRJZCxcbiAgICAgICAgICBwYXJhbXM6IG90aGVyUGFyYW1zLFxuICAgICAgICAgIHBheWxvYWRcbiAgICAgICAgfV1dLFxuICAgICAgICBkZXB0aEluZGV4OiBwYXRoLmxlbmd0aCxcbiAgICAgICAgbGV2ZWxJbmRleFxuICAgICAgfV07XG4gICAgfVxuICAgIGlmIChcbiAgICAvLyBpZiB0aGUgcmVzb2x2ZSBwYW5lJ3MgYGNhbkhhbmRsZUludGVudGAgcmV0dXJucyB0cnVlLCB0aGVuIHJlc29sdmVcbiAgICAoKF9hID0gcmVzb2x2ZWRQYW5lLmNhbkhhbmRsZUludGVudCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLmNhbGwocmVzb2x2ZWRQYW5lLCBpbnRlbnQsIHBhcmFtcywge1xuICAgICAgcGFuZTogcmVzb2x2ZWRQYW5lLFxuICAgICAgaW5kZXg6IGZsYXRJbmRleFxuICAgIH0pKSB8fFxuICAgIC8vIGlmIHRoZSBwYW5lJ3MgYGNhbkhhbmRsZUludGVudGAgZGlkIG5vdCByZXR1cm4gdHJ1ZSwgdGhlbiBtYXRjaCBhZ2FpbnN0XG4gICAgLy8gdGhpcyBkZWZhdWx0IGNhc2UuIHdlIHdpbGwgcmVzb2x2ZSB0aGUgaW50ZW50IGlmOlxuICAgIHJlc29sdmVkUGFuZS50eXBlID09PSBcImRvY3VtZW50TGlzdFwiICYmXG4gICAgLy8gMS4gdGhlIHNjaGVtYSB0eXBlIG1hdGNoZXMgKHRoaXMgcmVxdWlyZWQgZm9yIHRoZSBkb2N1bWVudCB0byByZW5kZXIpXG4gICAgcmVzb2x2ZWRQYW5lLnNjaGVtYVR5cGVOYW1lID09PSBzY2hlbWFUeXBlTmFtZSAmJlxuICAgIC8vIDIuIHRoZSBmaWx0ZXIgaXMgdGhlIGRlZmF1bHQgZmlsdGVyLlxuICAgIC8vXG4gICAgLy8gTk9URTogdGhpcyBjYXNlIGlzIHRvIHByZXZlbnQgZmFsc2UgcG9zaXRpdmUgbWF0Y2hlcyB3aGVyZSB0aGUgdXNlclxuICAgIC8vIGhhcyBjb25maWd1cmVkIGEgbW9yZSBzcGVjaWZpYyBmaWx0ZXIgZm9yIGEgcGFydGljdWxhciB0eXBlLiBJbiB0aGF0XG4gICAgLy8gY2FzZSwgdGhlIHVzZXIgY2FuIGltcGxlbWVudCB0aGVpciBvd24gYGNhbkhhbmRsZUludGVudGAgZnVuY3Rpb25cbiAgICByZXNvbHZlZFBhbmUub3B0aW9ucy5maWx0ZXIgPT09IFwiX3R5cGUgPT0gJHR5cGVcIikge1xuICAgICAgcmV0dXJuIFt7XG4gICAgICAgIHBhbmVzOiBbXG4gICAgICAgIC8vIG1hcCB0aGUgY3VycmVudCBwYXRoIHRvIHJvdXRlciBwYW5lc1xuICAgICAgICAuLi5wYXRoLm1hcChpZCA9PiBbe1xuICAgICAgICAgIGlkXG4gICAgICAgIH1dKSxcbiAgICAgICAgLy8gdGhlbiBhdWdtZW50IHdpdGggdGhlIGludGVudHMgSURzIGFuZCBwYXJhbXNcbiAgICAgICAgW3tcbiAgICAgICAgICBpZDogcGFyYW1zLmlkLFxuICAgICAgICAgIHBhcmFtczogb3RoZXJQYXJhbXMsXG4gICAgICAgICAgcGF5bG9hZFxuICAgICAgICB9XV0sXG4gICAgICAgIGRlcHRoSW5kZXg6IHBhdGgubGVuZ3RoLFxuICAgICAgICBsZXZlbEluZGV4XG4gICAgICB9XTtcbiAgICB9XG4gICAgaWYgKHJlc29sdmVkUGFuZS50eXBlID09PSBcImxpc3RcIiAmJiByZXNvbHZlZFBhbmUuY2hpbGQgJiYgcmVzb2x2ZWRQYW5lLml0ZW1zKSB7XG4gICAgICByZXR1cm4gKGF3YWl0IFByb21pc2UuYWxsKHJlc29sdmVkUGFuZS5pdGVtcy5tYXAoKGl0ZW0sIG5leHRMZXZlbEluZGV4KSA9PiB7XG4gICAgICAgIGlmIChpdGVtLnR5cGUgPT09IFwiZGl2aWRlclwiKSByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKFtdKTtcbiAgICAgICAgcmV0dXJuIHRyYXZlcnNlKHtcbiAgICAgICAgICBjdXJyZW50SWQ6IGl0ZW0uX2lkIHx8IGl0ZW0uaWQsXG4gICAgICAgICAgZmxhdEluZGV4OiBmbGF0SW5kZXggKyAxLFxuICAgICAgICAgIGludGVudCxcbiAgICAgICAgICBwYXJhbXMsXG4gICAgICAgICAgcGFyZW50OiByZXNvbHZlZFBhbmUsXG4gICAgICAgICAgcGF0aDogWy4uLnBhdGgsIGl0ZW0uaWRdLFxuICAgICAgICAgIHBheWxvYWQsXG4gICAgICAgICAgdW5yZXNvbHZlZFBhbmU6IHR5cGVvZiByZXNvbHZlZFBhbmUuY2hpbGQgPT09IFwiZnVuY3Rpb25cIiA/IG1lbW9CaW5kKHJlc29sdmVkUGFuZSwgXCJjaGlsZFwiKSA6IHJlc29sdmVkUGFuZS5jaGlsZCxcbiAgICAgICAgICBsZXZlbEluZGV4OiBuZXh0TGV2ZWxJbmRleCxcbiAgICAgICAgICBzdHJ1Y3R1cmVDb250ZXh0XG4gICAgICAgIH0pO1xuICAgICAgfSkpKS5mbGF0KCk7XG4gICAgfVxuICAgIHJldHVybiBbXTtcbiAgfVxuICBjb25zdCBtYXRjaGluZ1BhbmVzID0gYXdhaXQgdHJhdmVyc2Uoe1xuICAgIGN1cnJlbnRJZDogXCJyb290XCIsXG4gICAgZmxhdEluZGV4OiAwLFxuICAgIGxldmVsSW5kZXg6IDAsXG4gICAgaW50ZW50OiBvcHRpb25zLmludGVudCxcbiAgICBwYXJhbXM6IG9wdGlvbnMucGFyYW1zLFxuICAgIHBhcmVudDogbnVsbCxcbiAgICBwYXRoOiBbXSxcbiAgICBwYXlsb2FkOiBvcHRpb25zLnBheWxvYWQsXG4gICAgdW5yZXNvbHZlZFBhbmU6IG9wdGlvbnMucm9vdFBhbmVOb2RlLFxuICAgIHN0cnVjdHVyZUNvbnRleHQ6IG9wdGlvbnMuc3RydWN0dXJlQ29udGV4dFxuICB9KTtcbiAgY29uc3QgY2xvc2VzdFBhbmVUb1Jvb3QgPSBtYXRjaGluZ1BhbmVzLnNvcnQoKGEsIGIpID0+IHtcbiAgICBpZiAoYS5kZXB0aEluZGV4ID09PSBiLmRlcHRoSW5kZXgpIHJldHVybiBhLmxldmVsSW5kZXggLSBiLmxldmVsSW5kZXg7XG4gICAgcmV0dXJuIGEuZGVwdGhJbmRleCAtIGIuZGVwdGhJbmRleDtcbiAgfSlbMF07XG4gIGlmIChjbG9zZXN0UGFuZVRvUm9vdCkge1xuICAgIHJldHVybiBjbG9zZXN0UGFuZVRvUm9vdC5wYW5lcztcbiAgfVxuICByZXR1cm4gZmFsbGJhY2tFZGl0b3JQYW5lcztcbn1cbmNvbnN0IGZhbGxiYWNrRWRpdG9yQ2hpbGQgPSAobm9kZUlkLCBjb250ZXh0KSA9PiB7XG4gIGNvbnN0IGlkID0gbm9kZUlkLnJlcGxhY2UoL15fX2VkaXRfXy8sIFwiXCIpO1xuICBjb25zdCB7XG4gICAgcGFyYW1zLFxuICAgIHBheWxvYWQsXG4gICAgc3RydWN0dXJlQ29udGV4dDoge1xuICAgICAgcmVzb2x2ZURvY3VtZW50Tm9kZVxuICAgIH1cbiAgfSA9IGNvbnRleHQ7XG4gIGNvbnN0IHtcbiAgICB0eXBlLFxuICAgIHRlbXBsYXRlXG4gIH0gPSBwYXJhbXM7XG4gIGlmICghdHlwZSkge1xuICAgIHRocm93IG5ldyBFcnJvcihcIkRvY3VtZW50IHR5cGUgZm9yIGRvY3VtZW50IHdpdGggSUQgXCIuY29uY2F0KGlkLCBcIiB3YXMgbm90IHByb3ZpZGVkIGluIHRoZSByb3V0ZXIgcGFyYW1zLlwiKSk7XG4gIH1cbiAgbGV0IGRlZmF1bHREb2N1bWVudEJ1aWxkZXIgPSByZXNvbHZlRG9jdW1lbnROb2RlKHtcbiAgICBzY2hlbWFUeXBlOiB0eXBlLFxuICAgIGRvY3VtZW50SWQ6IGlkXG4gIH0pLmlkKFwiZWRpdG9yXCIpO1xuICBpZiAodGVtcGxhdGUpIHtcbiAgICBkZWZhdWx0RG9jdW1lbnRCdWlsZGVyID0gZGVmYXVsdERvY3VtZW50QnVpbGRlci5pbml0aWFsVmFsdWVUZW1wbGF0ZSh0ZW1wbGF0ZSwgcGF5bG9hZCk7XG4gIH1cbiAgcmV0dXJuIGRlZmF1bHREb2N1bWVudEJ1aWxkZXIuc2VyaWFsaXplKCk7XG59O1xuZnVuY3Rpb24gaGFzaENvbnRleHQoY29udGV4dCkge1xuICB2YXIgX2EsIF9iO1xuICByZXR1cm4gXCJjb250ZXh0SGFzaChcIi5jb25jYXQoSlNPTi5zdHJpbmdpZnkoe1xuICAgIGlkOiBjb250ZXh0LmlkLFxuICAgIHBhcmVudElkOiBwYXJlbnQgJiYgYXNzaWduSWQocGFyZW50KSxcbiAgICBwYXRoOiBjb250ZXh0LnBhdGgsXG4gICAgaW5kZXg6IGNvbnRleHQuaW5kZXgsXG4gICAgc3BsaXRJbmRleDogY29udGV4dC5zcGxpdEluZGV4LFxuICAgIHNlcmlhbGl6ZU9wdGlvbnNJbmRleDogKF9hID0gY29udGV4dC5zZXJpYWxpemVPcHRpb25zKSA9PSBudWxsID8gdm9pZCAwIDogX2EuaW5kZXgsXG4gICAgc2VyaWFsaXplT3B0aW9uc1BhdGg6IChfYiA9IGNvbnRleHQuc2VyaWFsaXplT3B0aW9ucykgPT0gbnVsbCA/IHZvaWQgMCA6IF9iLnBhdGhcbiAgfSksIFwiKVwiKTtcbn1cbmNvbnN0IGhhc2hSZXNvbHZlZFBhbmVNZXRhID0gbWV0YSA9PiB7XG4gIGNvbnN0IG5vcm1hbGl6ZWQgPSB7XG4gICAgdHlwZTogbWV0YS50eXBlLFxuICAgIGlkOiBtZXRhLnJvdXRlclBhbmVTaWJsaW5nLmlkLFxuICAgIHBhcmFtczogbWV0YS5yb3V0ZXJQYW5lU2libGluZy5wYXJhbXMgfHwge30sXG4gICAgcGF5bG9hZDogbWV0YS5yb3V0ZXJQYW5lU2libGluZy5wYXlsb2FkIHx8IG51bGwsXG4gICAgZmxhdEluZGV4OiBtZXRhLmZsYXRJbmRleCxcbiAgICBncm91cEluZGV4OiBtZXRhLmdyb3VwSW5kZXgsXG4gICAgc2libGluZ0luZGV4OiBtZXRhLnNpYmxpbmdJbmRleCxcbiAgICBwYXRoOiBtZXRhLnBhdGgsXG4gICAgcGFuZU5vZGU6IG1ldGEudHlwZSA9PT0gXCJyZXNvbHZlZE1ldGFcIiA/IGFzc2lnbklkKG1ldGEucGFuZU5vZGUpIDogbnVsbFxuICB9O1xuICByZXR1cm4gXCJtZXRhSGFzaChcIi5jb25jYXQoSlNPTi5zdHJpbmdpZnkobm9ybWFsaXplZCksIFwiKVwiKTtcbn07XG5mdW5jdGlvbiByZXNvbHZlUGFuZVRyZWUoX3JlZjQpIHtcbiAgbGV0IHtcbiAgICB1bnJlc29sdmVkUGFuZSxcbiAgICBmbGF0dGVuZWRSb3V0ZXJQYW5lcyxcbiAgICBwYXJlbnQ6IHBhcmVudDIsXG4gICAgcGF0aCxcbiAgICByZXNvbHZlUGFuZSxcbiAgICBzdHJ1Y3R1cmVDb250ZXh0XG4gIH0gPSBfcmVmNDtcbiAgY29uc3QgW2N1cnJlbnQsIC4uLnJlc3RdID0gZmxhdHRlbmVkUm91dGVyUGFuZXM7XG4gIGNvbnN0IG5leHQgPSByZXN0WzBdO1xuICBjb25zdCBjb250ZXh0ID0ge1xuICAgIGlkOiBjdXJyZW50LnJvdXRlclBhbmVTaWJsaW5nLmlkLFxuICAgIHNwbGl0SW5kZXg6IGN1cnJlbnQuc2libGluZ0luZGV4LFxuICAgIHBhcmVudDogcGFyZW50MixcbiAgICBwYXRoOiBbLi4ucGF0aCwgY3VycmVudC5yb3V0ZXJQYW5lU2libGluZy5pZF0sXG4gICAgaW5kZXg6IGN1cnJlbnQuZmxhdEluZGV4LFxuICAgIHBhcmFtczogY3VycmVudC5yb3V0ZXJQYW5lU2libGluZy5wYXJhbXMgfHwge30sXG4gICAgcGF5bG9hZDogY3VycmVudC5yb3V0ZXJQYW5lU2libGluZy5wYXlsb2FkLFxuICAgIHN0cnVjdHVyZUNvbnRleHRcbiAgfTtcbiAgdHJ5IHtcbiAgICByZXR1cm4gcmVzb2x2ZVBhbmUodW5yZXNvbHZlZFBhbmUsIGNvbnRleHQsIGN1cnJlbnQuZmxhdEluZGV4KS5waXBlKFxuICAgIC8vIHRoaXMgc3dpdGNoIG1hcCByZWNlaXZlcyBhIHJlc29sdmVkIHBhbmVcbiAgICBzd2l0Y2hNYXAocGFuZU5vZGUgPT4ge1xuICAgICAgY29uc3QgcmVzb2x2ZWRQYW5lTWV0YSA9IHtcbiAgICAgICAgdHlwZTogXCJyZXNvbHZlZE1ldGFcIixcbiAgICAgICAgLi4uY3VycmVudCxcbiAgICAgICAgcGFuZU5vZGUsXG4gICAgICAgIHBhdGg6IGNvbnRleHQucGF0aFxuICAgICAgfTtcbiAgICAgIGNvbnN0IGxvYWRpbmdQYW5lcyA9IHJlc3QubWFwKChpLCByZXN0SW5kZXgpID0+IHtcbiAgICAgICAgY29uc3QgbG9hZGluZ1BhbmVQYXRoID0gWy4uLmNvbnRleHQucGF0aCwgLi4ucmVzdC5zbGljZShyZXN0SW5kZXgpLm1hcCgoXywgY3VycmVudEluZGV4KSA9PiBcIltcIi5jb25jYXQoaS5mbGF0SW5kZXggKyBjdXJyZW50SW5kZXgsIFwiXVwiKSldO1xuICAgICAgICBjb25zdCBsb2FkaW5nUGFuZSA9IHtcbiAgICAgICAgICB0eXBlOiBcImxvYWRpbmdcIixcbiAgICAgICAgICBwYXRoOiBsb2FkaW5nUGFuZVBhdGgsXG4gICAgICAgICAgcGFuZU5vZGU6IG51bGwsXG4gICAgICAgICAgLi4uaVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gbG9hZGluZ1BhbmU7XG4gICAgICB9KTtcbiAgICAgIGlmICghcmVzdC5sZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIG9mKFtyZXNvbHZlZFBhbmVNZXRhXSk7XG4gICAgICB9XG4gICAgICBsZXQgbmV4dFN0cmVhbTtcbiAgICAgIGlmIChcbiAgICAgIC8vIHRoZSBmYWxsYmFjayBlZGl0b3IgY2FzZVxuICAgICAgbmV4dCA9PSBudWxsID8gdm9pZCAwIDogbmV4dC5yb3V0ZXJQYW5lU2libGluZy5pZC5zdGFydHNXaXRoKFwiX19lZGl0X19cIikpIHtcbiAgICAgICAgbmV4dFN0cmVhbSA9IHJlc29sdmVQYW5lVHJlZSh7XG4gICAgICAgICAgdW5yZXNvbHZlZFBhbmU6IGZhbGxiYWNrRWRpdG9yQ2hpbGQsXG4gICAgICAgICAgZmxhdHRlbmVkUm91dGVyUGFuZXM6IHJlc3QsXG4gICAgICAgICAgcGFyZW50OiBwYXJlbnQyLFxuICAgICAgICAgIHBhdGg6IGNvbnRleHQucGF0aCxcbiAgICAgICAgICByZXNvbHZlUGFuZSxcbiAgICAgICAgICBzdHJ1Y3R1cmVDb250ZXh0XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIGlmIChjdXJyZW50Lmdyb3VwSW5kZXggPT09IChuZXh0ID09IG51bGwgPyB2b2lkIDAgOiBuZXh0Lmdyb3VwSW5kZXgpKSB7XG4gICAgICAgIG5leHRTdHJlYW0gPSByZXNvbHZlUGFuZVRyZWUoe1xuICAgICAgICAgIHVucmVzb2x2ZWRQYW5lLFxuICAgICAgICAgIGZsYXR0ZW5lZFJvdXRlclBhbmVzOiByZXN0LFxuICAgICAgICAgIHBhcmVudDogcGFyZW50MixcbiAgICAgICAgICBwYXRoLFxuICAgICAgICAgIHJlc29sdmVQYW5lLFxuICAgICAgICAgIHN0cnVjdHVyZUNvbnRleHRcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBuZXh0U3RyZWFtID0gcmVzb2x2ZVBhbmVUcmVlKHtcbiAgICAgICAgICB1bnJlc29sdmVkUGFuZTogdHlwZW9mIHBhbmVOb2RlLmNoaWxkID09PSBcImZ1bmN0aW9uXCIgPyBtZW1vQmluZChwYW5lTm9kZSwgXCJjaGlsZFwiKSA6IHBhbmVOb2RlLmNoaWxkLFxuICAgICAgICAgIGZsYXR0ZW5lZFJvdXRlclBhbmVzOiByZXN0LFxuICAgICAgICAgIHBhcmVudDogcGFuZU5vZGUsXG4gICAgICAgICAgcGF0aDogY29udGV4dC5wYXRoLFxuICAgICAgICAgIHJlc29sdmVQYW5lLFxuICAgICAgICAgIHN0cnVjdHVyZUNvbnRleHRcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gY29uY2F0KFxuICAgICAgLy8gd2UgZW1pdCB0aGUgbG9hZGluZyBwYW5lcyBmaXJzdCBpbiBhIGNvbmNhdCAodGhpcyBlbWl0cyBpbW1lZGlhdGVseSlcbiAgICAgIG9mKFtyZXNvbHZlZFBhbmVNZXRhLCAuLi5sb2FkaW5nUGFuZXNdKSxcbiAgICAgIC8vIHRoZW4gd2hlbmV2ZXIgdGhlIG5leHQgc3RyZWFtIGlzIGRvbmUsIHRoZSByZXN1bHRzIHdpbGwgYmUgY29tYmluZWQuXG4gICAgICBuZXh0U3RyZWFtLnBpcGUobWFwKG5leHRSZXNvbHZlZFBhbmVzID0+IFtyZXNvbHZlZFBhbmVNZXRhLCAuLi5uZXh0UmVzb2x2ZWRQYW5lc10pKSk7XG4gICAgfSkpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgaWYgKGUgaW5zdGFuY2VvZiBQYW5lUmVzb2x1dGlvbkVycm9yKSB7XG4gICAgICBpZiAoZS5jb250ZXh0KSB7XG4gICAgICAgIGNvbnNvbGUud2FybihcIlBhbmUgcmVzb2x1dGlvbiBlcnJvciBhdCBpbmRleCBcIi5jb25jYXQoZS5jb250ZXh0LmluZGV4KS5jb25jYXQoZS5jb250ZXh0LnNwbGl0SW5kZXggPiAwID8gXCIgZm9yIHNwbGl0IHBhbmUgaW5kZXggXCIuY29uY2F0KGUuY29udGV4dC5zcGxpdEluZGV4KSA6IFwiXCIsIFwiOiBcIikuY29uY2F0KGUubWVzc2FnZSkuY29uY2F0KGUuaGVscElkID8gXCIgLSBzZWUgXCIuY29uY2F0KGdlbmVyYXRlSGVscFVybChlLmhlbHBJZCkpIDogXCJcIiksIGUpO1xuICAgICAgfVxuICAgICAgaWYgKGUuaGVscElkID09PSBcInN0cnVjdHVyZS1pdGVtLXJldHVybmVkLW5vLWNoaWxkXCIpIHtcbiAgICAgICAgcmV0dXJuIG9mKFtdKTtcbiAgICAgIH1cbiAgICB9XG4gICAgdGhyb3cgZTtcbiAgfVxufVxuZnVuY3Rpb24gY3JlYXRlUmVzb2x2ZWRQYW5lTm9kZVN0cmVhbShfcmVmNSkge1xuICBsZXQge1xuICAgIHJvdXRlclBhbmVzU3RyZWFtLFxuICAgIHJvb3RQYW5lTm9kZSxcbiAgICBpbml0aWFsQ2FjaGVTdGF0ZSA9IHtcbiAgICAgIGNhY2hlS2V5c0J5RmxhdEluZGV4OiBbXSxcbiAgICAgIGZsYXR0ZW5lZFJvdXRlclBhbmVzOiBbXSxcbiAgICAgIHJlc29sdmVkUGFuZUNhY2hlOiAvKiBAX19QVVJFX18gKi9uZXcgTWFwKCksXG4gICAgICByZXNvbHZlUGFuZTogKCkgPT4gTkVWRVJcbiAgICB9LFxuICAgIHN0cnVjdHVyZUNvbnRleHRcbiAgfSA9IF9yZWY1O1xuICBjb25zdCByZXNvbHZlZFBhbmVzJCA9IHJvdXRlclBhbmVzU3RyZWFtLnBpcGUoXG4gIC8vIGFkZCBpbiBpbXBsaWNpdCBcInJvb3RcIiByb3V0ZXIgcGFuZVxuICBtYXAocmF3Um91dGVyUGFuZXMgPT4gW1t7XG4gICAgaWQ6IFwicm9vdFwiXG4gIH1dLCAuLi5yYXdSb3V0ZXJQYW5lc10pLFxuICAvLyBjcmVhdGUgZmxhdHRlbmVkIHJvdXRlciBwYW5lc1xuICBtYXAocm91dGVyUGFuZXMgPT4ge1xuICAgIGNvbnN0IGZsYXR0ZW5lZFJvdXRlclBhbmVzID0gcm91dGVyUGFuZXMuZmxhdE1hcCgocm91dGVyUGFuZUdyb3VwLCBncm91cEluZGV4KSA9PiByb3V0ZXJQYW5lR3JvdXAubWFwKChyb3V0ZXJQYW5lU2libGluZywgc2libGluZ0luZGV4KSA9PiAoe1xuICAgICAgcm91dGVyUGFuZVNpYmxpbmcsXG4gICAgICBncm91cEluZGV4LFxuICAgICAgc2libGluZ0luZGV4XG4gICAgfSkpKS5tYXAoKGksIGluZGV4KSA9PiAoe1xuICAgICAgLi4uaSxcbiAgICAgIGZsYXRJbmRleDogaW5kZXhcbiAgICB9KSk7XG4gICAgcmV0dXJuIGZsYXR0ZW5lZFJvdXRlclBhbmVzO1xuICB9KSxcbiAgLy8gY2FsY3VsYXRlIGEgXCJkaWZmSW5kZXhcIiB1c2VkIGZvciBjbGVhcmluZyB0aGUgbWVtbyBjYWNoZVxuICBzdGFydFdpdGgoW10pLCBwYWlyd2lzZSgpLCBtYXAoX3JlZjYgPT4ge1xuICAgIGxldCBbcHJldiwgY3Vycl0gPSBfcmVmNjtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGN1cnIubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IHByZXZWYWx1ZSA9IHByZXZbaV07XG4gICAgICBjb25zdCBjdXJyVmFsdWUgPSBjdXJyW2ldO1xuICAgICAgaWYgKCFpc0VxdWFsKHByZXZWYWx1ZSwgY3VyclZhbHVlKSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGZsYXR0ZW5lZFJvdXRlclBhbmVzOiBjdXJyLFxuICAgICAgICAgIGRpZmZJbmRleDogaVxuICAgICAgICB9O1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgZmxhdHRlbmVkUm91dGVyUGFuZXM6IGN1cnIsXG4gICAgICBkaWZmSW5kZXg6IGN1cnIubGVuZ3RoXG4gICAgfTtcbiAgfSksXG4gIC8vIGNyZWF0ZSB0aGUgbWVtb2l6ZWQgYHJlc29sdmVQYW5lYCBmdW5jdGlvbiBhbmQgbWFuYWdlIHRoZSBtZW1vIGNhY2hlXG4gIHNjYW4oKGFjYywgbmV4dCkgPT4ge1xuICAgIGNvbnN0IHtcbiAgICAgIGNhY2hlS2V5c0J5RmxhdEluZGV4LFxuICAgICAgcmVzb2x2ZWRQYW5lQ2FjaGVcbiAgICB9ID0gYWNjO1xuICAgIGNvbnN0IHtcbiAgICAgIGZsYXR0ZW5lZFJvdXRlclBhbmVzLFxuICAgICAgZGlmZkluZGV4XG4gICAgfSA9IG5leHQ7XG4gICAgY29uc3QgYmVmb3JlRGlmZkluZGV4ID0gY2FjaGVLZXlzQnlGbGF0SW5kZXguc2xpY2UoMCwgZGlmZkluZGV4ICsgMSk7XG4gICAgY29uc3QgYWZ0ZXJEaWZmSW5kZXggPSBjYWNoZUtleXNCeUZsYXRJbmRleC5zbGljZShkaWZmSW5kZXggKyAxKTtcbiAgICBjb25zdCBrZXlzVG9LZWVwID0gbmV3IFNldChiZWZvcmVEaWZmSW5kZXguZmxhdE1hcChrZXlTZXQgPT4gQXJyYXkuZnJvbShrZXlTZXQpKSk7XG4gICAgY29uc3Qga2V5c1RvRGVsZXRlID0gYWZ0ZXJEaWZmSW5kZXguZmxhdE1hcChrZXlTZXQgPT4gQXJyYXkuZnJvbShrZXlTZXQpKS5maWx0ZXIoa2V5ID0+ICFrZXlzVG9LZWVwLmhhcyhrZXkpKTtcbiAgICBmb3IgKGNvbnN0IGtleSBvZiBrZXlzVG9EZWxldGUpIHtcbiAgICAgIHJlc29sdmVkUGFuZUNhY2hlLmRlbGV0ZShrZXkpO1xuICAgIH1cbiAgICBjb25zdCBtZW1vaXplID0gbmV4dEZuID0+ICh1bnJlc29sdmVkUGFuZSwgY29udGV4dCwgZmxhdEluZGV4KSA9PiB7XG4gICAgICBjb25zdCBrZXkgPSB1bnJlc29sdmVkUGFuZSAmJiBcIlwiLmNvbmNhdChhc3NpZ25JZCh1bnJlc29sdmVkUGFuZSksIFwiLVwiKS5jb25jYXQoaGFzaENvbnRleHQoY29udGV4dCkpO1xuICAgICAgY29uc3QgY2FjaGVkUmVzb2x2ZWRQYW5lID0ga2V5ICYmIHJlc29sdmVkUGFuZUNhY2hlLmdldChrZXkpO1xuICAgICAgaWYgKGNhY2hlZFJlc29sdmVkUGFuZSkgcmV0dXJuIGNhY2hlZFJlc29sdmVkUGFuZTtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IG5leHRGbih1bnJlc29sdmVkUGFuZSwgY29udGV4dCwgZmxhdEluZGV4KTtcbiAgICAgIGlmICgha2V5KSByZXR1cm4gcmVzdWx0O1xuICAgICAgY29uc3QgY2FjaGVLZXlTZXQgPSBjYWNoZUtleXNCeUZsYXRJbmRleFtmbGF0SW5kZXhdIHx8IC8qIEBfX1BVUkVfXyAqL25ldyBTZXQoKTtcbiAgICAgIGNhY2hlS2V5U2V0LmFkZChrZXkpO1xuICAgICAgY2FjaGVLZXlzQnlGbGF0SW5kZXhbZmxhdEluZGV4XSA9IGNhY2hlS2V5U2V0O1xuICAgICAgcmVzb2x2ZWRQYW5lQ2FjaGUuc2V0KGtleSwgcmVzdWx0KTtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICByZXR1cm4ge1xuICAgICAgZmxhdHRlbmVkUm91dGVyUGFuZXMsXG4gICAgICBjYWNoZUtleXNCeUZsYXRJbmRleCxcbiAgICAgIHJlc29sdmVkUGFuZUNhY2hlLFxuICAgICAgcmVzb2x2ZVBhbmU6IGNyZWF0ZVBhbmVSZXNvbHZlcihtZW1vaXplKVxuICAgIH07XG4gIH0sIGluaXRpYWxDYWNoZVN0YXRlKSxcbiAgLy8gcnVuIHRoZSBtZW1vaXplZCwgcmVjdXJzaXZlIHJlc29sdmluZ1xuICBzd2l0Y2hNYXAoX3JlZjcgPT4ge1xuICAgIGxldCB7XG4gICAgICBmbGF0dGVuZWRSb3V0ZXJQYW5lcyxcbiAgICAgIHJlc29sdmVQYW5lXG4gICAgfSA9IF9yZWY3O1xuICAgIHJldHVybiByZXNvbHZlUGFuZVRyZWUoe1xuICAgICAgdW5yZXNvbHZlZFBhbmU6IHJvb3RQYW5lTm9kZSxcbiAgICAgIGZsYXR0ZW5lZFJvdXRlclBhbmVzLFxuICAgICAgcGFyZW50OiBudWxsLFxuICAgICAgcGF0aDogW10sXG4gICAgICByZXNvbHZlUGFuZSxcbiAgICAgIHN0cnVjdHVyZUNvbnRleHRcbiAgICB9KTtcbiAgfSkpO1xuICByZXR1cm4gcmVzb2x2ZWRQYW5lcyQucGlwZShcbiAgLy8gdGhpcyBkaWZmcyB0aGUgcHJldmlvdXMgZW1pc3Npb24gd2l0aCB0aGUgY3VycmVudCBvbmUuIGlmIHRoZXJlIGlzIGEgbmV3XG4gIC8vIGxvYWRpbmcgcGFuZSBhdCB0aGUgc2FtZSBwb3NpdGlvbiB3aGVyZSBhIHByZXZpb3VzIHBhbmUgYWxyZWFkeSBoYWQgYVxuICAvLyByZXNvbHZlZCB2YWx1ZSAobG9va2luZyBhdCB0aGUgSURzIHRvIGNvbXBhcmUpLCB0aGVuIHJldHVybiB0aGUgcHJldmlvdXNcbiAgLy8gcGFuZSBpbnN0ZWFkIG9mIHRoZSBsb2FkaW5nIHBhbmVcbiAgc2NhbigocHJldiwgbmV4dCkgPT4gbmV4dC5tYXAoKG5leHRQYW5lLCBpbmRleCkgPT4ge1xuICAgIGNvbnN0IHByZXZQYW5lID0gcHJldltpbmRleF07XG4gICAgaWYgKCFwcmV2UGFuZSkgcmV0dXJuIG5leHRQYW5lO1xuICAgIGlmIChuZXh0UGFuZS50eXBlICE9PSBcImxvYWRpbmdcIikgcmV0dXJuIG5leHRQYW5lO1xuICAgIGlmIChwcmV2UGFuZS5yb3V0ZXJQYW5lU2libGluZy5pZCA9PT0gbmV4dFBhbmUucm91dGVyUGFuZVNpYmxpbmcuaWQpIHtcbiAgICAgIHJldHVybiBwcmV2UGFuZTtcbiAgICB9XG4gICAgcmV0dXJuIG5leHRQYW5lO1xuICB9KSwgW10pLFxuICAvLyB0aGlzIHByZXZlbnRzIGR1cGxpY2F0ZSBlbWlzc2lvbnNcbiAgZGlzdGluY3RVbnRpbENoYW5nZWQoKHByZXYsIG5leHQpID0+IHtcbiAgICBpZiAocHJldi5sZW5ndGggIT09IG5leHQubGVuZ3RoKSByZXR1cm4gZmFsc2U7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBuZXh0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBwcmV2VmFsdWUgPSBwcmV2W2ldO1xuICAgICAgY29uc3QgbmV4dFZhbHVlID0gbmV4dFtpXTtcbiAgICAgIGlmIChoYXNoUmVzb2x2ZWRQYW5lTWV0YShwcmV2VmFsdWUpICE9PSBoYXNoUmVzb2x2ZWRQYW5lTWV0YShuZXh0VmFsdWUpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG4gIH0pKTtcbn1cbmZ1bmN0aW9uIHVzZVJvdXRlclBhbmVzU3RyZWFtKCkge1xuICBjb25zdCByb3V0ZXJTdGF0ZVN1YmplY3QgPSB1c2VNZW1vKCgpID0+IG5ldyBSZXBsYXlTdWJqZWN0KDEpLCBbXSk7XG4gIGNvbnN0IHJvdXRlclBhbmVzJCA9IHVzZU1lbW8oKCkgPT4gcm91dGVyU3RhdGVTdWJqZWN0LmFzT2JzZXJ2YWJsZSgpLnBpcGUobWFwKF9yb3V0ZXJTdGF0ZSA9PiAoX3JvdXRlclN0YXRlID09IG51bGwgPyB2b2lkIDAgOiBfcm91dGVyU3RhdGUucGFuZXMpIHx8IFtdKSksIFtyb3V0ZXJTdGF0ZVN1YmplY3RdKTtcbiAgY29uc3Qge1xuICAgIHN0YXRlOiByb3V0ZXJTdGF0ZVxuICB9ID0gdXNlUm91dGVyKCk7XG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgcm91dGVyU3RhdGVTdWJqZWN0Lm5leHQocm91dGVyU3RhdGUpO1xuICB9LCBbcm91dGVyU3RhdGUsIHJvdXRlclN0YXRlU3ViamVjdF0pO1xuICByZXR1cm4gcm91dGVyUGFuZXMkO1xufVxuZnVuY3Rpb24gdXNlUmVzb2x2ZWRQYW5lcygpIHtcbiAgY29uc3QgW2Vycm9yLCBzZXRFcnJvcl0gPSB1c2VTdGF0ZSgpO1xuICBpZiAoZXJyb3IpIHRocm93IGVycm9yO1xuICBjb25zdCB7XG4gICAgc3RydWN0dXJlQ29udGV4dCxcbiAgICByb290UGFuZU5vZGVcbiAgfSA9IHVzZVN0cnVjdHVyZVRvb2woKTtcbiAgY29uc3QgW2RhdGEsIHNldERhdGFdID0gdXNlU3RhdGUoe1xuICAgIHBhbmVEYXRhSXRlbXM6IFtdLFxuICAgIHJlc29sdmVkUGFuZXM6IFtdLFxuICAgIHJvdXRlclBhbmVzOiBbXVxuICB9KTtcbiAgY29uc3Qgcm91dGVyUGFuZXNTdHJlYW0gPSB1c2VSb3V0ZXJQYW5lc1N0cmVhbSgpO1xuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGNvbnN0IHJlc29sdmVkUGFuZXMkID0gY3JlYXRlUmVzb2x2ZWRQYW5lTm9kZVN0cmVhbSh7XG4gICAgICByb290UGFuZU5vZGUsXG4gICAgICByb3V0ZXJQYW5lc1N0cmVhbSxcbiAgICAgIHN0cnVjdHVyZUNvbnRleHRcbiAgICB9KS5waXBlKG1hcChyZXNvbHZlZFBhbmVzID0+IHtcbiAgICAgIGNvbnN0IHJvdXRlclBhbmVzID0gcmVzb2x2ZWRQYW5lcy5yZWR1Y2UoKGFjYywgbmV4dCkgPT4ge1xuICAgICAgICBjb25zdCBjdXJyZW50R3JvdXAgPSBhY2NbbmV4dC5ncm91cEluZGV4XSB8fCBbXTtcbiAgICAgICAgY3VycmVudEdyb3VwW25leHQuc2libGluZ0luZGV4XSA9IG5leHQucm91dGVyUGFuZVNpYmxpbmc7XG4gICAgICAgIGFjY1tuZXh0Lmdyb3VwSW5kZXhdID0gY3VycmVudEdyb3VwO1xuICAgICAgICByZXR1cm4gYWNjO1xuICAgICAgfSwgW10pO1xuICAgICAgY29uc3QgZ3JvdXBzTGVuID0gcm91dGVyUGFuZXMubGVuZ3RoO1xuICAgICAgY29uc3QgcGFuZURhdGFJdGVtcyA9IHJlc29sdmVkUGFuZXMubWFwKHBhbmUgPT4ge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIGNvbnN0IHtcbiAgICAgICAgICBncm91cEluZGV4LFxuICAgICAgICAgIGZsYXRJbmRleCxcbiAgICAgICAgICBzaWJsaW5nSW5kZXgsXG4gICAgICAgICAgcm91dGVyUGFuZVNpYmxpbmcsXG4gICAgICAgICAgcGF0aFxuICAgICAgICB9ID0gcGFuZTtcbiAgICAgICAgY29uc3QgaXRlbUlkID0gcm91dGVyUGFuZVNpYmxpbmcuaWQ7XG4gICAgICAgIGNvbnN0IG5leHRHcm91cCA9IHJvdXRlclBhbmVzW2dyb3VwSW5kZXggKyAxXTtcbiAgICAgICAgY29uc3QgcGFuZURhdGFJdGVtID0ge1xuICAgICAgICAgIGFjdGl2ZTogZ3JvdXBJbmRleCA9PT0gZ3JvdXBzTGVuIC0gMixcbiAgICAgICAgICBjaGlsZEl0ZW1JZDogKF9hID0gbmV4dEdyb3VwID09IG51bGwgPyB2b2lkIDAgOiBuZXh0R3JvdXBbMF0uaWQpICE9IG51bGwgPyBfYSA6IG51bGwsXG4gICAgICAgICAgaW5kZXg6IGZsYXRJbmRleCxcbiAgICAgICAgICBpdGVtSWQ6IHJvdXRlclBhbmVTaWJsaW5nLmlkLFxuICAgICAgICAgIGdyb3VwSW5kZXgsXG4gICAgICAgICAga2V5OiBcIlwiLmNvbmNhdChwYW5lLnR5cGUgPT09IFwibG9hZGluZ1wiID8gXCJ1bmtub3duXCIgOiBwYW5lLnBhbmVOb2RlLmlkLCBcIi1cIikuY29uY2F0KGl0ZW1JZCwgXCItXCIpLmNvbmNhdChzaWJsaW5nSW5kZXgpLFxuICAgICAgICAgIHBhbmU6IHBhbmUudHlwZSA9PT0gXCJsb2FkaW5nXCIgPyBMT0FESU5HX1BBTkUgOiBwYW5lLnBhbmVOb2RlLFxuICAgICAgICAgIHBhcmFtczogcm91dGVyUGFuZVNpYmxpbmcucGFyYW1zIHx8IHt9LFxuICAgICAgICAgIHBhdGg6IHBhdGguam9pbihcIjtcIiksXG4gICAgICAgICAgcGF5bG9hZDogcm91dGVyUGFuZVNpYmxpbmcucGF5bG9hZCxcbiAgICAgICAgICBzZWxlY3RlZDogZmxhdEluZGV4ID09PSByZXNvbHZlZFBhbmVzLmxlbmd0aCAtIDEsXG4gICAgICAgICAgc2libGluZ0luZGV4XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBwYW5lRGF0YUl0ZW07XG4gICAgICB9KTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHBhbmVEYXRhSXRlbXMsXG4gICAgICAgIHJvdXRlclBhbmVzLFxuICAgICAgICByZXNvbHZlZFBhbmVzOiBwYW5lRGF0YUl0ZW1zLm1hcChwYW5lID0+IHBhbmUucGFuZSlcbiAgICAgIH07XG4gICAgfSkpO1xuICAgIGNvbnN0IHN1YnNjcmlwdGlvbiA9IHJlc29sdmVkUGFuZXMkLnN1YnNjcmliZSh7XG4gICAgICBuZXh0OiByZXN1bHQgPT4gc2V0RGF0YShyZXN1bHQpLFxuICAgICAgZXJyb3I6IGUgPT4gc2V0RXJyb3IoZSlcbiAgICB9KTtcbiAgICByZXR1cm4gKCkgPT4gc3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gIH0sIFtyb290UGFuZU5vZGUsIHJvdXRlclBhbmVzU3RyZWFtLCBzdHJ1Y3R1cmVDb250ZXh0XSk7XG4gIHJldHVybiBkYXRhO1xufVxuYXN5bmMgZnVuY3Rpb24gZW5zdXJlRG9jdW1lbnRJZEFuZFR5cGUoZG9jdW1lbnRTdG9yZSwgaWQsIHR5cGUpIHtcbiAgaWYgKGlkICYmIHR5cGUpIHJldHVybiB7XG4gICAgaWQsXG4gICAgdHlwZVxuICB9O1xuICBpZiAoIWlkICYmIHR5cGUpIHJldHVybiB7XG4gICAgaWQ6IHV1aWQoKSxcbiAgICB0eXBlXG4gIH07XG4gIGlmIChpZCAmJiAhdHlwZSkge1xuICAgIGNvbnN0IHJlc29sdmVkVHlwZSA9IGF3YWl0IGZpcnN0VmFsdWVGcm9tKGRvY3VtZW50U3RvcmUucmVzb2x2ZVR5cGVGb3JEb2N1bWVudChpZCkpO1xuICAgIHJldHVybiB7XG4gICAgICBpZCxcbiAgICAgIHR5cGU6IHJlc29sdmVkVHlwZVxuICAgIH07XG4gIH1cbiAgdGhyb3cgbmV3IFBhbmVSZXNvbHV0aW9uRXJyb3Ioe1xuICAgIG1lc3NhZ2U6IFwiTmVpdGhlciBkb2N1bWVudCBgaWRgIG9yIGB0eXBlYCB3YXMgcHJvdmlkZWQgd2hlbiB0cnlpbmcgdG8gcmVzb2x2ZSBpbnRlbnQuXCJcbiAgfSk7XG59XG5jb25zdCBFTVBUWV9SRUNPUkQgPSB7fTtcbmNvbnN0IEludGVudFJlc29sdmVyID0gbWVtbyhmdW5jdGlvbiBJbnRlbnRSZXNvbHZlcjIoKSB7XG4gIGNvbnN0IHtcbiAgICBuYXZpZ2F0ZVxuICB9ID0gdXNlUm91dGVyKCk7XG4gIGNvbnN0IG1heWJlSW50ZW50ID0gdXNlUm91dGVyU3RhdGUodXNlQ2FsbGJhY2socm91dGVyU3RhdGUgPT4ge1xuICAgIGNvbnN0IGludGVudE5hbWUgPSB0eXBlb2Ygcm91dGVyU3RhdGUuaW50ZW50ID09PSBcInN0cmluZ1wiID8gcm91dGVyU3RhdGUuaW50ZW50IDogdm9pZCAwO1xuICAgIHJldHVybiBpbnRlbnROYW1lID8ge1xuICAgICAgaW50ZW50OiBpbnRlbnROYW1lLFxuICAgICAgcGFyYW1zOiBpc1JlY29yZChyb3V0ZXJTdGF0ZS5wYXJhbXMpID8gcm91dGVyU3RhdGUucGFyYW1zIDogRU1QVFlfUkVDT1JELFxuICAgICAgcGF5bG9hZDogcm91dGVyU3RhdGUucGF5bG9hZFxuICAgIH0gOiB2b2lkIDA7XG4gIH0sIFtdKSk7XG4gIGNvbnN0IHtcbiAgICByb290UGFuZU5vZGUsXG4gICAgc3RydWN0dXJlQ29udGV4dFxuICB9ID0gdXNlU3RydWN0dXJlVG9vbCgpO1xuICBjb25zdCBkb2N1bWVudFN0b3JlID0gdXNlRG9jdW1lbnRTdG9yZSgpO1xuICBjb25zdCBbZXJyb3IsIHNldEVycm9yXSA9IHVzZVN0YXRlKG51bGwpO1xuICBpZiAoZXJyb3IpIHRocm93IGVycm9yO1xuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChtYXliZUludGVudCkge1xuICAgICAgY29uc3Qge1xuICAgICAgICBpbnRlbnQsXG4gICAgICAgIHBhcmFtcyxcbiAgICAgICAgcGF5bG9hZFxuICAgICAgfSA9IG1heWJlSW50ZW50O1xuICAgICAgbGV0IGNhbmNlbGxlZCA9IGZhbHNlO1xuICAgICAgYXN5bmMgZnVuY3Rpb24gZWZmZWN0KCkge1xuICAgICAgICBjb25zdCB7XG4gICAgICAgICAgaWQsXG4gICAgICAgICAgdHlwZVxuICAgICAgICB9ID0gYXdhaXQgZW5zdXJlRG9jdW1lbnRJZEFuZFR5cGUoZG9jdW1lbnRTdG9yZSwgdHlwZW9mIHBhcmFtcy5pZCA9PT0gXCJzdHJpbmdcIiA/IHBhcmFtcy5pZCA6IHZvaWQgMCwgdHlwZW9mIHBhcmFtcy50eXBlID09PSBcInN0cmluZ1wiID8gcGFyYW1zLnR5cGUgOiB2b2lkIDApO1xuICAgICAgICBpZiAoY2FuY2VsbGVkKSByZXR1cm47XG4gICAgICAgIGNvbnN0IHBhbmVzID0gYXdhaXQgcmVzb2x2ZUludGVudCh7XG4gICAgICAgICAgaW50ZW50LFxuICAgICAgICAgIHBhcmFtczoge1xuICAgICAgICAgICAgLi4ucGFyYW1zLFxuICAgICAgICAgICAgaWQsXG4gICAgICAgICAgICB0eXBlXG4gICAgICAgICAgfSxcbiAgICAgICAgICBwYXlsb2FkLFxuICAgICAgICAgIHJvb3RQYW5lTm9kZSxcbiAgICAgICAgICBzdHJ1Y3R1cmVDb250ZXh0XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoY2FuY2VsbGVkKSByZXR1cm47XG4gICAgICAgIG5hdmlnYXRlKHtcbiAgICAgICAgICBwYW5lc1xuICAgICAgICB9LCB7XG4gICAgICAgICAgcmVwbGFjZTogdHJ1ZVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGVmZmVjdCgpLmNhdGNoKHNldEVycm9yKTtcbiAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgIGNhbmNlbGxlZCA9IHRydWU7XG4gICAgICB9O1xuICAgIH1cbiAgfSwgW2RvY3VtZW50U3RvcmUsIG1heWJlSW50ZW50LCBuYXZpZ2F0ZSwgcm9vdFBhbmVOb2RlLCBzdHJ1Y3R1cmVDb250ZXh0XSk7XG4gIHJldHVybiBudWxsO1xufSk7XG52YXIgX19mcmVlemUkMSA9IE9iamVjdC5mcmVlemU7XG52YXIgX19kZWZQcm9wJDEgPSBPYmplY3QuZGVmaW5lUHJvcGVydHk7XG52YXIgX190ZW1wbGF0ZSQxID0gKGNvb2tlZCwgcmF3KSA9PiBfX2ZyZWV6ZSQxKF9fZGVmUHJvcCQxKGNvb2tlZCwgXCJyYXdcIiwge1xuICB2YWx1ZTogX19mcmVlemUkMShyYXcgfHwgY29va2VkLnNsaWNlKCkpXG59KSk7XG52YXIgX2EkMTtcbmNvbnN0IFBhdGhTZWdtZW50ID0gc3R5bGVkLnNwYW4oX2EkMSB8fCAoX2EkMSA9IF9fdGVtcGxhdGUkMShbXCJcXG4gICY6bm90KDpsYXN0LWNoaWxkKTo6YWZ0ZXIge1xcbiAgICBjb250ZW50OiAnIFxcdTI3OUQgJztcXG4gICAgb3BhY2l0eTogMC41O1xcbiAgfVxcblwiXSkpKTtcbmZ1bmN0aW9uIGZvcm1hdFN0YWNrKHN0YWNrKSB7XG4gIHJldHVybiBzdGFjay5yZXBsYWNlKC9cXChcXC5cXC5cXC5cXClcXC4vZywgXCIoLi4uKVxcbiAgLlwiKS5yZXBsYWNlKC9fX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFX1xcZCtfKy9nLCBcIlwiKS5yZXBsYWNlKC9fX19kZWZhdWx0XFwuL2csIFwiLlwiKS5yZXBsYWNlKG5ldyBSZWdFeHAoXCIgXFxcXChodHRwcz86XFxcXC9cXFxcL1wiLmNvbmNhdCh3aW5kb3cubG9jYXRpb24uaG9zdCksIFwiZ1wiKSwgXCIgKFwiKTtcbn1cbmZ1bmN0aW9uIFN0cnVjdHVyZUVycm9yKF9yZWY4KSB7XG4gIGxldCB7XG4gICAgZXJyb3JcbiAgfSA9IF9yZWY4O1xuICBpZiAoIShlcnJvciBpbnN0YW5jZW9mIFBhbmVSZXNvbHV0aW9uRXJyb3IpKSB7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbiAgY29uc3Qge1xuICAgIGNhdXNlXG4gIH0gPSBlcnJvcjtcbiAgY29uc3Qge1xuICAgIHRcbiAgfSA9IHVzZVRyYW5zbGF0aW9uKHN0cnVjdHVyZUxvY2FsZU5hbWVzcGFjZSk7XG4gIGNvbnN0IHN0YWNrID0gKGNhdXNlID09IG51bGwgPyB2b2lkIDAgOiBjYXVzZS5zdGFjaykgfHwgZXJyb3Iuc3RhY2s7XG4gIGNvbnN0IHNob3dTdGFjayA9IHN0YWNrICYmICEoY2F1c2UgaW5zdGFuY2VvZiBTZXJpYWxpemVFcnJvcikgJiYgIWVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoXCJNb2R1bGUgYnVpbGQgZmFpbGVkOlwiKTtcbiAgY29uc3QgcGF0aCA9IGNhdXNlIGluc3RhbmNlb2YgU2VyaWFsaXplRXJyb3IgPyBjYXVzZS5wYXRoIDogW107XG4gIGNvbnN0IGhlbHBJZCA9IGNhdXNlIGluc3RhbmNlb2YgU2VyaWFsaXplRXJyb3IgJiYgY2F1c2UuaGVscElkIHx8IGVycm9yLmhlbHBJZDtcbiAgY29uc3QgaGFuZGxlUmVsb2FkID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcbiAgfSwgW10pO1xuICByZXR1cm4gLyogQF9fUFVSRV9fICovanN4KENhcmQsIHtcbiAgICBoZWlnaHQ6IFwiZmlsbFwiLFxuICAgIG92ZXJmbG93OiBcImF1dG9cIixcbiAgICBwYWRkaW5nOiA0LFxuICAgIHNpemluZzogXCJib3JkZXJcIixcbiAgICB0b25lOiBcImNyaXRpY2FsXCIsXG4gICAgY2hpbGRyZW46IC8qIEBfX1BVUkVfXyAqL2pzeHMoQ29udGFpbmVyLCB7XG4gICAgICBjaGlsZHJlbjogWy8qIEBfX1BVUkVfXyAqL2pzeChIZWFkaW5nLCB7XG4gICAgICAgIGFzOiBcImgyXCIsXG4gICAgICAgIGNoaWxkcmVuOiB0KFwic3RydWN0dXJlLWVycm9yLmhlYWRlci50ZXh0XCIpXG4gICAgICB9KSwgLyogQF9fUFVSRV9fICovanN4cyhDYXJkLCB7XG4gICAgICAgIG1hcmdpblRvcDogNCxcbiAgICAgICAgcGFkZGluZzogNCxcbiAgICAgICAgcmFkaXVzOiAyLFxuICAgICAgICBvdmVyZmxvdzogXCJhdXRvXCIsXG4gICAgICAgIHNoYWRvdzogMSxcbiAgICAgICAgdG9uZTogXCJpbmhlcml0XCIsXG4gICAgICAgIGNoaWxkcmVuOiBbcGF0aC5sZW5ndGggPiAwICYmIC8qIEBfX1BVUkVfXyAqL2pzeHMoU3RhY2ssIHtcbiAgICAgICAgICBzcGFjZTogMixcbiAgICAgICAgICBjaGlsZHJlbjogWy8qIEBfX1BVUkVfXyAqL2pzeChUZXh0LCB7XG4gICAgICAgICAgICBzaXplOiAxLFxuICAgICAgICAgICAgd2VpZ2h0OiBcIm1lZGl1bVwiLFxuICAgICAgICAgICAgY2hpbGRyZW46IHQoXCJzdHJ1Y3R1cmUtZXJyb3Iuc3RydWN0dXJlLXBhdGgubGFiZWxcIilcbiAgICAgICAgICB9KSwgLyogQF9fUFVSRV9fICovanN4KENvZGUsIHtcbiAgICAgICAgICAgIGNoaWxkcmVuOiBwYXRoLnNsaWNlKDEpLm1hcCgoc2VnbWVudCwgaSkgPT5cbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZWFjdC9uby1hcnJheS1pbmRleC1rZXlcbiAgICAgICAgICAgIC8qIEBfX1BVUkVfXyAqL1xuICAgICAgICAgICAganN4KFBhdGhTZWdtZW50LCB7XG4gICAgICAgICAgICAgIGNoaWxkcmVuOiBzZWdtZW50XG4gICAgICAgICAgICB9LCBcIlwiLmNvbmNhdChzZWdtZW50LCBcIi1cIikuY29uY2F0KGkpKSlcbiAgICAgICAgICB9KV1cbiAgICAgICAgfSksIC8qIEBfX1BVUkVfXyAqL2pzeHMoU3RhY2ssIHtcbiAgICAgICAgICBtYXJnaW5Ub3A6IDQsXG4gICAgICAgICAgc3BhY2U6IDIsXG4gICAgICAgICAgY2hpbGRyZW46IFsvKiBAX19QVVJFX18gKi9qc3goVGV4dCwge1xuICAgICAgICAgICAgc2l6ZTogMSxcbiAgICAgICAgICAgIHdlaWdodDogXCJtZWRpdW1cIixcbiAgICAgICAgICAgIGNoaWxkcmVuOiB0KFwic3RydWN0dXJlLWVycm9yLmVycm9yLmxhYmVsXCIpXG4gICAgICAgICAgfSksIC8qIEBfX1BVUkVfXyAqL2pzeChDb2RlLCB7XG4gICAgICAgICAgICBjaGlsZHJlbjogc2hvd1N0YWNrID8gZm9ybWF0U3RhY2soc3RhY2spIDogZXJyb3IubWVzc2FnZVxuICAgICAgICAgIH0pXVxuICAgICAgICB9KSwgaGVscElkICYmIC8qIEBfX1BVUkVfXyAqL2pzeChCb3gsIHtcbiAgICAgICAgICBtYXJnaW5Ub3A6IDQsXG4gICAgICAgICAgY2hpbGRyZW46IC8qIEBfX1BVUkVfXyAqL2pzeChUZXh0LCB7XG4gICAgICAgICAgICBjaGlsZHJlbjogLyogQF9fUFVSRV9fICovanN4KFwiYVwiLCB7XG4gICAgICAgICAgICAgIGhyZWY6IGdlbmVyYXRlSGVscFVybChoZWxwSWQpLFxuICAgICAgICAgICAgICByZWw6IFwibm9vcGVuZXIgbm9yZWZlcnJlclwiLFxuICAgICAgICAgICAgICB0YXJnZXQ6IFwiX2JsYW5rXCIsXG4gICAgICAgICAgICAgIGNoaWxkcmVuOiB0KFwic3RydWN0dXJlLWVycm9yLmRvY3MtbGluay50ZXh0XCIpXG4gICAgICAgICAgICB9KVxuICAgICAgICAgIH0pXG4gICAgICAgIH0pLCAvKiBAX19QVVJFX18gKi9qc3goQm94LCB7XG4gICAgICAgICAgbWFyZ2luVG9wOiA0LFxuICAgICAgICAgIGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi9qc3goQnV0dG9uLCB7XG4gICAgICAgICAgICB0ZXh0OiB0KFwic3RydWN0dXJlLWVycm9yLnJlbG9hZC1idXR0b24udGV4dFwiKSxcbiAgICAgICAgICAgIGljb246IFN5bmNJY29uLFxuICAgICAgICAgICAgdG9uZTogXCJwcmltYXJ5XCIsXG4gICAgICAgICAgICBvbkNsaWNrOiBoYW5kbGVSZWxvYWRcbiAgICAgICAgICB9KVxuICAgICAgICB9KV1cbiAgICAgIH0pXVxuICAgIH0pXG4gIH0pO1xufVxuZnVuY3Rpb24gVW5rbm93blBhbmUocHJvcHMpIHtcbiAgY29uc3Qge1xuICAgIGlzU2VsZWN0ZWQsXG4gICAgcGFuZSxcbiAgICBwYW5lS2V5XG4gIH0gPSBwcm9wcztcbiAgY29uc3QgdHlwZSA9IGlzUmVjb3JkKHBhbmUpICYmIHBhbmUudHlwZSB8fCBudWxsO1xuICBjb25zdCB7XG4gICAgdFxuICB9ID0gdXNlVHJhbnNsYXRpb24oc3RydWN0dXJlTG9jYWxlTmFtZXNwYWNlKTtcbiAgcmV0dXJuIC8qIEBfX1BVUkVfXyAqL2pzeHMoUGFuZSwge1xuICAgIGlkOiBwYW5lS2V5LFxuICAgIHNlbGVjdGVkOiBpc1NlbGVjdGVkLFxuICAgIGNoaWxkcmVuOiBbLyogQF9fUFVSRV9fICovanN4KFBhbmVIZWFkZXIsIHtcbiAgICAgIHRpdGxlOiB0KFwicGFuZXMudW5rbm93bi1wYW5lLXR5cGUudGl0bGVcIilcbiAgICB9KSwgLyogQF9fUFVSRV9fICovanN4KFBhbmVDb250ZW50LCB7XG4gICAgICBjaGlsZHJlbjogLyogQF9fUFVSRV9fICovanN4KEJveCwge1xuICAgICAgICBwYWRkaW5nOiA0LFxuICAgICAgICBjaGlsZHJlbjogdHlwZW9mIHR5cGUgPT09IFwic3RyaW5nXCIgPyAvKiBAX19QVVJFX18gKi9qc3goVGV4dCwge1xuICAgICAgICAgIGFzOiBcInBcIixcbiAgICAgICAgICBtdXRlZDogdHJ1ZSxcbiAgICAgICAgICBjaGlsZHJlbjogLyogQF9fUFVSRV9fICovanN4KFRyYW5zbGF0ZSwge1xuICAgICAgICAgICAgdCxcbiAgICAgICAgICAgIGkxOG5LZXk6IFwicGFuZXMudW5rbm93bi1wYW5lLXR5cGUudW5rbm93bi10eXBlLnRleHRcIixcbiAgICAgICAgICAgIHZhbHVlczoge1xuICAgICAgICAgICAgICB0eXBlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSlcbiAgICAgICAgfSkgOiAvKiBAX19QVVJFX18gKi9qc3goVGV4dCwge1xuICAgICAgICAgIGFzOiBcInBcIixcbiAgICAgICAgICBtdXRlZDogdHJ1ZSxcbiAgICAgICAgICBjaGlsZHJlbjogLyogQF9fUFVSRV9fICovanN4KFRyYW5zbGF0ZSwge1xuICAgICAgICAgICAgdCxcbiAgICAgICAgICAgIGkxOG5LZXk6IFwicGFuZXMudW5rbm93bi1wYW5lLXR5cGUubWlzc2luZy10eXBlLnRleHRcIlxuICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgICB9KVxuICAgIH0pXVxuICB9KTtcbn1cbmNvbnN0IHBhbmVNYXAgPSB7XG4gIGNvbXBvbmVudDogbGF6eSgoKSA9PiBpbXBvcnQoJy4vaW5kZXgtcElxbE1wbmkuanMnKSksXG4gIGRvY3VtZW50OiBsYXp5KCgpID0+IGltcG9ydCgnLi9wYW5lLURlbFV5djMyLmpzJykpLFxuICBkb2N1bWVudExpc3Q6IGxhenkoKCkgPT4gaW1wb3J0KCcuL3BhbmUtQ29Zd0p4amouanMnKSksXG4gIGxpc3Q6IGxhenkoKCkgPT4gaW1wb3J0KCcuL2luZGV4LURINFlJVF93LmpzJykpXG59O1xuY29uc3QgU3RydWN0dXJlVG9vbFBhbmUgPSBtZW1vKGZ1bmN0aW9uIFN0cnVjdHVyZVRvb2xQYW5lMihwcm9wcykge1xuICBjb25zdCB7XG4gICAgYWN0aXZlLFxuICAgIGNoaWxkSXRlbUlkLFxuICAgIGdyb3VwSW5kZXgsXG4gICAgaW5kZXgsXG4gICAgaXRlbUlkLFxuICAgIHBhbmUsXG4gICAgcGFuZUtleSxcbiAgICBwYXJhbXMsXG4gICAgcGF5bG9hZCxcbiAgICBwYXRoLFxuICAgIHNlbGVjdGVkLFxuICAgIHNpYmxpbmdJbmRleFxuICB9ID0gcHJvcHM7XG4gIGNvbnN0IFBhbmVDb21wb25lbnQgPSBwYW5lTWFwW3BhbmUudHlwZV0gfHwgVW5rbm93blBhbmU7XG4gIHJldHVybiAvKiBAX19QVVJFX18gKi9qc3goUGFuZVJvdXRlclByb3ZpZGVyLCB7XG4gICAgZmxhdEluZGV4OiBpbmRleCxcbiAgICBpbmRleDogZ3JvdXBJbmRleCxcbiAgICBwYXJhbXMsXG4gICAgcGF5bG9hZCxcbiAgICBzaWJsaW5nSW5kZXgsXG4gICAgY2hpbGRyZW46IC8qIEBfX1BVUkVfXyAqL2pzeChTdXNwZW5zZSwge1xuICAgICAgZmFsbGJhY2s6IC8qIEBfX1BVUkVfXyAqL2pzeChMb2FkaW5nUGFuZSwge1xuICAgICAgICBwYW5lS2V5LFxuICAgICAgICBwYXRoLFxuICAgICAgICBzZWxlY3RlZFxuICAgICAgfSksXG4gICAgICBjaGlsZHJlbjogLyogQF9fUFVSRV9fICovanN4KFBhbmVDb21wb25lbnQsIHtcbiAgICAgICAgY2hpbGRJdGVtSWQ6IGNoaWxkSXRlbUlkIHx8IFwiXCIsXG4gICAgICAgIGluZGV4LFxuICAgICAgICBpdGVtSWQsXG4gICAgICAgIGlzQWN0aXZlOiBhY3RpdmUsXG4gICAgICAgIGlzU2VsZWN0ZWQ6IHNlbGVjdGVkLFxuICAgICAgICBwYW5lS2V5LFxuICAgICAgICBwYW5lXG4gICAgICB9KVxuICAgIH0pXG4gIH0pO1xufSwgKF9yZWY5LCBfcmVmMTApID0+IHtcbiAgbGV0IHtcbiAgICBwYXJhbXM6IHByZXZQYXJhbXMgPSB7fSxcbiAgICBwYXlsb2FkOiBwcmV2UGF5bG9hZCA9IG51bGwsXG4gICAgLi4ucHJldlxuICB9ID0gX3JlZjk7XG4gIGxldCB7XG4gICAgcGFyYW1zOiBuZXh0UGFyYW1zID0ge30sXG4gICAgcGF5bG9hZDogbmV4dFBheWxvYWQgPSBudWxsLFxuICAgIC4uLm5leHRcbiAgfSA9IF9yZWYxMDtcbiAgaWYgKCFpc0VxdWFsKHByZXZQYXJhbXMsIG5leHRQYXJhbXMpKSByZXR1cm4gZmFsc2U7XG4gIGlmICghaXNFcXVhbChwcmV2UGF5bG9hZCwgbmV4dFBheWxvYWQpKSByZXR1cm4gZmFsc2U7XG4gIGNvbnN0IGtleXMgPSAvKiBAX19QVVJFX18gKi9uZXcgU2V0KFsuLi5PYmplY3Qua2V5cyhwcmV2KSwgLi4uT2JqZWN0LmtleXMobmV4dCldKTtcbiAgZm9yIChjb25zdCBrZXkgb2Yga2V5cykge1xuICAgIGlmIChwcmV2W2tleV0gIT09IG5leHRba2V5XSkgcmV0dXJuIGZhbHNlO1xuICB9XG4gIHJldHVybiB0cnVlO1xufSk7XG5mdW5jdGlvbiBOb0RvY3VtZW50VHlwZXNTY3JlZW4oKSB7XG4gIGNvbnN0IHtcbiAgICB0XG4gIH0gPSB1c2VUcmFuc2xhdGlvbihzdHJ1Y3R1cmVMb2NhbGVOYW1lc3BhY2UpO1xuICByZXR1cm4gLyogQF9fUFVSRV9fICovanN4KENhcmQsIHtcbiAgICBoZWlnaHQ6IFwiZmlsbFwiLFxuICAgIGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi9qc3goRmxleCwge1xuICAgICAgYWxpZ246IFwiY2VudGVyXCIsXG4gICAgICBoZWlnaHQ6IFwiZmlsbFwiLFxuICAgICAganVzdGlmeTogXCJjZW50ZXJcIixcbiAgICAgIHBhZGRpbmc6IDQsXG4gICAgICBzaXppbmc6IFwiYm9yZGVyXCIsXG4gICAgICBjaGlsZHJlbjogLyogQF9fUFVSRV9fICovanN4KENvbnRhaW5lciwge1xuICAgICAgICB3aWR0aDogMCxcbiAgICAgICAgY2hpbGRyZW46IC8qIEBfX1BVUkVfXyAqL2pzeChDYXJkLCB7XG4gICAgICAgICAgcGFkZGluZzogNCxcbiAgICAgICAgICByYWRpdXM6IDIsXG4gICAgICAgICAgc2hhZG93OiAxLFxuICAgICAgICAgIHRvbmU6IFwiY2F1dGlvblwiLFxuICAgICAgICAgIGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi9qc3hzKEZsZXgsIHtcbiAgICAgICAgICAgIGNoaWxkcmVuOiBbLyogQF9fUFVSRV9fICovanN4KEJveCwge1xuICAgICAgICAgICAgICBjaGlsZHJlbjogLyogQF9fUFVSRV9fICovanN4KFRleHQsIHtcbiAgICAgICAgICAgICAgICBzaXplOiAxLFxuICAgICAgICAgICAgICAgIGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi9qc3goV2FybmluZ091dGxpbmVJY29uLCB7fSlcbiAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0pLCAvKiBAX19QVVJFX18gKi9qc3hzKFN0YWNrLCB7XG4gICAgICAgICAgICAgIGZsZXg6IDEsXG4gICAgICAgICAgICAgIG1hcmdpbkxlZnQ6IDMsXG4gICAgICAgICAgICAgIHNwYWNlOiAzLFxuICAgICAgICAgICAgICBjaGlsZHJlbjogWy8qIEBfX1BVUkVfXyAqL2pzeChUZXh0LCB7XG4gICAgICAgICAgICAgICAgYXM6IFwiaDFcIixcbiAgICAgICAgICAgICAgICBzaXplOiAxLFxuICAgICAgICAgICAgICAgIHdlaWdodDogXCJtZWRpdW1cIixcbiAgICAgICAgICAgICAgICBjaGlsZHJlbjogdChcIm5vLWRvY3VtZW50LXR5cGVzLXNjcmVlbi50aXRsZVwiKVxuICAgICAgICAgICAgICB9KSwgLyogQF9fUFVSRV9fICovanN4KFRleHQsIHtcbiAgICAgICAgICAgICAgICBhczogXCJwXCIsXG4gICAgICAgICAgICAgICAgbXV0ZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgc2l6ZTogMSxcbiAgICAgICAgICAgICAgICBjaGlsZHJlbjogdChcIm5vLWRvY3VtZW50LXR5cGVzLXNjcmVlbi5zdWJ0aXRsZVwiKVxuICAgICAgICAgICAgICB9KSwgLyogQF9fUFVSRV9fICovanN4KFRleHQsIHtcbiAgICAgICAgICAgICAgICBhczogXCJwXCIsXG4gICAgICAgICAgICAgICAgbXV0ZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgc2l6ZTogMSxcbiAgICAgICAgICAgICAgICBjaGlsZHJlbjogLyogQF9fUFVSRV9fICovanN4KFwiYVwiLCB7XG4gICAgICAgICAgICAgICAgICBocmVmOiBcImh0dHBzOi8vd3d3LnNhbml0eS5pby9kb2NzL2NyZWF0ZS1hLXNjaGVtYS1hbmQtY29uZmlndXJlLXNhbml0eS1zdHVkaW9cIixcbiAgICAgICAgICAgICAgICAgIHRhcmdldDogXCJfYmxhbmtcIixcbiAgICAgICAgICAgICAgICAgIHJlbDogXCJub3JlZmVycmVyXCIsXG4gICAgICAgICAgICAgICAgICBjaGlsZHJlbjogdChcIm5vLWRvY3VtZW50LXR5cGVzLXNjcmVlbi5saW5rLXRleHRcIilcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICB9KV1cbiAgICAgICAgICAgIH0pXVxuICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgICB9KVxuICAgIH0pXG4gIH0pO1xufVxuY29uc3QgRG9jdW1lbnRUaXRsZSA9IHByb3BzID0+IHtcbiAgY29uc3Qge1xuICAgIGRvY3VtZW50SWQsXG4gICAgZG9jdW1lbnRUeXBlXG4gIH0gPSBwcm9wcztcbiAgY29uc3QgZWRpdFN0YXRlID0gdXNlRWRpdFN0YXRlKGRvY3VtZW50SWQsIGRvY3VtZW50VHlwZSk7XG4gIGNvbnN0IHNjaGVtYSA9IHVzZVNjaGVtYSgpO1xuICBjb25zdCB7XG4gICAgdFxuICB9ID0gdXNlVHJhbnNsYXRpb24oc3RydWN0dXJlTG9jYWxlTmFtZXNwYWNlKTtcbiAgY29uc3QgaXNOZXdEb2N1bWVudCA9ICEoZWRpdFN0YXRlID09IG51bGwgPyB2b2lkIDAgOiBlZGl0U3RhdGUucHVibGlzaGVkKSAmJiAhKGVkaXRTdGF0ZSA9PSBudWxsID8gdm9pZCAwIDogZWRpdFN0YXRlLmRyYWZ0KTtcbiAgY29uc3QgZG9jdW1lbnRWYWx1ZSA9IChlZGl0U3RhdGUgPT0gbnVsbCA/IHZvaWQgMCA6IGVkaXRTdGF0ZS5kcmFmdCkgfHwgKGVkaXRTdGF0ZSA9PSBudWxsID8gdm9pZCAwIDogZWRpdFN0YXRlLnB1Ymxpc2hlZCk7XG4gIGNvbnN0IHNjaGVtYVR5cGUgPSBzY2hlbWEuZ2V0KGRvY3VtZW50VHlwZSk7XG4gIGNvbnN0IHtcbiAgICB2YWx1ZSxcbiAgICBpc0xvYWRpbmc6IHByZXZpZXdWYWx1ZUlzTG9hZGluZ1xuICB9ID0gdW5zdGFibGVfdXNlVmFsdWVQcmV2aWV3KHtcbiAgICBlbmFibGVkOiB0cnVlLFxuICAgIHNjaGVtYVR5cGUsXG4gICAgdmFsdWU6IGRvY3VtZW50VmFsdWVcbiAgfSk7XG4gIGNvbnN0IGRvY3VtZW50VGl0bGUgPSBpc05ld0RvY3VtZW50ID8gdChcImJyb3dzZXItZG9jdW1lbnQtdGl0bGUubmV3LWRvY3VtZW50XCIsIHtcbiAgICBzY2hlbWFUeXBlOiAoc2NoZW1hVHlwZSA9PSBudWxsID8gdm9pZCAwIDogc2NoZW1hVHlwZS50aXRsZSkgfHwgKHNjaGVtYVR5cGUgPT0gbnVsbCA/IHZvaWQgMCA6IHNjaGVtYVR5cGUubmFtZSlcbiAgfSkgOiAodmFsdWUgPT0gbnVsbCA/IHZvaWQgMCA6IHZhbHVlLnRpdGxlKSB8fCB0KFwiYnJvd3Nlci1kb2N1bWVudC10aXRsZS51bnRpdGxlZC1kb2N1bWVudFwiKTtcbiAgY29uc3Qgc2V0dGxlZCA9IGVkaXRTdGF0ZS5yZWFkeSAmJiAhcHJldmlld1ZhbHVlSXNMb2FkaW5nO1xuICBjb25zdCBuZXdUaXRsZSA9IHVzZUNvbnN0cnVjdERvY3VtZW50VGl0bGUoZG9jdW1lbnRUaXRsZSk7XG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKCFzZXR0bGVkKSByZXR1cm47XG4gICAgZG9jdW1lbnQudGl0bGUgPSBuZXdUaXRsZTtcbiAgfSwgW2RvY3VtZW50VGl0bGUsIHNldHRsZWQsIG5ld1RpdGxlXSk7XG4gIHJldHVybiBudWxsO1xufTtcbmNvbnN0IFBhc3N0aHJvdWdoVGl0bGUgPSBwcm9wcyA9PiB7XG4gIGNvbnN0IHtcbiAgICB0aXRsZVxuICB9ID0gcHJvcHM7XG4gIGNvbnN0IG5ld1RpdGxlID0gdXNlQ29uc3RydWN0RG9jdW1lbnRUaXRsZSh0aXRsZSk7XG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgZG9jdW1lbnQudGl0bGUgPSBuZXdUaXRsZTtcbiAgfSwgW25ld1RpdGxlLCB0aXRsZV0pO1xuICByZXR1cm4gbnVsbDtcbn07XG5jb25zdCBTdHJ1Y3R1cmVUaXRsZSA9IHByb3BzID0+IHtcbiAgY29uc3Qge1xuICAgIHJlc29sdmVkUGFuZXNcbiAgfSA9IHByb3BzO1xuICBpZiAoIShyZXNvbHZlZFBhbmVzID09IG51bGwgPyB2b2lkIDAgOiByZXNvbHZlZFBhbmVzLmxlbmd0aCkpIHJldHVybiBudWxsO1xuICBjb25zdCBsYXN0UGFuZSA9IHJlc29sdmVkUGFuZXNbcmVzb2x2ZWRQYW5lcy5sZW5ndGggLSAxXTtcbiAgaWYgKGlzTG9hZGluZ1BhbmUobGFzdFBhbmUpKSB7XG4gICAgcmV0dXJuIC8qIEBfX1BVUkVfXyAqL2pzeChQYXNzdGhyb3VnaFRpdGxlLCB7fSk7XG4gIH1cbiAgaWYgKGlzRG9jdW1lbnRQYW5lKGxhc3RQYW5lKSkge1xuICAgIGlmIChsYXN0UGFuZSA9PSBudWxsID8gdm9pZCAwIDogbGFzdFBhbmUudGl0bGUpIHtcbiAgICAgIHJldHVybiAvKiBAX19QVVJFX18gKi9qc3goUGFzc3Rocm91Z2hUaXRsZSwge1xuICAgICAgICB0aXRsZTogbGFzdFBhbmUudGl0bGVcbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gLyogQF9fUFVSRV9fICovanN4KERvY3VtZW50VGl0bGUsIHtcbiAgICAgIGRvY3VtZW50SWQ6IGxhc3RQYW5lLm9wdGlvbnMuaWQsXG4gICAgICBkb2N1bWVudFR5cGU6IGxhc3RQYW5lLm9wdGlvbnMudHlwZVxuICAgIH0pO1xuICB9XG4gIHJldHVybiAvKiBAX19QVVJFX18gKi9qc3goUGFzc3Rocm91Z2hUaXRsZSwge1xuICAgIHRpdGxlOiBsYXN0UGFuZSA9PSBudWxsID8gdm9pZCAwIDogbGFzdFBhbmUudGl0bGVcbiAgfSk7XG59O1xuZnVuY3Rpb24gdXNlQ29uc3RydWN0RG9jdW1lbnRUaXRsZShhY3RpdmVUaXRsZSkge1xuICBjb25zdCBzdHJ1Y3R1cmVUb29sQmFzZVRpdGxlID0gdXNlU3RydWN0dXJlVG9vbCgpLnN0cnVjdHVyZUNvbnRleHQudGl0bGU7XG4gIHJldHVybiBbYWN0aXZlVGl0bGUsIHN0cnVjdHVyZVRvb2xCYXNlVGl0bGVdLmZpbHRlcih0aXRsZSA9PiB0aXRsZSkuam9pbihcIiB8IFwiKTtcbn1cbmZ1bmN0aW9uIGlzRG9jdW1lbnRQYW5lKHBhbmUpIHtcbiAgcmV0dXJuIHBhbmUgIT09IExPQURJTkdfUEFORSAmJiBwYW5lLnR5cGUgPT09IFwiZG9jdW1lbnRcIjtcbn1cbmZ1bmN0aW9uIGlzTG9hZGluZ1BhbmUocGFuZSkge1xuICByZXR1cm4gcGFuZSA9PT0gTE9BRElOR19QQU5FO1xufVxudmFyIF9fZnJlZXplID0gT2JqZWN0LmZyZWV6ZTtcbnZhciBfX2RlZlByb3AgPSBPYmplY3QuZGVmaW5lUHJvcGVydHk7XG52YXIgX190ZW1wbGF0ZSA9IChjb29rZWQsIHJhdykgPT4gX19mcmVlemUoX19kZWZQcm9wKGNvb2tlZCwgXCJyYXdcIiwge1xuICB2YWx1ZTogX19mcmVlemUocmF3IHx8IGNvb2tlZC5zbGljZSgpKVxufSkpO1xudmFyIF9hO1xuY29uc3QgU3R5bGVkUGFuZUxheW91dCA9IHN0eWxlZChQYW5lTGF5b3V0KShfYSB8fCAoX2EgPSBfX3RlbXBsYXRlKFtcIlxcbiAgbWluLWhlaWdodDogMTAwJTtcXG4gIG1pbi13aWR0aDogMzIwcHg7XFxuXCJdKSkpO1xuY29uc3QgaXNTYXZlSG90a2V5ID0gaXNIb3RrZXkoXCJtb2Qrc1wiKTtcbmNvbnN0IFN0cnVjdHVyZVRvb2wgPSBtZW1vKGZ1bmN0aW9uIFN0cnVjdHVyZVRvb2wyKF9yZWYxMSkge1xuICBsZXQge1xuICAgIG9uUGFuZUNoYW5nZVxuICB9ID0gX3JlZjExO1xuICB2YXIgX2EyO1xuICBjb25zdCB7XG4gICAgcHVzaDogcHVzaFRvYXN0XG4gIH0gPSB1c2VUb2FzdCgpO1xuICBjb25zdCBzY2hlbWEgPSB1c2VTY2hlbWEoKTtcbiAgY29uc3Qge1xuICAgIGxheW91dENvbGxhcHNlZCxcbiAgICBzZXRMYXlvdXRDb2xsYXBzZWRcbiAgfSA9IHVzZVN0cnVjdHVyZVRvb2woKTtcbiAgY29uc3Qge1xuICAgIHBhbmVEYXRhSXRlbXMsXG4gICAgcmVzb2x2ZWRQYW5lc1xuICB9ID0gdXNlUmVzb2x2ZWRQYW5lcygpO1xuICBjb25zdCBpc1Jlc29sdmluZ0ludGVudCA9IHVzZVJvdXRlclN0YXRlKHVzZUNhbGxiYWNrKHJvdXRlclN0YXRlID0+IHR5cGVvZiByb3V0ZXJTdGF0ZS5pbnRlbnQgPT09IFwic3RyaW5nXCIsIFtdKSk7XG4gIGNvbnN0IHtcbiAgICBzYW5pdHk6IHtcbiAgICAgIG1lZGlhXG4gICAgfVxuICB9ID0gdXNlVGhlbWUoKTtcbiAgY29uc3QgW3BvcnRhbEVsZW1lbnQsIHNldFBvcnRhbEVsZW1lbnRdID0gdXNlU3RhdGUobnVsbCk7XG4gIGNvbnN0IGhhbmRsZVJvb3RDb2xsYXBzZSA9IHVzZUNhbGxiYWNrKCgpID0+IHNldExheW91dENvbGxhcHNlZCh0cnVlKSwgW3NldExheW91dENvbGxhcHNlZF0pO1xuICBjb25zdCBoYW5kbGVSb290RXhwYW5kID0gdXNlQ2FsbGJhY2soKCkgPT4gc2V0TGF5b3V0Q29sbGFwc2VkKGZhbHNlKSwgW3NldExheW91dENvbGxhcHNlZF0pO1xuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChyZXNvbHZlZFBhbmVzLmxlbmd0aCkge1xuICAgICAgb25QYW5lQ2hhbmdlKHJlc29sdmVkUGFuZXMpO1xuICAgIH1cbiAgfSwgW29uUGFuZUNoYW5nZSwgcmVzb2x2ZWRQYW5lc10pO1xuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGNvbnN0IGhhbmRsZUdsb2JhbEtleURvd24gPSBldmVudCA9PiB7XG4gICAgICBpZiAoaXNTYXZlSG90a2V5KGV2ZW50KSkge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBwdXNoVG9hc3Qoe1xuICAgICAgICAgIGNsb3NhYmxlOiB0cnVlLFxuICAgICAgICAgIGlkOiBcImF1dG8tc2F2ZS1tZXNzYWdlXCIsXG4gICAgICAgICAgc3RhdHVzOiBcImluZm9cIixcbiAgICAgICAgICB0aXRsZTogXCJZb3VyIHdvcmsgaXMgYXV0b21hdGljYWxseSBzYXZlZCFcIixcbiAgICAgICAgICBkdXJhdGlvbjogNGUzXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH07XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGhhbmRsZUdsb2JhbEtleURvd24pO1xuICAgIHJldHVybiAoKSA9PiB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgaGFuZGxlR2xvYmFsS2V5RG93bik7XG4gIH0sIFtwdXNoVG9hc3RdKTtcbiAgY29uc3QgaGFzRGVmaW5lZERvY3VtZW50VHlwZXMgPSAoX2EyID0gc2NoZW1hLl9vcmlnaW5hbCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hMi50eXBlcy5zb21lKF9pc0N1c3RvbURvY3VtZW50VHlwZURlZmluaXRpb24pO1xuICBpZiAoIWhhc0RlZmluZWREb2N1bWVudFR5cGVzKSB7XG4gICAgcmV0dXJuIC8qIEBfX1BVUkVfXyAqL2pzeChOb0RvY3VtZW50VHlwZXNTY3JlZW4sIHt9KTtcbiAgfVxuICByZXR1cm4gLyogQF9fUFVSRV9fICovanN4cyhQb3J0YWxQcm92aWRlciwge1xuICAgIGVsZW1lbnQ6IHBvcnRhbEVsZW1lbnQgfHwgbnVsbCxcbiAgICBjaGlsZHJlbjogWy8qIEBfX1BVUkVfXyAqL2pzeHMoU3R5bGVkUGFuZUxheW91dCwge1xuICAgICAgZmxleDogMSxcbiAgICAgIGhlaWdodDogbGF5b3V0Q29sbGFwc2VkID8gdm9pZCAwIDogXCJmaWxsXCIsXG4gICAgICBtaW5XaWR0aDogbWVkaWFbMV0sXG4gICAgICBvbkNvbGxhcHNlOiBoYW5kbGVSb290Q29sbGFwc2UsXG4gICAgICBvbkV4cGFuZDogaGFuZGxlUm9vdEV4cGFuZCxcbiAgICAgIGNoaWxkcmVuOiBbcGFuZURhdGFJdGVtcy5tYXAoX3JlZjEyID0+IHtcbiAgICAgICAgbGV0IHtcbiAgICAgICAgICBhY3RpdmUsXG4gICAgICAgICAgY2hpbGRJdGVtSWQsXG4gICAgICAgICAgZ3JvdXBJbmRleCxcbiAgICAgICAgICBpdGVtSWQsXG4gICAgICAgICAga2V5OiBwYW5lS2V5LFxuICAgICAgICAgIHBhbmUsXG4gICAgICAgICAgaW5kZXg6IHBhbmVJbmRleCxcbiAgICAgICAgICBwYXJhbXM6IHBhbmVQYXJhbXMsXG4gICAgICAgICAgcGF0aCxcbiAgICAgICAgICBwYXlsb2FkLFxuICAgICAgICAgIHNpYmxpbmdJbmRleCxcbiAgICAgICAgICBzZWxlY3RlZFxuICAgICAgICB9ID0gX3JlZjEyO1xuICAgICAgICByZXR1cm4gLyogQF9fUFVSRV9fICovanN4KEZyYWdtZW50LCB7XG4gICAgICAgICAgY2hpbGRyZW46IHBhbmUgPT09IExPQURJTkdfUEFORSA/IC8qIEBfX1BVUkVfXyAqL2pzeChMb2FkaW5nUGFuZSwge1xuICAgICAgICAgICAgcGFuZUtleSxcbiAgICAgICAgICAgIHBhdGgsXG4gICAgICAgICAgICBzZWxlY3RlZFxuICAgICAgICAgIH0pIDogLyogQF9fUFVSRV9fICovanN4KFN0cnVjdHVyZVRvb2xQYW5lLCB7XG4gICAgICAgICAgICBhY3RpdmUsXG4gICAgICAgICAgICBncm91cEluZGV4LFxuICAgICAgICAgICAgaW5kZXg6IHBhbmVJbmRleCxcbiAgICAgICAgICAgIHBhbmUsXG4gICAgICAgICAgICBjaGlsZEl0ZW1JZCxcbiAgICAgICAgICAgIGl0ZW1JZCxcbiAgICAgICAgICAgIHBhbmVLZXksXG4gICAgICAgICAgICBwYXJhbXM6IHBhbmVQYXJhbXMsXG4gICAgICAgICAgICBwYXlsb2FkLFxuICAgICAgICAgICAgcGF0aCxcbiAgICAgICAgICAgIHNlbGVjdGVkLFxuICAgICAgICAgICAgc2libGluZ0luZGV4XG4gICAgICAgICAgfSlcbiAgICAgICAgfSwgXCJcIi5jb25jYXQocGFuZSA9PT0gTE9BRElOR19QQU5FID8gXCJsb2FkaW5nXCIgOiBwYW5lLnR5cGUsIFwiLVwiKS5jb25jYXQocGFuZUluZGV4KSk7XG4gICAgICB9KSwgcGFuZURhdGFJdGVtcy5sZW5ndGggPD0gMSAmJiBpc1Jlc29sdmluZ0ludGVudCAmJiAvKiBAX19QVVJFX18gKi9qc3goTG9hZGluZ1BhbmUsIHtcbiAgICAgICAgcGFuZUtleTogXCJpbnRlbnQtcmVzb2x2ZXJcIlxuICAgICAgfSldXG4gICAgfSksIC8qIEBfX1BVUkVfXyAqL2pzeChTdHJ1Y3R1cmVUaXRsZSwge1xuICAgICAgcmVzb2x2ZWRQYW5lc1xuICAgIH0pLCAvKiBAX19QVVJFX18gKi9qc3goXCJkaXZcIiwge1xuICAgICAgXCJkYXRhLXBvcnRhbFwiOiBcIlwiLFxuICAgICAgcmVmOiBzZXRQb3J0YWxFbGVtZW50XG4gICAgfSldXG4gIH0pO1xufSk7XG5mdW5jdGlvbiBTdHJ1Y3R1cmVUb29sQm91bmRhcnkoX3JlZjEzKSB7XG4gIGxldCB7XG4gICAgdG9vbDoge1xuICAgICAgb3B0aW9uc1xuICAgIH1cbiAgfSA9IF9yZWYxMztcbiAgY29uc3Qge1xuICAgIHVuc3RhYmxlX3NvdXJjZXM6IHNvdXJjZXNcbiAgfSA9IHVzZVdvcmtzcGFjZSgpO1xuICBjb25zdCBbZmlyc3RTb3VyY2VdID0gc291cmNlcztcbiAgY29uc3Qge1xuICAgIHNvdXJjZSxcbiAgICBkZWZhdWx0RG9jdW1lbnROb2RlLFxuICAgIHN0cnVjdHVyZVxuICB9ID0gb3B0aW9ucyB8fCB7fTtcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBzZXRBY3RpdmVQYW5lcyhbXSk7XG4gICAgcmV0dXJuICgpID0+IHNldEFjdGl2ZVBhbmVzKFtdKTtcbiAgfSwgW10pO1xuICBjb25zdCBbe1xuICAgIGVycm9yXG4gIH0sIHNldEVycm9yXSA9IHVzZVN0YXRlKHtcbiAgICBlcnJvcjogbnVsbFxuICB9KTtcbiAgaWYgKGVycm9yKSByZXR1cm4gLyogQF9fUFVSRV9fICovanN4KFN0cnVjdHVyZUVycm9yLCB7XG4gICAgZXJyb3JcbiAgfSk7XG4gIHJldHVybiAvKiBAX19QVVJFX18gKi9qc3goRXJyb3JCb3VuZGFyeSwge1xuICAgIG9uQ2F0Y2g6IHNldEVycm9yLFxuICAgIGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi9qc3goU291cmNlUHJvdmlkZXIsIHtcbiAgICAgIG5hbWU6IHNvdXJjZSB8fCBmaXJzdFNvdXJjZS5uYW1lLFxuICAgICAgY2hpbGRyZW46IC8qIEBfX1BVUkVfXyAqL2pzeHMoU3RydWN0dXJlVG9vbFByb3ZpZGVyLCB7XG4gICAgICAgIGRlZmF1bHREb2N1bWVudE5vZGUsXG4gICAgICAgIHN0cnVjdHVyZSxcbiAgICAgICAgY2hpbGRyZW46IFsvKiBAX19QVVJFX18gKi9qc3goU3RydWN0dXJlVG9vbCwge1xuICAgICAgICAgIG9uUGFuZUNoYW5nZTogc2V0QWN0aXZlUGFuZXNcbiAgICAgICAgfSksIC8qIEBfX1BVUkVfXyAqL2pzeChJbnRlbnRSZXNvbHZlciwge30pXVxuICAgICAgfSlcbiAgICB9KVxuICB9KTtcbn1cbmV4cG9ydCB7IFN0cnVjdHVyZVRvb2xCb3VuZGFyeSBhcyBkZWZhdWx0IH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC1CbjZnV2o0QS5qcy5tYXBcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(app-pages-browser)/./node_modules/sanity/lib/_chunks/index-Bn6gWj4A.js\n"));

/***/ })

}]);